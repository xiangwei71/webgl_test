!function(t){var n={};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)i.d(e,r,function(n){return t[n]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=0)}([function(t,n,i){"use strict";i.r(n);function e(t,n){return Math.abs(t-n)<.001}var r=function(){function t(t,n,i){this.x=0,this.y=0,this.z=0,this.x=t,this.y=n,this.z=i}return t.add=function(n,i){return new t(i.x+n.x,i.y+n.y,i.z+n.z)},t.minus=function(n,i){return new t(n.x-i.x,n.y-i.y,n.z-i.z)},t.multiply=function(n,i){return new t(n.x*i,n.y*i,n.z*i)},t.cross=function(n,i){return new t(n.y*i.z-n.z*i.y,-n.x*i.z+n.z*i.x,n.x*i.y-n.y*i.x)},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},t.equal=function(t,n){return e(t.x,n.x)&&e(t.y,n.y)&&e(t.z,n.z)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},t.prototype.add=function(n){return t.add(this,n)},t.prototype.minus=function(n){return t.minus(this,n)},t.prototype.multiply=function(n){return t.multiply(this,n)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.up=new t(0,1,0),t.zero=new t(0,0,0),t}(),o=function(t,n){this.from=t,this.dir=n},s=function(){function t(t){this.color=t}return t.yellow=new t(new r(1,1,0)),t.red=new t(new r(1,0,0)),t.green=new t(new r(0,1,0)),t.blue=new t(new r(0,0,1)),t.gray=new t(new r(.5,.5,.5)),t.white=new t(new r(1,1,1)),t}(),u=function(){function t(t,n,i){this.z_axis=r.minus(n,t).normalize();var e=r.up;this.x_axis=r.cross(e,this.z_axis).normalize(),this.y_axis=r.cross(this.z_axis,this.x_axis),this.eye=t,this.fov_degree=i}return t.prototype.create_ray_dir=function(t,n,i){var e,r=(e=.5*this.fov_degree,Math.PI*e/180),o=Math.tan(r),s=o*i;return this.z_axis.add(this.x_axis.multiply(t*s)).add(this.y_axis.multiply(n*o))},t.prototype.render=function(t,n){var i=this,e=new r(1,-1,0).normalize(),u=.5/t.h,h=[{x:0,y:0},{x:u,y:u},{x:-u,y:u},{x:-u,y:-u},{x:u,y:-u}];t.render_pixel((function(t,u,a){var f=i.create_ray_dir(t,u,a),l=h.map((function(t){var n=f.add(i.x_axis.multiply(t.x)).add(i.y_axis.multiply(t.y));return new o(i.eye,n)})).map((function(t){var i,o,u,h=n.map((function(n){return n.h.hit(t,n.m)})).filter((function(t){return t.is_hit})).sort((function(t,n){return t.t-n.t}));if(0!=h.length){var a=h[0],f=a.normal,l=(i=-r.dot(e,f),o=0,i>(u=1)?u:i<o?o:i);return a.m.color.multiply(l)}return s.gray.color})),c=h.length;return l.reduce((function(t,n){return t.add(n)}),r.zero).multiply(1/c)}))},t}(),h=function(){function t(t,n,i){this.plane=t,this.w=n,this.h=i}return t.prototype.hit=function(t,n){var i=this.plane.hit(t,n);if(i.is_hit){var e=i.hit_pos,o=e.minus(this.plane.C),s=r.equal(this.plane.N,r.up)?new r(1,0,0):r.up,u=r.cross(s,this.plane.N).normalize(),h=r.cross(u,this.plane.N),a=r.dot(o,u),f=r.dot(o,h);return{is_hit:Math.abs(a)<this.w&&Math.abs(f)<this.h,hit_pos:e,t:i.t,normal:this.plane.N,m:n}}return{is_hit:!1}},t}(),a=function(){function t(t,n){this.C=t,this.N=n}return t.prototype.is_positive=function(t){var n=r.minus(t,this.C);return r.dot(n,this.N)>0},t.prototype.hit=function(t,n){var i=t.from,o=t.dir,s=r.dot(o,this.N),u=r.dot(r.minus(this.C,i),this.N);if(e(s,0))return{is_hit:!1,hit_pos:null,t:-1};var h=u/s;return{is_hit:h>0,hit_pos:i.add(o.multiply(h)),t:h,normal:this.N,m:n}},t}(),f=function(){function t(t,n){this.C=t,this.R=n}return t.prototype.hit=function(t,n){var i=t.dir,o=t.from,s=r.dot(i,i),u=2*(r.dot(i,o)-r.dot(i,this.C)),h=u*u-4*s*(r.dot(o,o)-2*r.dot(o,this.C)+r.dot(this.C,this.C)-this.R*this.R);if(e(h,0)){var a=-u/(2*s),f=(l=o.add(i.multiply(a))).minus(this.C).normalize();return{is_hit:!0,hit_pos:l,t:a,normal:f,m:n}}if(h>0){var l,c=Math.sqrt(h);a=[(-u-c)/(2*s),(-u+c)/(2*s)].filter((function(t){return t>0}))[0],f=(l=o.add(i.multiply(a))).minus(this.C).normalize();return{is_hit:!0,hit_pos:l,t:a,normal:f,m:n}}return{is_hit:!1}},t}(),l=function(){function t(t,n){void 0===t&&(t=320),void 0===n&&(n=240),this.w=320,this.h=240,this.backbuffer=null,this.w=t,this.h=n,this.backbuffer=new OffscreenCanvas(this.w,this.h)}return t.prototype.render_pixel=function(t){for(var n=this.backbuffer.getContext("2d"),i=n.getImageData(0,0,this.w,this.h),e=i.data,r=this.w/this.h,o=0;o<this.h;++o)for(var s=0;s<this.w;++s){var u=4*(s+o*this.w),h=s/this.w,a=o/this.h,f=t(2*h-1,2*(a=1-a)-1,r),l=f.x,c=f.y,p=f.z;e[u++]=Math.round(255*l),e[u++]=Math.round(255*c),e[u++]=Math.round(255*p),e[u]=255}n.putImageData(i,0,0)},t.prototype.show_buffer=function(t){var n=document.getElementById(t);n.style.width=this.w+"px",n.style.height=this.h+"px",n.width=n.clientWidth,n.height=n.clientHeight,n.getContext("bitmaprenderer").transferFromImageBitmap(this.backbuffer.transferToImageBitmap())},t}(),c=function(t,n){this.m=t,this.h=n};new function(){var t=[new c(s.white,new h(new a(r.zero,r.up),16,16))];t.push(new c(s.green,new f(new r(6,2,-8),1))),t.push(new c(s.yellow,new f(new r(0,4,-6),4)));var n=new u(new r(0,20,-20),r.zero,60),i=new l(800,600);n.render(i,t),i.show_buffer("canvas")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvVG9vbC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9WZWN0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmF5LnRzIiwid2VicGFjazovLy8uL3NyYy9PYmplY3QvTWF0ZXJpYWwudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvQ2FtZXJhLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1JlY3QudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUGxhbmUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvU3BoZXJlLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1JlbmRlclRhcmdldC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvT2JqZWN0L1NjZW5lTm9kZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvQXBwLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwibnVtYmVyX2VxdWFsIiwiYSIsImIiLCJNYXRoIiwiYWJzIiwicHgiLCJweSIsInB6IiwieCIsInkiLCJ6IiwidGhpcyIsImFkZCIsIkEiLCJCIiwiVmVjdG9yIiwibWludXMiLCJtdWx0aXBseSIsImNyb3NzIiwiZG90IiwiZXF1YWwiLCJsZW5ndGgiLCJzcXJ0Iiwibm9ybWFsaXplIiwidGVtcCIsImNsb25lIiwidXAiLCJ6ZXJvIiwiZnJvbSIsImRpciIsImNvbG9yIiwieWVsbG93IiwiTWF0ZXJpYWwiLCJyZWQiLCJncmVlbiIsImJsdWUiLCJncmF5Iiwid2hpdGUiLCJleWUiLCJsb29rX2F0IiwiZm92X2RlZ3JlZSIsInpfYXhpcyIsImhlbHBfdiIsInhfYXhpcyIsInlfYXhpcyIsImNyZWF0ZV9yYXlfZGlyIiwieF93ZWlnaHQiLCJ5X3dlaWdodCIsInJhdGlvIiwiaGFsZl9mb3ZfcmFkIiwiUEkiLCJ0YW5faCIsInRhbiIsInRhbl93IiwicmVuZGVyIiwicmVuZGVyX3RhcmdldCIsIm9ial9saXN0IiwiZGlyZWN0aW9uX2xpZ2h0X2RpciIsImhhbGZfcGl4ZWxfb2Zmc2V0IiwiaCIsIm11bHRpc2FtcGxlX2RpZmYiLCJyZW5kZXJfcGl4ZWwiLCJyYXlfZGlyIiwiY29sb3JzIiwibWFwIiwiZGlmZiIsInJheSIsImhpdF9zb3J0X2xpc3QiLCJvYmoiLCJoaXQiLCJmaWx0ZXIiLCJpbmZvIiwiaXNfaGl0Iiwic29ydCIsInJlc3VsdCIsIm5vcm1hbCIsInN0cmVuZ3RoIiwiY291bnQiLCJyZWR1Y2UiLCJhY2N1bXVsYXRvciIsImN1cnJlbnQiLCJwbGFuZSIsInciLCJoaXRfcG9zIiwiQyIsIk4iLCJ3X2F4aXMiLCJoX2F4aXMiLCJ3X3ZhbHVlIiwiaF92YWx1ZSIsInBvaW50IiwiaXNfcG9zaXRpdmUiLCJ0ZXN0X3AiLCJSIiwiRCIsIkYiLCJrIiwic3FydF9rIiwiYmFja2J1ZmZlciIsIk9mZnNjcmVlbkNhbnZhcyIsImZ1bmMiLCJjb250ZXh0XzJkIiwiZ2V0Q29udGV4dCIsImJhY2tidWZmZXJfZGF0YSIsImdldEltYWdlRGF0YSIsImJhY2tidWZmZXJfZGF0YV9hcnJheSIsImRhdGEiLCJpbmRleCIsIlgiLCJZIiwiZyIsInJvdW5kIiwicHV0SW1hZ2VEYXRhIiwic2hvd19idWZmZXIiLCJjYW52YXNfaWQiLCJjYW52YXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJ3aWR0aCIsImhlaWdodCIsImNsaWVudFdpZHRoIiwiY2xpZW50SGVpZ2h0IiwidHJhbnNmZXJGcm9tSW1hZ2VCaXRtYXAiLCJ0cmFuc2ZlclRvSW1hZ2VCaXRtYXAiLCJwdXNoIiwiY2FtZXJhIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIs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RUFBaUIsRUFBRyxJQUdoRCxZQUFBVSxZQUFBLFNBQVlDLEdBR1IsSUFBSUMsRUFBU0MsU0FBU0MsZUFBZUgsR0FDckNDLEVBQU9HLE1BQU1DLE1BQVE1RyxLQUFLdUUsRUFBSSxLQUM5QmlDLEVBQU9HLE1BQU1FLE9BQVM3RyxLQUFLZ0QsRUFBSSxLQUMvQndELEVBQU9JLE1BQVFKLEVBQU9NLFlBQ3RCTixFQUFPSyxPQUFTTCxFQUFPTyxhQUdLUCxFQUFPYixXQUFXLGtCQUN4QnFCLHdCQUF3QmhILEtBQUt1RixXQUFXMEIsMEJBRXRFLEVBakVBLEcsRUNNSSxTQUFZeEosRUFBYXVGLEdBQ3JCaEQsS0FBS3ZDLEVBQUlBLEVBQ1R1QyxLQUFLZ0QsRUFBSUEsR0NQakIsSUNTSSxXQUVJLElBQ0lILEVBQXdCLENBRGhCLElBQUksRUFBVSxFQUFTbkIsTUFBTyxJQUFJLEVBQUssSUFBSSxFQUFNLEVBQU9WLEtBQU0sRUFBT0QsSUFBSyxHQUFJLE1BRTFGOEIsRUFBU3FFLEtBQUssSUFBSSxFQUFVLEVBQVMzRixNQUFPLElBQUksRUFBTyxJQUFJLEVBQU8sRUFBRyxHQUFJLEdBQUksS0FDN0VzQixFQUFTcUUsS0FBSyxJQUFJLEVBQVUsRUFBUzlGLE9BQVEsSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLEdBQUksR0FBSSxLQUU5RSxJQUFJK0YsRUFBUyxJQUFJLEVBQU8sSUFBSSxFQUFPLEVBQUcsSUFBSyxJQUFLLEVBQU9uRyxLQUFNLElBQ3pENEIsRUFBZ0IsSUFBSSxFQUFhLElBQUssS0FDMUN1RSxFQUFPeEUsT0FBT0MsRUFBZUMsR0FDN0JELEVBQWMwRCxZQUFZIiwiZmlsZSI6ImJ1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGZ1bmN0aW9uIGRlZ3JlZV90b19SYWQoZDogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTWF0aC5QSSAqIGQgLyAxODA7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZXBzaWxvbjogbnVtYmVyID0gMC4wMDE7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbnVtYmVyX2VxdWFsKGE6IG51bWJlciwgYjogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTWF0aC5hYnMoYSAtIGIpIDwgZXBzaWxvbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFxyXG4gKiBAcGFyYW0geCBpbnB1dFxyXG4gKiBAcGFyYW0gYSBtaW4gXHJcbiAqIEBwYXJhbSBiIG1heFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKHg6IG51bWJlciwgYTogbnVtYmVyLCBiOiBudW1iZXIpIHtcclxuICAgIGlmICh4ID4gYilcclxuICAgICAgICByZXR1cm4gYjtcclxuICAgIGVsc2UgaWYgKHggPCBhKVxyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIHJldHVybiB4O1xyXG59IiwiaW1wb3J0IHsgbnVtYmVyX2VxdWFsIH0gZnJvbSAnLi9Ub29sJ1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZlY3RvciB7XHJcblxyXG4gICAgc3RhdGljIHVwID0gbmV3IFZlY3RvcigwLCAxLCAwKTtcclxuICAgIHN0YXRpYyB6ZXJvID0gbmV3IFZlY3RvcigwLCAwLCAwKTtcclxuXHJcbiAgICBzdGF0aWMgYWRkKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEIueCArIEEueCwgQi55ICsgQS55LCBCLnogKyBBLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG1pbnVzKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAtIEIueCwgQS55IC0gQi55LCBBLnogLSBCLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG11bHRpcGx5KEE6IFZlY3RvciwgczogbnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAqIHMsIEEueSAqIHMsIEEueiAqIHMpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNyb3NzKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueSAqIEIueiAtIEEueiAqIEIueSwgLUEueCAqIEIueiArIEEueiAqIEIueCwgQS54ICogQi55IC0gQS55ICogQi54KTtcclxuICAgICAgICByZXR1cm4gdGVtcDtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgZG90KEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIEEueCAqIEIueCArIEEueSAqIEIueSArIEEueiAqIEIuejtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgZXF1YWwoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gbnVtYmVyX2VxdWFsKEEueCwgQi54KSAmJiBudW1iZXJfZXF1YWwoQS55LCBCLnkpICYmIG51bWJlcl9lcXVhbChBLnosIEIueik7XHJcbiAgICB9XHJcblxyXG4gICAgeDogbnVtYmVyID0gMDtcclxuICAgIHk6IG51bWJlciA9IDA7XHJcbiAgICB6OiBudW1iZXIgPSAwO1xyXG4gICAgY29uc3RydWN0b3IocHg6IG51bWJlciwgcHk6IG51bWJlciwgcHo6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMueCA9IHB4O1xyXG4gICAgICAgIHRoaXMueSA9IHB5O1xyXG4gICAgICAgIHRoaXMueiA9IHB6O1xyXG4gICAgfVxyXG5cclxuICAgIGxlbmd0aCgpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueik7XHJcbiAgICB9XHJcblxyXG4gICAgbm9ybWFsaXplKCkge1xyXG4gICAgICAgIHZhciB0ZW1wID0gdGhpcy5sZW5ndGgoKTtcclxuICAgICAgICB0aGlzLnggPSB0aGlzLnggLyB0ZW1wO1xyXG4gICAgICAgIHRoaXMueSA9IHRoaXMueSAvIHRlbXA7XHJcbiAgICAgICAgdGhpcy56ID0gdGhpcy56IC8gdGVtcDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBhZGQoQTogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5hZGQodGhpcywgQSk7XHJcbiAgICB9XHJcblxyXG4gICAgbWludXMoQTogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5taW51cyh0aGlzLCBBKTtcclxuICAgIH1cclxuXHJcbiAgICBtdWx0aXBseShzOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLm11bHRpcGx5KHRoaXMsIHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb25lKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKHRoaXMueCwgdGhpcy55LCB0aGlzLnopO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY29yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmF5IHtcclxuICAgIGZyb206IFZlY29yO1xyXG4gICAgZGlyOiBWZWNvcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihmcm9tOiBWZWNvciwgZGlyOiBWZWNvcikge1xyXG4gICAgICAgIHRoaXMuZnJvbSA9IGZyb207XHJcbiAgICAgICAgdGhpcy5kaXIgPSBkaXI7XHJcbiAgICB9XHJcbn07IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi4vTWF0aC9WZWN0b3JcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hdGVyaWFsIHtcclxuICAgIHN0YXRpYyB5ZWxsb3cgPSBuZXcgTWF0ZXJpYWwobmV3IFZlY3RvcigxLCAxLCAwKSk7XHJcbiAgICBzdGF0aWMgcmVkID0gbmV3IE1hdGVyaWFsKG5ldyBWZWN0b3IoMSwgMCwgMCkpO1xyXG4gICAgc3RhdGljIGdyZWVuID0gbmV3IE1hdGVyaWFsKG5ldyBWZWN0b3IoMCwgMSwgMCkpO1xyXG4gICAgc3RhdGljIGJsdWUgPSBuZXcgTWF0ZXJpYWwobmV3IFZlY3RvcigwLCAwLCAxKSk7XHJcbiAgICBzdGF0aWMgZ3JheSA9IG5ldyBNYXRlcmlhbChuZXcgVmVjdG9yKDAuNSwgMC41LCAwLjUpKTtcclxuICAgIHN0YXRpYyB3aGl0ZSA9IG5ldyBNYXRlcmlhbChuZXcgVmVjdG9yKDEsIDEsIDEpKTtcclxuXHJcbiAgICBjb2xvcjogVmVjdG9yO1xyXG4gICAgY29uc3RydWN0b3IoY29sb3I6IFZlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcclxuICAgIH1cclxufSIsImltcG9ydCBWZWN0b3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcbmltcG9ydCBSYXkgZnJvbSBcIi4vUmF5XCI7XHJcbmltcG9ydCB7IGRlZ3JlZV90b19SYWQsIGNsYW1wIH0gZnJvbSBcIi4vVG9vbFwiXHJcbmltcG9ydCBSZW5kZXJUYXJnZXQgZnJvbSBcIi4vUmVuZGVyVGFyZ2V0XCI7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gXCIuL0hpdEluZm9cIjtcclxuaW1wb3J0IFNjZW5lTm9kZSBmcm9tIFwiLi4vT2JqZWN0L1NjZW5lTm9kZVwiO1xyXG5pbXBvcnQgTWF0ZXJpYWwgZnJvbSBcIi4uL09iamVjdC9NYXRlcmlhbFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FtZXJhIHtcclxuICAgIGV5ZTogVmVjdG9yO1xyXG5cclxuICAgIHhfYXhpczogVmVjdG9yO1xyXG4gICAgeV9heGlzOiBWZWN0b3I7XHJcbiAgICB6X2F4aXM6IFZlY3RvcjtcclxuXHJcbiAgICBmb3ZfZGVncmVlOiBudW1iZXI7XHJcbiAgICBjb25zdHJ1Y3RvcihleWU6IFZlY3RvciwgbG9va19hdDogVmVjdG9yLCBmb3ZfZGVncmVlOiBudW1iZXIpIHtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIDPou7hcclxuICAgICAgICB0aGlzLnpfYXhpcyA9IFZlY3Rvci5taW51cyhsb29rX2F0LCBleWUpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgaGVscF92ID0gVmVjdG9yLnVwO1xyXG4gICAgICAgIHRoaXMueF9heGlzID0gVmVjdG9yLmNyb3NzKGhlbHBfdiwgdGhpcy56X2F4aXMpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgIHRoaXMueV9heGlzID0gVmVjdG9yLmNyb3NzKHRoaXMuel9heGlzLCB0aGlzLnhfYXhpcyk7XHJcblxyXG4gICAgICAgIC8vIGNhbWVyYSDljp/pu55cclxuICAgICAgICB0aGlzLmV5ZSA9IGV5ZTtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIGZvdlxyXG4gICAgICAgIHRoaXMuZm92X2RlZ3JlZSA9IGZvdl9kZWdyZWU7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlX3JheV9kaXIoeF93ZWlnaHQ6IG51bWJlciwgeV93ZWlnaHQ6IG51bWJlciwgcmF0aW86IG51bWJlcikge1xyXG4gICAgICAgIGxldCBoYWxmX2Zvdl9yYWQgPSBkZWdyZWVfdG9fUmFkKDAuNSAqIHRoaXMuZm92X2RlZ3JlZSk7XHJcbiAgICAgICAgbGV0IHRhbl9oID0gTWF0aC50YW4oaGFsZl9mb3ZfcmFkKTtcclxuICAgICAgICBsZXQgdGFuX3cgPSB0YW5faCAqIHJhdGlvO1xyXG5cclxuICAgICAgICBsZXQgZGlyID0gdGhpcy56X2F4aXNcclxuICAgICAgICAgICAgLmFkZCh0aGlzLnhfYXhpcy5tdWx0aXBseSh4X3dlaWdodCAqIHRhbl93KSlcclxuICAgICAgICAgICAgLmFkZCh0aGlzLnlfYXhpcy5tdWx0aXBseSh5X3dlaWdodCAqIHRhbl9oKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBkaXI7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKHJlbmRlcl90YXJnZXQ6IFJlbmRlclRhcmdldCwgb2JqX2xpc3Q6IFNjZW5lTm9kZVtdKSB7XHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbl9saWdodF9kaXIgPSBuZXcgVmVjdG9yKDEsIC0xLCAwKS5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IGhhbGZfcGl4ZWxfb2Zmc2V0ID0gMC41IC8gcmVuZGVyX3RhcmdldC5oO1xyXG4gICAgICAgIGxldCBtdWx0aXNhbXBsZV9kaWZmID0gW1xyXG4gICAgICAgICAgICB7IHg6IDAsIHk6IDAgfSxcclxuICAgICAgICAgICAgeyB4OiBoYWxmX3BpeGVsX29mZnNldCwgeTogaGFsZl9waXhlbF9vZmZzZXQgfSxcclxuICAgICAgICAgICAgeyB4OiAtaGFsZl9waXhlbF9vZmZzZXQsIHk6IGhhbGZfcGl4ZWxfb2Zmc2V0IH0sXHJcbiAgICAgICAgICAgIHsgeDogLWhhbGZfcGl4ZWxfb2Zmc2V0LCB5OiAtaGFsZl9waXhlbF9vZmZzZXQgfSxcclxuICAgICAgICAgICAgeyB4OiBoYWxmX3BpeGVsX29mZnNldCwgeTogLWhhbGZfcGl4ZWxfb2Zmc2V0IH0sXHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgcmVuZGVyX3RhcmdldC5yZW5kZXJfcGl4ZWwoKHhfd2VpZ2h0OiBudW1iZXIsIHlfd2VpZ2h0OiBudW1iZXIsIHJhdGlvOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgbGV0IHJheV9kaXIgPSB0aGlzLmNyZWF0ZV9yYXlfZGlyKHhfd2VpZ2h0LCB5X3dlaWdodCwgcmF0aW8pO1xyXG5cclxuICAgICAgICAgICAgLy8g55Si55Sf5aSa5qKdcmF5XHJcbiAgICAgICAgICAgIGxldCByYXlzID0gbXVsdGlzYW1wbGVfZGlmZi5tYXAoZGlmZiA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyDlsI1yYXlfZHJp5L2c5YGP56e7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGlyID0gcmF5X2Rpci5hZGQodGhpcy54X2F4aXMubXVsdGlwbHkoZGlmZi54KSkuYWRkKHRoaXMueV9heGlzLm11bHRpcGx5KGRpZmYueSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJheSh0aGlzLmV5ZSwgZGlyKVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOavj+WAi3JheemDveeul2NvbG9yXHJcbiAgICAgICAgICAgIGxldCBjb2xvcnMgPSByYXlzLm1hcChyYXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGhpdF9zb3J0X2xpc3QgPSBvYmpfbGlzdC5tYXAob2JqID0+IG9iai5oLmhpdChyYXksIG9iai5tKSlcclxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGluZm8gPT4gaW5mby5pc19oaXQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKGE6IEhpdEluZm8sIGI6IEhpdEluZm8pID0+IGEudCAtIGIudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8g5pyJ5bCE5Lit5ZeOXHJcbiAgICAgICAgICAgICAgICBsZXQgaXNfaGl0ID0gaGl0X3NvcnRfbGlzdC5sZW5ndGggIT0gMDtcclxuICAgICAgICAgICAgICAgIGlmIChpc19oaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gaGl0X3NvcnRfbGlzdFswXTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbiA9IHJlc3VsdC5ub3JtYWw7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0cmVuZ3RoID0gY2xhbXAoLVZlY3Rvci5kb3QoZGlyZWN0aW9uX2xpZ2h0X2RpciwgbiksIDAsIDEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0Lm0uY29sb3IubXVsdGlwbHkoc3RyZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0ZXJpYWwuZ3JheS5jb2xvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyDlj5blubPlnYflsLHmnIlBbnRpYWxpYXNpbmfmlYjmnpxcclxuICAgICAgICAgICAgbGV0IGNvdW50ID0gbXVsdGlzYW1wbGVfZGlmZi5sZW5ndGg7XHJcbiAgICAgICAgICAgIGxldCBmaW5hbF9jb2xvciA9IGNvbG9ycy5yZWR1Y2UoKGFjY3VtdWxhdG9yOiBWZWN0b3IsIGN1cnJlbnQ6IFZlY3RvcikgPT4gYWNjdW11bGF0b3IuYWRkKGN1cnJlbnQpLCBWZWN0b3IuemVybykubXVsdGlwbHkoMSAvIGNvdW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbmFsX2NvbG9yO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUGxhbmUgZnJvbSBcIi4vUGxhbmVcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuaW1wb3J0IEhpdEluZm8gZnJvbSBcIi4vSGl0SW5mb1wiO1xyXG5pbXBvcnQgSGl0YWJsZSBmcm9tIFwiLi9IaXRhYmxlXCI7XHJcbmltcG9ydCBNYXRlcmlhbCBmcm9tIFwiLi4vT2JqZWN0L01hdGVyaWFsXCI7XHJcblxyXG4vLyDlsI/mlrnloYpcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVjdCBpbXBsZW1lbnRzIEhpdGFibGUge1xyXG4gICAgcGxhbmU6IFBsYW5lO1xyXG4gICAgdzogbnVtYmVyO1xyXG4gICAgaDogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBsYW5lOiBQbGFuZSwgdzogbnVtYmVyLCBoOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnBsYW5lID0gcGxhbmU7XHJcbiAgICAgICAgdGhpcy53ID0gdztcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChyYXk6IFJheSwgbTogTWF0ZXJpYWwpOiBIaXRJbmZvIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5wbGFuZS5oaXQocmF5LCBtKTtcclxuICAgICAgICBpZiAocmVzdWx0LmlzX2hpdCkge1xyXG4gICAgICAgICAgICBsZXQgaGl0X3BvcyA9IHJlc3VsdC5oaXRfcG9zO1xyXG4gICAgICAgICAgICBsZXQgZGlmZiA9IGhpdF9wb3MubWludXModGhpcy5wbGFuZS5DKTtcclxuXHJcbiAgICAgICAgICAgIC8vIOmBv+mWi+ebuOetieeahOaDheazgVxyXG4gICAgICAgICAgICBsZXQgaGVscF92ID0gVmVjdG9yLmVxdWFsKHRoaXMucGxhbmUuTiwgVmVjdG9yLnVwKSA/IG5ldyBWZWN0b3IoMSwgMCwgMCkgOiBWZWN0b3IudXA7XHJcblxyXG4gICAgICAgICAgICBsZXQgd19heGlzID0gVmVjdG9yLmNyb3NzKGhlbHBfdiwgdGhpcy5wbGFuZS5OKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgbGV0IGhfYXhpcyA9IFZlY3Rvci5jcm9zcyh3X2F4aXMsIHRoaXMucGxhbmUuTik7XHJcbiAgICAgICAgICAgIGxldCB3X3ZhbHVlID0gVmVjdG9yLmRvdChkaWZmLCB3X2F4aXMpO1xyXG4gICAgICAgICAgICBsZXQgaF92YWx1ZSA9IFZlY3Rvci5kb3QoZGlmZiwgaF9heGlzKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBpc19oaXQgPSBNYXRoLmFicyh3X3ZhbHVlKSA8IHRoaXMudyAmJiBNYXRoLmFicyhoX3ZhbHVlKSA8IHRoaXMuaDtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdCxcclxuICAgICAgICAgICAgICAgIGhpdF9wb3MsXHJcbiAgICAgICAgICAgICAgICB0OiByZXN1bHQudCxcclxuICAgICAgICAgICAgICAgIG5vcm1hbDogdGhpcy5wbGFuZS5OLFxyXG4gICAgICAgICAgICAgICAgbVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gJy4vVmVjdG9yJztcclxuaW1wb3J0IFJheSBmcm9tICcuL1JheSc7XHJcbmltcG9ydCB7IG51bWJlcl9lcXVhbCB9IGZyb20gJy4vVG9vbCc7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gJy4vSGl0SW5mbyc7XHJcbmltcG9ydCBIaXRhYmxlIGZyb20gJy4vSGl0YWJsZSc7XHJcbmltcG9ydCBNYXRlcmlhbCBmcm9tICcuLi9PYmplY3QvTWF0ZXJpYWwnO1xyXG5cclxuLy8g5bmz6Z2iXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYW5lIGltcGxlbWVudHMgSGl0YWJsZSB7XHJcblxyXG4gICAgQzogVmVjdG9yO1xyXG4gICAgTjogVmVjdG9yO1xyXG4gICAgY29uc3RydWN0b3IocG9pbnQ6IFZlY3Rvciwgbm9ybWFsOiBWZWN0b3IpIHtcclxuICAgICAgICB0aGlzLkMgPSBwb2ludDtcclxuICAgICAgICB0aGlzLk4gPSBub3JtYWw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5ris6KmmdGVzcF9w5ZKM5pa55ZCR6YeP5piv5LiN5piv5Zyo5ZCM5LiA6YKKXHJcbiAgICBpc19wb3NpdGl2ZSh0ZXN0X3A6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCBkaWZmID0gVmVjdG9yLm1pbnVzKHRlc3RfcCwgdGhpcy5DKTtcclxuICAgICAgICB2YXIgdmFsdWUgPSBWZWN0b3IuZG90KGRpZmYsIHRoaXMuTik7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlID4gMDtcclxuICAgIH1cclxuXHJcbiAgICBoaXQocmF5OiBSYXksIG06IE1hdGVyaWFsKTogSGl0SW5mbyB7XHJcbiAgICAgICAgLy8gcmF5IGhpdCBwbGFuZSBcclxuICAgICAgICBsZXQgZnJvbSA9IHJheS5mcm9tO1xyXG4gICAgICAgIGxldCBkaXIgPSByYXkuZGlyO1xyXG5cclxuICAgICAgICAvLyAoRi1DKeOAgk4gKyB0IChE44CCTikgPSAwXHJcbiAgICAgICAgLy8gdCAgPSAoQy1GKeOAgk4gLyAoROOAgk4pXHJcbiAgICAgICAgLy8gdCAgPSAoQSAvIChCKVxyXG4gICAgICAgIGxldCBCID0gVmVjdG9yLmRvdChkaXIsIHRoaXMuTik7XHJcbiAgICAgICAgbGV0IEEgPSBWZWN0b3IuZG90KFZlY3Rvci5taW51cyh0aGlzLkMsIGZyb20pLCB0aGlzLk4pO1xyXG5cclxuICAgICAgICAvLyBhdm9pZCBkaXZpZGUgYnkgMFxyXG4gICAgICAgIGlmIChudW1iZXJfZXF1YWwoQiwgMCkpXHJcbiAgICAgICAgICAgIHJldHVybiB7IGlzX2hpdDogZmFsc2UsIGhpdF9wb3M6IG51bGwsIHQ6IC0xIH07XHJcblxyXG4gICAgICAgIGxldCB0ID0gQSAvIEI7XHJcbiAgICAgICAgbGV0IGlzX2hpdCA9IHQgPiAwLjA7XHJcbiAgICAgICAgbGV0IGhpdF9wb3MgPSBmcm9tLmFkZChkaXIubXVsdGlwbHkodCkpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzX2hpdCxcclxuICAgICAgICAgICAgaGl0X3BvcyxcclxuICAgICAgICAgICAgdCxcclxuICAgICAgICAgICAgbm9ybWFsOiB0aGlzLk4sXHJcbiAgICAgICAgICAgIG1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5pbXBvcnQgUmF5IGZyb20gXCIuL1JheVwiO1xyXG5pbXBvcnQgeyBudW1iZXJfZXF1YWwgfSBmcm9tICcuL1Rvb2wnO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi9IaXRJbmZvXCI7XHJcbmltcG9ydCBIaXRhYmxlIGZyb20gXCIuL0hpdGFibGVcIjtcclxuaW1wb3J0IE1hdGVyaWFsIGZyb20gXCIuLi9PYmplY3QvTWF0ZXJpYWxcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNwaGVyZSBpbXBsZW1lbnRzIEhpdGFibGUge1xyXG5cclxuICAgIEM6IFZlY3RvcjsgLy8g55CD5Lit5b+DXHJcbiAgICBSOiBudW1iZXI7IC8vIOeQg+WNiuW+kVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKEM6IFZlY3RvciwgUjogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5DID0gQztcclxuICAgICAgICB0aGlzLlIgPSBSO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChyYXk6IFJheSwgbTogTWF0ZXJpYWwpOiBIaXRJbmZvIHtcclxuICAgICAgICAvLyDop6My5qyh5pa556iL5byPXHJcbiAgICAgICAgLy8gKFgtQynjgIIoWC1DKSA9IFIqUlxyXG4gICAgICAgIC8vIFg9Rit0KkRcclxuICAgICAgICAvLyB0PVsoLWItc3FydF9rKS8yYSwoLWIrc3FydF9rKS8yYV1cclxuICAgICAgICBsZXQgRCA9IHJheS5kaXI7XHJcbiAgICAgICAgbGV0IEYgPSByYXkuZnJvbTtcclxuICAgICAgICBsZXQgYSA9IFZlY3Rvci5kb3QoRCwgRCk7XHJcbiAgICAgICAgbGV0IGIgPSAyICogKFZlY3Rvci5kb3QoRCwgRikgLSBWZWN0b3IuZG90KEQsIHRoaXMuQykpO1xyXG4gICAgICAgIGxldCBjID0gVmVjdG9yLmRvdChGLCBGKSAtIDIgKiBWZWN0b3IuZG90KEYsIHRoaXMuQykgKyBWZWN0b3IuZG90KHRoaXMuQywgdGhpcy5DKSAtIHRoaXMuUiAqIHRoaXMuUjtcclxuXHJcbiAgICAgICAgbGV0IGsgPSBiICogYiAtIDQgKiBhICogYztcclxuICAgICAgICBpZiAobnVtYmVyX2VxdWFsKGssIDApKSB7ICAvLyDkuqTmlrwx6bueXHJcbiAgICAgICAgICAgIGxldCB0ID0gLWIgLyAoMiAqIGEpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGhpdF9wb3MgPSBGLmFkZChELm11bHRpcGx5KHQpKTtcclxuICAgICAgICAgICAgbGV0IG5vcm1hbCA9IGhpdF9wb3MubWludXModGhpcy5DKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGhpdF9wb3MsXHJcbiAgICAgICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICAgICAgbm9ybWFsLFxyXG4gICAgICAgICAgICAgICAgbVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGsgPiAwKSB7IC8vIOS6pOaWvDLpu55cclxuXHJcbiAgICAgICAgICAgIC8vIOmBjua/vuWHunQ+MO+8jHJheS5mcm9t5Zyo55CD5YWn55CD5pyJ5Y+v6IO95Ye654++dDwwXHJcbiAgICAgICAgICAgIGxldCBzcXJ0X2sgPSBNYXRoLnNxcnQoayk7XHJcbiAgICAgICAgICAgIGxldCB0X2xpc3QgPSBbKC1iIC0gc3FydF9rKSAvICgyICogYSksICgtYiArIHNxcnRfaykgLyAoMiAqIGEpXS5maWx0ZXIoeCA9PiB4ID4gMCk7XHJcbiAgICAgICAgICAgIGxldCB0ID0gdF9saXN0WzBdO1xyXG4gICAgICAgICAgICBsZXQgaGl0X3BvcyA9IEYuYWRkKEQubXVsdGlwbHkodCkpO1xyXG4gICAgICAgICAgICBsZXQgbm9ybWFsID0gaGl0X3Bvcy5taW51cyh0aGlzLkMpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaXNfaGl0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgaGl0X3BvcyxcclxuICAgICAgICAgICAgICAgIHQsXHJcbiAgICAgICAgICAgICAgICBub3JtYWwsXHJcbiAgICAgICAgICAgICAgICBtXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgeyAvLyDmspLkuqTpu55cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW5kZXJUYXJnZXQge1xyXG4gICAgdzogbnVtYmVyID0gMzIwO1xyXG4gICAgaDogbnVtYmVyID0gMjQwO1xyXG4gICAgYmFja2J1ZmZlcjogT2Zmc2NyZWVuQ2FudmFzID0gbnVsbDtcclxuICAgIGNvbnN0cnVjdG9yKHc6IG51bWJlciA9IDMyMCwgaDogbnVtYmVyID0gMjQwKSB7XHJcbiAgICAgICAgdGhpcy53ID0gdztcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgICAgIHRoaXMuYmFja2J1ZmZlciA9IG5ldyBPZmZzY3JlZW5DYW52YXModGhpcy53LCB0aGlzLmgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcl9waXhlbChmdW5jOiAoeF93ZWlnaHQ6IG51bWJlciwgeV93ZWlnaHQ6IG51bWJlciwgcmF0aW86IG51bWJlcikgPT4gVmVjdG9yKSB7XHJcblxyXG4gICAgICAgIGxldCBjb250ZXh0XzJkID0gdGhpcy5iYWNrYnVmZmVyLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG4gICAgICAgIC8vIGdldCBzb3VyY2UgZGF0YSBhcnJheVxyXG4gICAgICAgIGxldCBiYWNrYnVmZmVyX2RhdGEgPSBjb250ZXh0XzJkLmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLncsIHRoaXMuaCk7XHJcbiAgICAgICAgbGV0IGJhY2tidWZmZXJfZGF0YV9hcnJheSA9IGJhY2tidWZmZXJfZGF0YS5kYXRhO1xyXG5cclxuICAgICAgICBsZXQgcmF0aW8gPSB0aGlzLncgLyB0aGlzLmg7XHJcblxyXG4gICAgICAgIC8vIHNldCBhcnJheSB2YWx1ZVxyXG4gICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy5oOyArK3kpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLnc7ICsreCkge1xyXG4gICAgICAgICAgICAgICAgLy8gcmdiYSBlYWNoIGNvbG9yIGlzIDRieXRlXHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSA0ICogKHggKyB5ICogdGhpcy53KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1hcCB0byAwfjFcclxuICAgICAgICAgICAgICAgIGxldCBYID0gKHggLyB0aGlzLncpO1xyXG4gICAgICAgICAgICAgICAgbGV0IFkgPSAoeSAvIHRoaXMuaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY2hhbmdlIHkgZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBZID0gMSAtIFk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtYXAgdG8gLTF+MVxyXG4gICAgICAgICAgICAgICAgbGV0IHhfd2VpZ2h0ID0gWCAqIDIgLSAxO1xyXG4gICAgICAgICAgICAgICAgbGV0IHlfd2VpZ2h0ID0gWSAqIDIgLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBjb2xvciA9IGZ1bmMoeF93ZWlnaHQsIHlfd2VpZ2h0LCByYXRpbyk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHIgPSBjb2xvci54O1xyXG4gICAgICAgICAgICAgICAgbGV0IGcgPSBjb2xvci55O1xyXG4gICAgICAgICAgICAgICAgbGV0IGIgPSBjb2xvci56O1xyXG5cclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleCsrXSA9IE1hdGgucm91bmQociAqIDI1NSk7XHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXgrK10gPSBNYXRoLnJvdW5kKGcgKiAyNTUpO1xyXG4gICAgICAgICAgICAgICAgYmFja2J1ZmZlcl9kYXRhX2FycmF5W2luZGV4KytdID0gTWF0aC5yb3VuZChiICogMjU1KTtcclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleF0gPSAyNTU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29udGV4dF8yZC5wdXRJbWFnZURhdGEoYmFja2J1ZmZlcl9kYXRhLCAwLCAwKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93X2J1ZmZlcihjYW52YXNfaWQ6IHN0cmluZykge1xyXG4gICAgICAgIC8vIOioreWummJ1ZmZlcueahOWkp+Wwj+WSjGNzcyBzdHlsZeeahOWkp+Wwj+S4gOaoo1xyXG4gICAgICAgIC8vIGh0dHBzOi8vb3BlbmhvbWUuY2MvR29zc2lwL1dlYkdML0NhbnZhcy5odG1sXHJcbiAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhc19pZCkgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgICAgICAgY2FudmFzLnN0eWxlLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuICAgICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuICAgICAgICBjYW52YXMud2lkdGggPSBjYW52YXMuY2xpZW50V2lkdGg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGNhbnZhcy5jbGllbnRIZWlnaHQ7XHJcblxyXG4gICAgICAgIC8vIGNvcHkgYmFja2J1ZmZlciB0byBjYW52YXNcclxuICAgICAgICBsZXQgY29udGV4dF9iaXRtYXBfcmVuZGVyID0gY2FudmFzLmdldENvbnRleHQoXCJiaXRtYXByZW5kZXJlclwiKTtcclxuICAgICAgICBjb250ZXh0X2JpdG1hcF9yZW5kZXIudHJhbnNmZXJGcm9tSW1hZ2VCaXRtYXAodGhpcy5iYWNrYnVmZmVyLnRyYW5zZmVyVG9JbWFnZUJpdG1hcCgpKTtcclxuICAgIH1cclxufSIsImltcG9ydCBNYXRlcmlhbCBmcm9tIFwiLi9NYXRlcmlhbFwiO1xyXG5pbXBvcnQgSGl0YWJsZSBmcm9tIFwiLi4vTWF0aC9IaXRhYmxlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTY2VuZU5vZGUge1xyXG5cclxuICAgIG06IE1hdGVyaWFsO1xyXG4gICAgaDogSGl0YWJsZTtcclxuICAgIGNvbnN0cnVjdG9yKG06IE1hdGVyaWFsLCBoOiBIaXRhYmxlKSB7XHJcbiAgICAgICAgdGhpcy5tID0gbTtcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEFwcCBmcm9tICcuL0FwcCc7XHJcblxyXG5uZXcgQXBwKCk7IiwiaW1wb3J0IFZlY3RvciBmcm9tICcuL01hdGgvVmVjdG9yJ1xyXG5pbXBvcnQgQ2FtZXJhIGZyb20gJy4vTWF0aC9DYW1lcmEnXHJcbmltcG9ydCBSZWN0IGZyb20gJy4vTWF0aC9SZWN0JztcclxuaW1wb3J0IFBsYW5lIGZyb20gJy4vTWF0aC9QbGFuZSc7XHJcbmltcG9ydCBTcGhlcmUgZnJvbSAnLi9NYXRoL1NwaGVyZSc7XHJcbmltcG9ydCBSZW5kZXJUYXJnZXQgZnJvbSAnLi9NYXRoL1JlbmRlclRhcmdldCc7XHJcbmltcG9ydCBIaXRhYmxlIGZyb20gJy4vTWF0aC9IaXRhYmxlJztcclxuaW1wb3J0IFNjZW5lTm9kZSBmcm9tICcuL09iamVjdC9TY2VuZU5vZGUnO1xyXG5pbXBvcnQgTWF0ZXJpYWwgZnJvbSAnLi9PYmplY3QvTWF0ZXJpYWwnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG5cclxuICAgICAgICBsZXQgZmxvb3IgPSBuZXcgU2NlbmVOb2RlKE1hdGVyaWFsLndoaXRlLCBuZXcgUmVjdChuZXcgUGxhbmUoVmVjdG9yLnplcm8sIFZlY3Rvci51cCksIDE2LCAxNikpXHJcbiAgICAgICAgbGV0IG9ial9saXN0OiBTY2VuZU5vZGVbXSA9IFtmbG9vcl07XHJcbiAgICAgICAgb2JqX2xpc3QucHVzaChuZXcgU2NlbmVOb2RlKE1hdGVyaWFsLmdyZWVuLCBuZXcgU3BoZXJlKG5ldyBWZWN0b3IoNiwgMiwgLTgpLCAxKSkpO1xyXG4gICAgICAgIG9ial9saXN0LnB1c2gobmV3IFNjZW5lTm9kZShNYXRlcmlhbC55ZWxsb3csIG5ldyBTcGhlcmUobmV3IFZlY3RvcigwLCA0LCAtNiksIDQpKSk7XHJcblxyXG4gICAgICAgIGxldCBjYW1lcmEgPSBuZXcgQ2FtZXJhKG5ldyBWZWN0b3IoMCwgMjAsIC0yMCksIFZlY3Rvci56ZXJvLCA2MCk7XHJcbiAgICAgICAgbGV0IHJlbmRlcl90YXJnZXQgPSBuZXcgUmVuZGVyVGFyZ2V0KDgwMCwgNjAwKTtcclxuICAgICAgICBjYW1lcmEucmVuZGVyKHJlbmRlcl90YXJnZXQsIG9ial9saXN0KTtcclxuICAgICAgICByZW5kZXJfdGFyZ2V0LnNob3dfYnVmZmVyKCdjYW52YXMnKTtcclxuICAgIH1cclxufVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==