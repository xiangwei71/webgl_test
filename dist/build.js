!function(t){var n={};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)i.d(e,r,function(n){return t[n]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=0)}([function(t,n,i){"use strict";i.r(n);function e(t,n){return Math.abs(t-n)<.001}function r(t,n){return t.map((function(t){return t.h.hit(n,t.s)})).filter((function(t){return t.is_hit})).sort((function(t,n){return t.t-n.t}))}var o=function(){function t(t,n,i){this.x=0,this.y=0,this.z=0,this.x=t,this.y=n,this.z=i}return t.reflect=function(n,i){var e=-2*t.dot(n,i);return i.multiply(e).add(n)},t.add=function(n,i){return new t(i.x+n.x,i.y+n.y,i.z+n.z)},t.minus=function(n,i){return new t(n.x-i.x,n.y-i.y,n.z-i.z)},t.multiply=function(n,i){return new t(n.x*i,n.y*i,n.z*i)},t.multiply3=function(n,i){return new t(n.x*i.x,n.y*i.y,n.z*i.z)},t.cross=function(n,i){return new t(n.y*i.z-n.z*i.y,-n.x*i.z+n.z*i.x,n.x*i.y-n.y*i.x)},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},t.equal=function(t,n){return e(t.x,n.x)&&e(t.y,n.y)&&e(t.z,n.z)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},t.prototype.add=function(n){return t.add(this,n)},t.prototype.minus=function(n){return t.minus(this,n)},t.prototype.multiply=function(n){return t.multiply(this,n)},t.prototype.negative=function(){return t.multiply(this,-1)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.up=new t(0,1,0),t.zero=new t(0,0,0),t}(),u=function(t,n){this.from=t,this.dir=n},s=function(){function t(t){this.color=t}return t.prototype.shading=function(t,n,i,e){var r,u,s,h=t.normal,a=(r=-o.dot(n,h),u=0,r>(s=1)?s:r<u?u:r);return this.color.multiply(a)},t.yellow=new t(new o(1,1,0)),t.red=new t(new o(1,0,0)),t.green=new t(new o(0,1,0)),t.blue=new t(new o(0,0,1)),t.gray=new t(new o(.5,.5,.5)),t.white=new t(new o(1,1,1)),t}(),h=function(){function t(t,n,i){this.z_axis=o.minus(n,t).normalize();var e=o.up;this.x_axis=o.cross(e,this.z_axis).normalize(),this.y_axis=o.cross(this.z_axis,this.x_axis),this.eye=t,this.fov_degree=i}return t.prototype.create_ray_dir=function(t,n,i){var e,r=(e=.5*this.fov_degree,Math.PI*e/180),o=Math.tan(r),u=o*i;return this.z_axis.add(this.x_axis.multiply(t*u)).add(this.y_axis.multiply(n*o))},t.prototype.render=function(t,n){var i=this,e=new o(1,-1,0).normalize(),h=.5/t.h,a=[{x:0,y:0},{x:h,y:h},{x:-h,y:h},{x:-h,y:-h},{x:h,y:-h}];t.render_pixel((function(t,h,l){var f=i.create_ray_dir(t,h,l),p=a.map((function(t){var n=f.add(i.x_axis.multiply(t.x)).add(i.y_axis.multiply(t.y));return new u(i.eye,n.normalize())})).map((function(t){var i=r(n,t);if(0!=i.length){var o=i[0];return o.s.shading(o,e,n,1)}return s.gray.color})),c=a.length;return p.reduce((function(t,n){return t.add(n)}),o.zero).multiply(1/c)}))},t}(),a=function(){function t(t,n,i){this.plane=t,this.w=n,this.h=i}return t.prototype.hit=function(t,n){var i=this.plane.hit(t,n);if(i.is_hit){var e=i.hit_pos,r=e.minus(this.plane.C),u=o.equal(this.plane.N,o.up)?new o(1,0,0):o.up,s=o.cross(u,this.plane.N).normalize(),h=o.cross(s,this.plane.N),a=o.dot(r,s),l=o.dot(r,h);return{is_hit:Math.abs(a)<this.w&&Math.abs(l)<this.h,hit_pos:e,i:t.dir,t:i.t,normal:this.plane.N,s:n}}return{is_hit:!1}},t}(),l=function(){function t(t,n){this.C=t,this.N=n}return t.prototype.is_positive=function(t){var n=o.minus(t,this.C);return o.dot(n,this.N)>0},t.prototype.hit=function(t,n){var i=t.from,r=t.dir,u=o.dot(r,this.N),s=o.dot(o.minus(this.C,i),this.N);if(e(u,0))return{is_hit:!1,hit_pos:null,t:-1};var h=s/u;return{is_hit:h>0,hit_pos:i.add(r.multiply(h)),i:r,t:h,normal:this.N,s:n}},t}(),f=function(){function t(t,n){this.C=t,this.R=n}return t.prototype.hit=function(t,n){var i=t.dir,r=t.from,u=o.dot(i,i),s=2*(o.dot(i,r)-o.dot(i,this.C)),h=s*s-4*u*(o.dot(r,r)-2*o.dot(r,this.C)+o.dot(this.C,this.C)-this.R*this.R);if(e(h,0)){if((c=-s/(2*u))<0)return{is_hit:!1};var a=(p=r.add(i.multiply(c))).minus(this.C).normalize();return{is_hit:!0,hit_pos:p,i:i,t:c,normal:a,s:n}}if(h>0){var l=Math.sqrt(h),f=[(-s-l)/(2*u),(-s+l)/(2*u)].filter((function(t){return t>0}));if(0==f.length)return{is_hit:!1};var p,c=f[0];a=(p=r.add(i.multiply(c))).minus(this.C).normalize();return{is_hit:!0,hit_pos:p,i:i,t:c,normal:a,s:n}}return{is_hit:!1}},t}(),p=function(){function t(t,n){void 0===t&&(t=320),void 0===n&&(n=240),this.w=320,this.h=240,this.backbuffer=null,this.w=t,this.h=n,this.backbuffer=new OffscreenCanvas(this.w,this.h)}return t.prototype.render_pixel=function(t){for(var n=this.backbuffer.getContext("2d"),i=n.getImageData(0,0,this.w,this.h),e=i.data,r=this.w/this.h,o=0;o<this.h;++o)for(var u=0;u<this.w;++u){var s=4*(u+o*this.w),h=u/this.w,a=o/this.h,l=t(2*h-1,2*(a=1-a)-1,r),f=l.x,p=l.y,c=l.z;e[s++]=Math.round(255*f),e[s++]=Math.round(255*p),e[s++]=Math.round(255*c),e[s]=255}n.putImageData(i,0,0)},t.prototype.show_buffer=function(t){var n=document.getElementById(t);n.style.width=this.w+"px",n.style.height=this.h+"px",n.width=n.clientWidth,n.height=n.clientHeight,n.getContext("bitmaprenderer").transferFromImageBitmap(this.backbuffer.transferToImageBitmap())},t}(),c=function(t,n){this.s=t,this.h=n},y=function(){function t(){}return t.prototype.shading=function(t,n,i,e){if(e>20)return console.log("超過上限"),s.green.color;var h=t.normal,a=t.i,l=o.reflect(a,h),f=t.hit_pos.add(l.multiply(.001)),p=r(i,new u(f,l)),c=new o(1,1,1);if(0!=p.length){var y=p[0],d=y.s.shading(y,n,i,++e);return o.multiply3(c,d.multiply(.9))}return o.multiply3(c,s.gray.color.multiply(.9))},t}();new function(){var t=[new c(s.white,new a(new l(o.zero,o.up),16,16))];t.push(new c(s.yellow,new f(new o(6,2,-8),1))),t.push(new c(s.green,new f(new o(-6,2,-8),1))),t.push(new c(s.blue,new f(new o(0,2,-12),1))),t.push(new c(new y,new f(new o(0,4,-6),4))),t.push(new c(new y,new f(new o(12,4,-6),4))),t.push(new c(new y,new f(new o(8,4,2),4)));var n=new h(new o(0,20,-20),o.zero,60),i=new p(800,600);n.render(i,t),i.show_buffer("canvas")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvVG9vbC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9WZWN0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmF5LnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRlcmFpbHMvRGlmZnVzZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9DYW1lcmEudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmVjdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9QbGFuZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9TcGhlcmUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmVuZGVyVGFyZ2V0LnRzIiwid2VicGFjazovLy8uL3NyYy9PYmplY3QvU2NlbmVOb2RlLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRlcmFpbHMvTWlycm9yLnRzIiwid2VicGFjazovLy8uL3NyYy9tYWluLnRzIiwid2VicGFjazovLy8uL3NyYy9BcHAudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJudW1iZXJfZXF1YWwiLCJhIiwiYiIsIk1hdGgiLCJhYnMiLCJnZXRfaGl0X3NvcnRfbGlzdCIsIm9ial9saXN0IiwicmF5IiwibWFwIiwib2JqIiwiaCIsImhpdCIsImZpbHRlciIsImluZm8iLCJpc19oaXQiLCJzb3J0IiwicHgiLCJweSIsInB6IiwieCIsInkiLCJ6IiwidGhpcyIsInJlZmxlY3QiLCJJIiwiTiIsIkwiLCJWZWN0b3IiLCJkb3QiLCJtdWx0aXBseSIsImFkZCIsIkEiLCJCIiwibWludXMiLCJtdWx0aXBseTMiLCJjcm9zcyIsImVxdWFsIiwibGVuZ3RoIiwic3FydCIsIm5vcm1hbGl6ZSIsInRlbXAiLCJuZWdhdGl2ZSIsImNsb25lIiwidXAiLCJ6ZXJvIiwiZnJvbSIsImRpciIsImNvbG9yIiwic2hhZGluZyIsImhpdF9pbmZvIiwiZGlyZWN0aW9uX2xpZ2h0X2RpciIsImRlcHRoIiwibm9ybWFsIiwic3RyZW5ndGgiLCJ5ZWxsb3ciLCJEaWZmdXNlIiwicmVkIiwiZ3JlZW4iLCJibHVlIiwiZ3JheSIsIndoaXRlIiwiZXllIiwibG9va19hdCIsImZvdl9kZWdyZWUiLCJ6X2F4aXMiLCJoZWxwX3YiLCJ4X2F4aXMiLCJ5X2F4aXMiLCJjcmVhdGVfcmF5X2RpciIsInhfd2VpZ2h0IiwieV93ZWlnaHQiLCJyYXRpbyIsImhhbGZfZm92X3JhZCIsIlBJIiwidGFuX2giLCJ0YW4iLCJ0YW5fdyIsInJlbmRlciIsInJlbmRlcl90YXJnZXQiLCJoYWxmX3BpeGVsX29mZnNldCIsIm11bHRpc2FtcGxlX2RpZmYiLCJyZW5kZXJfcGl4ZWwiLCJyYXlfZGlyIiwiY29sb3JzIiwiZGlmZiIsImhpdF9zb3J0X2xpc3QiLCJjb3VudCIsInJlZHVjZSIsImFjY3VtdWxhdG9yIiwiY3VycmVudCIsInBsYW5lIiwidyIsInJlc3VsdCIsImhpdF9wb3MiLCJDIiwid19heGlzIiwiaF9heGlzIiwid192YWx1ZSIsImhfdmFsdWUiLCJwb2ludCIsImlzX3Bvc2l0aXZlIiwidGVzdF9wIiwiUiIsIkQiLCJGIiwiayIsInNxcnRfayIsInRfbGlzdCIsImJhY2tidWZmZXIiLCJPZmZzY3JlZW5DYW52YXMiLCJmdW5jIiwiY29udGV4dF8yZCIsImdldENvbnRleHQiLCJiYWNrYnVmZmVyX2RhdGEiLCJnZXRJbWFnZURhdGEiLCJiYWNrYnVmZmVyX2RhdGFfYXJyYXkiLCJkYXRhIiwiaW5kZXgiLCJYIiwiWSIsImciLCJyb3VuZCIsInB1dEltYWdlRGF0YSIsInNob3dfYnVmZmVyIiwiY2FudmFzX2lkIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsInRyYW5zZmVyRnJvbUltYWdlQml0bWFwIiwidHJhbnNmZXJUb0ltYWdlQml0bWFwIiwiY29uc29sZSIsImxvZyIsImhpdF9pbmZvX25leHQiLCJoaXRfY29sb3IiLCJwdXNoIiwiY2FtZXJhIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRy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RUFBTyxJQUFJLEVBQU8sRUFBRyxHQUFJLEdBQUksS0FDN0VoRCxFQUFTcUksS0FBSyxJQUFJLEVBQVUsRUFBUWxGLE1BQU8sSUFBSSxFQUFPLElBQUksR0FBUSxFQUFHLEdBQUksR0FBSSxLQUM3RW5ELEVBQVNxSSxLQUFLLElBQUksRUFBVSxFQUFRakYsS0FBTSxJQUFJLEVBQU8sSUFBSSxFQUFPLEVBQUcsR0FBSSxJQUFLLEtBRTVFcEQsRUFBU3FJLEtBQUssSUFBSSxFQUFVLElBQUksRUFBVSxJQUFJLEVBQU8sSUFBSSxFQUFPLEVBQUcsR0FBSSxHQUFJLEtBQzNFckksRUFBU3FJLEtBQUssSUFBSSxFQUFVLElBQUksRUFBVSxJQUFJLEVBQU8sSUFBSSxFQUFPLEdBQUksR0FBSSxHQUFJLEtBQzVFckksRUFBU3FJLEtBQUssSUFBSSxFQUFVLElBQUksRUFBVSxJQUFJLEVBQU8sSUFBSSxFQUFPLEVBQUcsRUFBRyxHQUFJLEtBRTFFLElBQUlDLEVBQVMsSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLElBQUssSUFBSyxFQUFPaEcsS0FBTSxJQUN6RGtDLEVBQWdCLElBQUksRUFBYSxJQUFLLEtBQzFDOEQsRUFBTy9ELE9BQU9DLEVBQWV4RSxHQUM3QndFLEVBQWM2QyxZQUFZIiwiZmlsZSI6ImJ1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IFNjZW5lTm9kZSBmcm9tIFwiLi4vT2JqZWN0L1NjZW5lTm9kZVwiO1xyXG5pbXBvcnQgUmF5IGZyb20gXCIuL1JheVwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi9IaXRJbmZvXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGVncmVlX3RvX1JhZChkOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBNYXRoLlBJICogZCAvIDE4MDtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlcHNpbG9uOiBudW1iZXIgPSAwLjAwMTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBudW1iZXJfZXF1YWwoYTogbnVtYmVyLCBiOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBNYXRoLmFicyhhIC0gYikgPCBlcHNpbG9uO1xyXG59XHJcblxyXG4vKipcclxuICogXHJcbiAqIEBwYXJhbSB4IGlucHV0XHJcbiAqIEBwYXJhbSBhIG1pbiBcclxuICogQHBhcmFtIGIgbWF4XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY2xhbXAoeDogbnVtYmVyLCBhOiBudW1iZXIsIGI6IG51bWJlcikge1xyXG4gICAgaWYgKHggPiBiKVxyXG4gICAgICAgIHJldHVybiBiO1xyXG4gICAgZWxzZSBpZiAoeCA8IGEpXHJcbiAgICAgICAgcmV0dXJuIGE7XHJcbiAgICBlbHNlXHJcbiAgICAgICAgcmV0dXJuIHg7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRfaGl0X3NvcnRfbGlzdChvYmpfbGlzdDogU2NlbmVOb2RlW10sIHJheTogUmF5KSB7XHJcbiAgICBsZXQgaGl0X3NvcnRfbGlzdCA9IG9ial9saXN0Lm1hcChvYmogPT4gb2JqLmguaGl0KHJheSwgb2JqLnMpKVxyXG4gICAgICAgIC5maWx0ZXIoaW5mbyA9PiBpbmZvLmlzX2hpdClcclxuICAgICAgICAuc29ydCgoYTogSGl0SW5mbywgYjogSGl0SW5mbykgPT4gYS50IC0gYi50KTtcclxuXHJcbiAgICByZXR1cm4gaGl0X3NvcnRfbGlzdDtcclxufSIsImltcG9ydCB7IG51bWJlcl9lcXVhbCB9IGZyb20gJy4vVG9vbCdcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWZWN0b3Ige1xyXG5cclxuICAgIHN0YXRpYyB1cCA9IG5ldyBWZWN0b3IoMCwgMSwgMCk7XHJcbiAgICBzdGF0aWMgemVybyA9IG5ldyBWZWN0b3IoMCwgMCwgMCk7XHJcblxyXG4gICAgc3RhdGljIHJlZmxlY3QoSTogVmVjdG9yLCBOOiBWZWN0b3IpIHtcclxuICAgICAgICBsZXQgTCA9IC0yICogVmVjdG9yLmRvdChJLCBOKVxyXG4gICAgICAgIHJldHVybiBOLm11bHRpcGx5KEwpLmFkZChJKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgYWRkKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEIueCArIEEueCwgQi55ICsgQS55LCBCLnogKyBBLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG1pbnVzKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAtIEIueCwgQS55IC0gQi55LCBBLnogLSBCLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG11bHRpcGx5KEE6IFZlY3RvciwgczogbnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAqIHMsIEEueSAqIHMsIEEueiAqIHMpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG11bHRpcGx5MyhBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKEEueCAqIEIueCwgQS55ICogQi55LCBBLnogKiBCLnopO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBjcm9zcyhBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHZhciB0ZW1wID0gbmV3IFZlY3RvcihBLnkgKiBCLnogLSBBLnogKiBCLnksIC1BLnggKiBCLnogKyBBLnogKiBCLngsIEEueCAqIEIueSAtIEEueSAqIEIueCk7XHJcbiAgICAgICAgcmV0dXJuIHRlbXA7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGRvdChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBBLnggKiBCLnggKyBBLnkgKiBCLnkgKyBBLnogKiBCLno7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGVxdWFsKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bWJlcl9lcXVhbChBLngsIEIueCkgJiYgbnVtYmVyX2VxdWFsKEEueSwgQi55KSAmJiBudW1iZXJfZXF1YWwoQS56LCBCLnopO1xyXG4gICAgfVxyXG5cclxuICAgIHg6IG51bWJlciA9IDA7XHJcbiAgICB5OiBudW1iZXIgPSAwO1xyXG4gICAgejogbnVtYmVyID0gMDtcclxuICAgIGNvbnN0cnVjdG9yKHB4OiBudW1iZXIsIHB5OiBudW1iZXIsIHB6OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnggPSBweDtcclxuICAgICAgICB0aGlzLnkgPSBweTtcclxuICAgICAgICB0aGlzLnogPSBwejtcclxuICAgIH1cclxuXHJcbiAgICBsZW5ndGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnopO1xyXG4gICAgfVxyXG5cclxuICAgIG5vcm1hbGl6ZSgpIHtcclxuICAgICAgICB2YXIgdGVtcCA9IHRoaXMubGVuZ3RoKCk7XHJcbiAgICAgICAgdGhpcy54ID0gdGhpcy54IC8gdGVtcDtcclxuICAgICAgICB0aGlzLnkgPSB0aGlzLnkgLyB0ZW1wO1xyXG4gICAgICAgIHRoaXMueiA9IHRoaXMueiAvIHRlbXA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkKEE6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBWZWN0b3IuYWRkKHRoaXMsIEEpO1xyXG4gICAgfVxyXG5cclxuICAgIG1pbnVzKEE6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBWZWN0b3IubWludXModGhpcywgQSk7XHJcbiAgICB9XHJcblxyXG4gICAgbXVsdGlwbHkoczogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5tdWx0aXBseSh0aGlzLCBzKTtcclxuICAgIH1cclxuXHJcbiAgICBuZWdhdGl2ZSgpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLm11bHRpcGx5KHRoaXMsIC0xKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9uZSgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFZlY3Rvcih0aGlzLngsIHRoaXMueSwgdGhpcy56KTtcclxuICAgIH1cclxufSIsImltcG9ydCBWZWNvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJheSB7XHJcbiAgICBmcm9tOiBWZWNvcjtcclxuICAgIGRpcjogVmVjb3I7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZnJvbTogVmVjb3IsIGRpcjogVmVjb3IpIHtcclxuICAgICAgICB0aGlzLmZyb20gPSBmcm9tO1xyXG4gICAgICAgIHRoaXMuZGlyID0gZGlyO1xyXG4gICAgfVxyXG59OyIsImltcG9ydCBWZWN0b3IgZnJvbSBcIi4uL01hdGgvVmVjdG9yXCI7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gXCIuLi9NYXRoL0hpdEluZm9cIjtcclxuaW1wb3J0IHsgY2xhbXAgfSBmcm9tIFwiLi4vTWF0aC9Ub29sXCI7XHJcbmltcG9ydCBTaGFkZXIgZnJvbSBcIi4vU2hhZGVyXCI7XHJcbmltcG9ydCBTY2VuZU5vZGUgZnJvbSBcIi4uL09iamVjdC9TY2VuZU5vZGVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERpZmZ1c2UgaW1wbGVtZW50cyBTaGFkZXIge1xyXG4gICAgc3RhdGljIHllbGxvdyA9IG5ldyBEaWZmdXNlKG5ldyBWZWN0b3IoMSwgMSwgMCkpO1xyXG4gICAgc3RhdGljIHJlZCA9IG5ldyBEaWZmdXNlKG5ldyBWZWN0b3IoMSwgMCwgMCkpO1xyXG4gICAgc3RhdGljIGdyZWVuID0gbmV3IERpZmZ1c2UobmV3IFZlY3RvcigwLCAxLCAwKSk7XHJcbiAgICBzdGF0aWMgYmx1ZSA9IG5ldyBEaWZmdXNlKG5ldyBWZWN0b3IoMCwgMCwgMSkpO1xyXG4gICAgc3RhdGljIGdyYXkgPSBuZXcgRGlmZnVzZShuZXcgVmVjdG9yKDAuNSwgMC41LCAwLjUpKTtcclxuICAgIHN0YXRpYyB3aGl0ZSA9IG5ldyBEaWZmdXNlKG5ldyBWZWN0b3IoMSwgMSwgMSkpO1xyXG5cclxuICAgIGNvbG9yOiBWZWN0b3I7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb2xvcjogVmVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5jb2xvciA9IGNvbG9yO1xyXG4gICAgfVxyXG5cclxuICAgIHNoYWRpbmcoaGl0X2luZm86IEhpdEluZm8sIGRpcmVjdGlvbl9saWdodF9kaXI6IFZlY3Rvciwgb2JqX2xpc3Q6IFNjZW5lTm9kZVtdLCBkZXB0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IG4gPSBoaXRfaW5mby5ub3JtYWw7XHJcbiAgICAgICAgbGV0IHN0cmVuZ3RoID0gY2xhbXAoLVZlY3Rvci5kb3QoZGlyZWN0aW9uX2xpZ2h0X2RpciwgbiksIDAsIDEpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5jb2xvci5tdWx0aXBseShzdHJlbmd0aCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5pbXBvcnQgUmF5IGZyb20gXCIuL1JheVwiO1xyXG5pbXBvcnQgeyBkZWdyZWVfdG9fUmFkLCBnZXRfaGl0X3NvcnRfbGlzdCB9IGZyb20gXCIuL1Rvb2xcIlxyXG5pbXBvcnQgUmVuZGVyVGFyZ2V0IGZyb20gXCIuL1JlbmRlclRhcmdldFwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi9IaXRJbmZvXCI7XHJcbmltcG9ydCBTY2VuZU5vZGUgZnJvbSBcIi4uL09iamVjdC9TY2VuZU5vZGVcIjtcclxuaW1wb3J0IERpZmZ1c2UgZnJvbSBcIi4uL01hdGVyYWlscy9EaWZmdXNlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYW1lcmEge1xyXG4gICAgZXllOiBWZWN0b3I7XHJcblxyXG4gICAgeF9heGlzOiBWZWN0b3I7XHJcbiAgICB5X2F4aXM6IFZlY3RvcjtcclxuICAgIHpfYXhpczogVmVjdG9yO1xyXG5cclxuICAgIGZvdl9kZWdyZWU6IG51bWJlcjtcclxuICAgIGNvbnN0cnVjdG9yKGV5ZTogVmVjdG9yLCBsb29rX2F0OiBWZWN0b3IsIGZvdl9kZWdyZWU6IG51bWJlcikge1xyXG5cclxuICAgICAgICAvLyBjYW1lcmEgM+i7uFxyXG4gICAgICAgIHRoaXMuel9heGlzID0gVmVjdG9yLm1pbnVzKGxvb2tfYXQsIGV5ZSkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBoZWxwX3YgPSBWZWN0b3IudXA7XHJcbiAgICAgICAgdGhpcy54X2F4aXMgPSBWZWN0b3IuY3Jvc3MoaGVscF92LCB0aGlzLnpfYXhpcykubm9ybWFsaXplKCk7XHJcbiAgICAgICAgdGhpcy55X2F4aXMgPSBWZWN0b3IuY3Jvc3ModGhpcy56X2F4aXMsIHRoaXMueF9heGlzKTtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIOWOn+m7nlxyXG4gICAgICAgIHRoaXMuZXllID0gZXllO1xyXG5cclxuICAgICAgICAvLyBjYW1lcmEgZm92XHJcbiAgICAgICAgdGhpcy5mb3ZfZGVncmVlID0gZm92X2RlZ3JlZTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVfcmF5X2Rpcih4X3dlaWdodDogbnVtYmVyLCB5X3dlaWdodDogbnVtYmVyLCByYXRpbzogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IGhhbGZfZm92X3JhZCA9IGRlZ3JlZV90b19SYWQoMC41ICogdGhpcy5mb3ZfZGVncmVlKTtcclxuICAgICAgICBsZXQgdGFuX2ggPSBNYXRoLnRhbihoYWxmX2Zvdl9yYWQpO1xyXG4gICAgICAgIGxldCB0YW5fdyA9IHRhbl9oICogcmF0aW87XHJcblxyXG4gICAgICAgIGxldCBkaXIgPSB0aGlzLnpfYXhpc1xyXG4gICAgICAgICAgICAuYWRkKHRoaXMueF9heGlzLm11bHRpcGx5KHhfd2VpZ2h0ICogdGFuX3cpKVxyXG4gICAgICAgICAgICAuYWRkKHRoaXMueV9heGlzLm11bHRpcGx5KHlfd2VpZ2h0ICogdGFuX2gpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRpcjtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIocmVuZGVyX3RhcmdldDogUmVuZGVyVGFyZ2V0LCBvYmpfbGlzdDogU2NlbmVOb2RlW10pIHtcclxuICAgICAgICBsZXQgZGlyZWN0aW9uX2xpZ2h0X2RpciA9IG5ldyBWZWN0b3IoMSwgLTEsIDApLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgaGFsZl9waXhlbF9vZmZzZXQgPSAwLjUgLyByZW5kZXJfdGFyZ2V0Lmg7XHJcbiAgICAgICAgbGV0IG11bHRpc2FtcGxlX2RpZmYgPSBbXHJcbiAgICAgICAgICAgIHsgeDogMCwgeTogMCB9LFxyXG4gICAgICAgICAgICB7IHg6IGhhbGZfcGl4ZWxfb2Zmc2V0LCB5OiBoYWxmX3BpeGVsX29mZnNldCB9LFxyXG4gICAgICAgICAgICB7IHg6IC1oYWxmX3BpeGVsX29mZnNldCwgeTogaGFsZl9waXhlbF9vZmZzZXQgfSxcclxuICAgICAgICAgICAgeyB4OiAtaGFsZl9waXhlbF9vZmZzZXQsIHk6IC1oYWxmX3BpeGVsX29mZnNldCB9LFxyXG4gICAgICAgICAgICB7IHg6IGhhbGZfcGl4ZWxfb2Zmc2V0LCB5OiAtaGFsZl9waXhlbF9vZmZzZXQgfSxcclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICByZW5kZXJfdGFyZ2V0LnJlbmRlcl9waXhlbCgoeF93ZWlnaHQ6IG51bWJlciwgeV93ZWlnaHQ6IG51bWJlciwgcmF0aW86IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcmF5X2RpciA9IHRoaXMuY3JlYXRlX3JheV9kaXIoeF93ZWlnaHQsIHlfd2VpZ2h0LCByYXRpbyk7XHJcblxyXG4gICAgICAgICAgICAvLyDnlKLnlJ/lpJrmop1yYXlcclxuICAgICAgICAgICAgbGV0IHJheXMgPSBtdWx0aXNhbXBsZV9kaWZmLm1hcChkaWZmID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIOWwjXJheV9kcmnkvZzlgY/np7tcclxuICAgICAgICAgICAgICAgIGxldCBkaXIgPSByYXlfZGlyLmFkZCh0aGlzLnhfYXhpcy5tdWx0aXBseShkaWZmLngpKS5hZGQodGhpcy55X2F4aXMubXVsdGlwbHkoZGlmZi55KSlcclxuXHJcbiAgICAgICAgICAgICAgICAvLyDpm5bnhLblkoznkIPjgIHlubPpnaLnmoRoaXToqIjnrpfkuI3pnIDopoFkaXLkvZxub3JtYWxpemXvvIzkvYbngrrkuobmlrnkvr/lj43lsITnmoToqIjnrpfpgoTmmK/kvZxub3JtYWxpemVcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmF5KHRoaXMuZXllLCBkaXIubm9ybWFsaXplKCkpXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8g5q+P5YCLcmF56YO9566XY29sb3JcclxuICAgICAgICAgICAgbGV0IGNvbG9ycyA9IHJheXMubWFwKHJheSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaGl0X3NvcnRfbGlzdCA9IGdldF9oaXRfc29ydF9saXN0KG9ial9saXN0LCByYXkpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIOacieWwhOS4reWXjlxyXG4gICAgICAgICAgICAgICAgbGV0IGlzX2hpdCA9IGhpdF9zb3J0X2xpc3QubGVuZ3RoICE9IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNfaGl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGhpdF9pbmZvID0gaGl0X3NvcnRfbGlzdFswXTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaGl0X2luZm8ucy5zaGFkaW5nKGhpdF9pbmZvLCBkaXJlY3Rpb25fbGlnaHRfZGlyLCBvYmpfbGlzdCwgMSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBEaWZmdXNlLmdyYXkuY29sb3I7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8g5Y+W5bmz5Z2H5bCx5pyJQW50aWFsaWFzaW5n5pWI5p6cXHJcbiAgICAgICAgICAgIGxldCBjb3VudCA9IG11bHRpc2FtcGxlX2RpZmYubGVuZ3RoO1xyXG4gICAgICAgICAgICBsZXQgZmluYWxfY29sb3IgPSBjb2xvcnMucmVkdWNlKChhY2N1bXVsYXRvcjogVmVjdG9yLCBjdXJyZW50OiBWZWN0b3IpID0+IGFjY3VtdWxhdG9yLmFkZChjdXJyZW50KSwgVmVjdG9yLnplcm8pLm11bHRpcGx5KDEgLyBjb3VudCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmaW5hbF9jb2xvcjtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBsYW5lIGZyb20gXCIuL1BsYW5lXCI7XHJcbmltcG9ydCBSYXkgZnJvbSBcIi4vUmF5XCI7XHJcbmltcG9ydCBWZWN0b3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gXCIuL0hpdEluZm9cIjtcclxuaW1wb3J0IEhpdGFibGUgZnJvbSBcIi4vSGl0YWJsZVwiO1xyXG5pbXBvcnQgU2hhZGVyIGZyb20gXCIuLi9NYXRlcmFpbHMvU2hhZGVyXCI7XHJcblxyXG4vLyDlsI/mlrnloYpcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVjdCBpbXBsZW1lbnRzIEhpdGFibGUge1xyXG4gICAgcGxhbmU6IFBsYW5lO1xyXG4gICAgdzogbnVtYmVyO1xyXG4gICAgaDogbnVtYmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBsYW5lOiBQbGFuZSwgdzogbnVtYmVyLCBoOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnBsYW5lID0gcGxhbmU7XHJcbiAgICAgICAgdGhpcy53ID0gdztcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChyYXk6IFJheSwgczogU2hhZGVyKTogSGl0SW5mbyB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMucGxhbmUuaGl0KHJheSwgcyk7XHJcbiAgICAgICAgaWYgKHJlc3VsdC5pc19oaXQpIHtcclxuICAgICAgICAgICAgbGV0IGhpdF9wb3MgPSByZXN1bHQuaGl0X3BvcztcclxuICAgICAgICAgICAgbGV0IGRpZmYgPSBoaXRfcG9zLm1pbnVzKHRoaXMucGxhbmUuQyk7XHJcblxyXG4gICAgICAgICAgICAvLyDpgb/plovnm7jnrYnnmoTmg4Xms4FcclxuICAgICAgICAgICAgbGV0IGhlbHBfdiA9IFZlY3Rvci5lcXVhbCh0aGlzLnBsYW5lLk4sIFZlY3Rvci51cCkgPyBuZXcgVmVjdG9yKDEsIDAsIDApIDogVmVjdG9yLnVwO1xyXG5cclxuICAgICAgICAgICAgbGV0IHdfYXhpcyA9IFZlY3Rvci5jcm9zcyhoZWxwX3YsIHRoaXMucGxhbmUuTikubm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIGxldCBoX2F4aXMgPSBWZWN0b3IuY3Jvc3Mod19heGlzLCB0aGlzLnBsYW5lLk4pO1xyXG4gICAgICAgICAgICBsZXQgd192YWx1ZSA9IFZlY3Rvci5kb3QoZGlmZiwgd19heGlzKTtcclxuICAgICAgICAgICAgbGV0IGhfdmFsdWUgPSBWZWN0b3IuZG90KGRpZmYsIGhfYXhpcyk7XHJcblxyXG4gICAgICAgICAgICBsZXQgaXNfaGl0ID0gTWF0aC5hYnMod192YWx1ZSkgPCB0aGlzLncgJiYgTWF0aC5hYnMoaF92YWx1ZSkgPCB0aGlzLmg7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQsXHJcbiAgICAgICAgICAgICAgICBoaXRfcG9zLFxyXG4gICAgICAgICAgICAgICAgaTogcmF5LmRpcixcclxuICAgICAgICAgICAgICAgIHQ6IHJlc3VsdC50LFxyXG4gICAgICAgICAgICAgICAgbm9ybWFsOiB0aGlzLnBsYW5lLk4sXHJcbiAgICAgICAgICAgICAgICBzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaXNfaGl0OiBmYWxzZSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCBWZWN0b3IgZnJvbSAnLi9WZWN0b3InO1xyXG5pbXBvcnQgUmF5IGZyb20gJy4vUmF5JztcclxuaW1wb3J0IHsgbnVtYmVyX2VxdWFsIH0gZnJvbSAnLi9Ub29sJztcclxuaW1wb3J0IEhpdEluZm8gZnJvbSAnLi9IaXRJbmZvJztcclxuaW1wb3J0IEhpdGFibGUgZnJvbSAnLi9IaXRhYmxlJztcclxuaW1wb3J0IFNoYWRlciBmcm9tICcuLi9NYXRlcmFpbHMvU2hhZGVyJztcclxuXHJcbi8vIOW5s+mdolxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbGFuZSBpbXBsZW1lbnRzIEhpdGFibGUge1xyXG5cclxuICAgIEM6IFZlY3RvcjtcclxuICAgIE46IFZlY3RvcjtcclxuICAgIGNvbnN0cnVjdG9yKHBvaW50OiBWZWN0b3IsIG5vcm1hbDogVmVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5DID0gcG9pbnQ7XHJcbiAgICAgICAgdGhpcy5OID0gbm9ybWFsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOa4rOippnRlc3BfcOWSjOaWueWQkemHj+aYr+S4jeaYr+WcqOWQjOS4gOmCilxyXG4gICAgaXNfcG9zaXRpdmUodGVzdF9wOiBWZWN0b3IpIHtcclxuICAgICAgICBsZXQgZGlmZiA9IFZlY3Rvci5taW51cyh0ZXN0X3AsIHRoaXMuQyk7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gVmVjdG9yLmRvdChkaWZmLCB0aGlzLk4pO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSA+IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaGl0KHJheTogUmF5LCBzOiBTaGFkZXIpOiBIaXRJbmZvIHtcclxuICAgICAgICAvLyByYXkgaGl0IHBsYW5lIFxyXG4gICAgICAgIGxldCBmcm9tID0gcmF5LmZyb207XHJcbiAgICAgICAgbGV0IGRpciA9IHJheS5kaXI7XHJcblxyXG4gICAgICAgIC8vIChGLUMp44CCTiArIHQgKETjgIJOKSA9IDBcclxuICAgICAgICAvLyB0ICA9IChDLUYp44CCTiAvIChE44CCTilcclxuICAgICAgICAvLyB0ICA9IChBIC8gKEIpXHJcbiAgICAgICAgbGV0IEIgPSBWZWN0b3IuZG90KGRpciwgdGhpcy5OKTtcclxuICAgICAgICBsZXQgQSA9IFZlY3Rvci5kb3QoVmVjdG9yLm1pbnVzKHRoaXMuQywgZnJvbSksIHRoaXMuTik7XHJcblxyXG4gICAgICAgIC8vIGF2b2lkIGRpdmlkZSBieSAwXHJcbiAgICAgICAgaWYgKG51bWJlcl9lcXVhbChCLCAwKSlcclxuICAgICAgICAgICAgcmV0dXJuIHsgaXNfaGl0OiBmYWxzZSwgaGl0X3BvczogbnVsbCwgdDogLTEgfTtcclxuXHJcbiAgICAgICAgbGV0IHQgPSBBIC8gQjtcclxuICAgICAgICBsZXQgaXNfaGl0ID0gdCA+IDAuMDtcclxuICAgICAgICBsZXQgaGl0X3BvcyA9IGZyb20uYWRkKGRpci5tdWx0aXBseSh0KSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaXNfaGl0LFxyXG4gICAgICAgICAgICBoaXRfcG9zLFxyXG4gICAgICAgICAgICBpOiBkaXIsXHJcbiAgICAgICAgICAgIHQsXHJcbiAgICAgICAgICAgIG5vcm1hbDogdGhpcy5OLFxyXG4gICAgICAgICAgICBzXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IHsgbnVtYmVyX2VxdWFsIH0gZnJvbSAnLi9Ub29sJztcclxuaW1wb3J0IEhpdEluZm8gZnJvbSBcIi4vSGl0SW5mb1wiO1xyXG5pbXBvcnQgSGl0YWJsZSBmcm9tIFwiLi9IaXRhYmxlXCI7XHJcbmltcG9ydCBTaGFkZXIgZnJvbSBcIi4uL01hdGVyYWlscy9TaGFkZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNwaGVyZSBpbXBsZW1lbnRzIEhpdGFibGUge1xyXG5cclxuICAgIEM6IFZlY3RvcjsgLy8g55CD5Lit5b+DXHJcbiAgICBSOiBudW1iZXI7IC8vIOeQg+WNiuW+kVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKEM6IFZlY3RvciwgUjogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5DID0gQztcclxuICAgICAgICB0aGlzLlIgPSBSO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChyYXk6IFJheSwgczogU2hhZGVyKTogSGl0SW5mbyB7XHJcbiAgICAgICAgLy8g6KejMuasoeaWueeoi+W8j1xyXG4gICAgICAgIC8vIChYLUMp44CCKFgtQykgPSBSKlJcclxuICAgICAgICAvLyBYPUYrdCpEXHJcbiAgICAgICAgLy8gdD1bKC1iLXNxcnRfaykvMmEsKC1iK3NxcnRfaykvMmFdXHJcbiAgICAgICAgbGV0IEQgPSByYXkuZGlyO1xyXG4gICAgICAgIGxldCBGID0gcmF5LmZyb207XHJcbiAgICAgICAgbGV0IGEgPSBWZWN0b3IuZG90KEQsIEQpO1xyXG4gICAgICAgIGxldCBiID0gMiAqIChWZWN0b3IuZG90KEQsIEYpIC0gVmVjdG9yLmRvdChELCB0aGlzLkMpKTtcclxuICAgICAgICBsZXQgYyA9IFZlY3Rvci5kb3QoRiwgRikgLSAyICogVmVjdG9yLmRvdChGLCB0aGlzLkMpICsgVmVjdG9yLmRvdCh0aGlzLkMsIHRoaXMuQykgLSB0aGlzLlIgKiB0aGlzLlI7XHJcblxyXG4gICAgICAgIGxldCBrID0gYiAqIGIgLSA0ICogYSAqIGM7XHJcbiAgICAgICAgaWYgKG51bWJlcl9lcXVhbChrLCAwKSkgeyAgLy8g5Lqk5pa8Mem7nlxyXG4gICAgICAgICAgICBsZXQgdCA9IC1iIC8gKDIgKiBhKTtcclxuXHJcbiAgICAgICAgICAgIC8v5pOL5o6JXHJcbiAgICAgICAgICAgIGlmICh0IDwgMCkgeyByZXR1cm4geyBpc19oaXQ6IGZhbHNlIH0gfVxyXG5cclxuICAgICAgICAgICAgbGV0IGhpdF9wb3MgPSBGLmFkZChELm11bHRpcGx5KHQpKTtcclxuICAgICAgICAgICAgbGV0IG5vcm1hbCA9IGhpdF9wb3MubWludXModGhpcy5DKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGhpdF9wb3MsXHJcbiAgICAgICAgICAgICAgICBpOiBELFxyXG4gICAgICAgICAgICAgICAgdCxcclxuICAgICAgICAgICAgICAgIG5vcm1hbCxcclxuICAgICAgICAgICAgICAgIHNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChrID4gMCkgeyAvLyDkuqTmlrwy6bueXHJcblxyXG4gICAgICAgICAgICAvLyDpgY7mv77lh7p0PjBcclxuICAgICAgICAgICAgLy8gcmF5LmZyb23lnKjnkIPlhafnkIPmnInlj6/og73lh7rnj750PDBcclxuICAgICAgICAgICAgLy8g55CD5ZyocmF555qE5b6M6Z2i5Lmf5Y+v6IO95Ye654++dDwwXHJcbiAgICAgICAgICAgIGxldCBzcXJ0X2sgPSBNYXRoLnNxcnQoayk7XHJcbiAgICAgICAgICAgIGxldCB0X2xpc3QgPSBbKC1iIC0gc3FydF9rKSAvICgyICogYSksICgtYiArIHNxcnRfaykgLyAoMiAqIGEpXS5maWx0ZXIoeCA9PiB4ID4gMCk7XHJcblxyXG4gICAgICAgICAgICAvLyDpg73mmK/osqDlgLxcclxuICAgICAgICAgICAgaWYgKHRfbGlzdC5sZW5ndGggPT0gMCkgeyByZXR1cm4geyBpc19oaXQ6IGZhbHNlIH0gfVxyXG5cclxuICAgICAgICAgICAgbGV0IHQgPSB0X2xpc3RbMF07XHJcbiAgICAgICAgICAgIGxldCBoaXRfcG9zID0gRi5hZGQoRC5tdWx0aXBseSh0KSk7XHJcbiAgICAgICAgICAgIGxldCBub3JtYWwgPSBoaXRfcG9zLm1pbnVzKHRoaXMuQykubm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBoaXRfcG9zLFxyXG4gICAgICAgICAgICAgICAgaTogRCxcclxuICAgICAgICAgICAgICAgIHQsXHJcbiAgICAgICAgICAgICAgICBub3JtYWwsXHJcbiAgICAgICAgICAgICAgICBzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgeyAvLyDmspLkuqTpu55cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW5kZXJUYXJnZXQge1xyXG4gICAgdzogbnVtYmVyID0gMzIwO1xyXG4gICAgaDogbnVtYmVyID0gMjQwO1xyXG4gICAgYmFja2J1ZmZlcjogT2Zmc2NyZWVuQ2FudmFzID0gbnVsbDtcclxuICAgIGNvbnN0cnVjdG9yKHc6IG51bWJlciA9IDMyMCwgaDogbnVtYmVyID0gMjQwKSB7XHJcbiAgICAgICAgdGhpcy53ID0gdztcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgICAgIHRoaXMuYmFja2J1ZmZlciA9IG5ldyBPZmZzY3JlZW5DYW52YXModGhpcy53LCB0aGlzLmgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcl9waXhlbChmdW5jOiAoeF93ZWlnaHQ6IG51bWJlciwgeV93ZWlnaHQ6IG51bWJlciwgcmF0aW86IG51bWJlcikgPT4gVmVjdG9yKSB7XHJcblxyXG4gICAgICAgIGxldCBjb250ZXh0XzJkID0gdGhpcy5iYWNrYnVmZmVyLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG4gICAgICAgIC8vIGdldCBzb3VyY2UgZGF0YSBhcnJheVxyXG4gICAgICAgIGxldCBiYWNrYnVmZmVyX2RhdGEgPSBjb250ZXh0XzJkLmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLncsIHRoaXMuaCk7XHJcbiAgICAgICAgbGV0IGJhY2tidWZmZXJfZGF0YV9hcnJheSA9IGJhY2tidWZmZXJfZGF0YS5kYXRhO1xyXG5cclxuICAgICAgICBsZXQgcmF0aW8gPSB0aGlzLncgLyB0aGlzLmg7XHJcblxyXG4gICAgICAgIC8vIHNldCBhcnJheSB2YWx1ZVxyXG4gICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgdGhpcy5oOyArK3kpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLnc7ICsreCkge1xyXG4gICAgICAgICAgICAgICAgLy8gcmdiYSBlYWNoIGNvbG9yIGlzIDRieXRlXHJcbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSA0ICogKHggKyB5ICogdGhpcy53KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1hcCB0byAwfjFcclxuICAgICAgICAgICAgICAgIGxldCBYID0gKHggLyB0aGlzLncpO1xyXG4gICAgICAgICAgICAgICAgbGV0IFkgPSAoeSAvIHRoaXMuaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY2hhbmdlIHkgZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBZID0gMSAtIFk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtYXAgdG8gLTF+MVxyXG4gICAgICAgICAgICAgICAgbGV0IHhfd2VpZ2h0ID0gWCAqIDIgLSAxO1xyXG4gICAgICAgICAgICAgICAgbGV0IHlfd2VpZ2h0ID0gWSAqIDIgLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBjb2xvciA9IGZ1bmMoeF93ZWlnaHQsIHlfd2VpZ2h0LCByYXRpbyk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHIgPSBjb2xvci54O1xyXG4gICAgICAgICAgICAgICAgbGV0IGcgPSBjb2xvci55O1xyXG4gICAgICAgICAgICAgICAgbGV0IGIgPSBjb2xvci56O1xyXG5cclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleCsrXSA9IE1hdGgucm91bmQociAqIDI1NSk7XHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXgrK10gPSBNYXRoLnJvdW5kKGcgKiAyNTUpO1xyXG4gICAgICAgICAgICAgICAgYmFja2J1ZmZlcl9kYXRhX2FycmF5W2luZGV4KytdID0gTWF0aC5yb3VuZChiICogMjU1KTtcclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleF0gPSAyNTU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29udGV4dF8yZC5wdXRJbWFnZURhdGEoYmFja2J1ZmZlcl9kYXRhLCAwLCAwKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93X2J1ZmZlcihjYW52YXNfaWQ6IHN0cmluZykge1xyXG4gICAgICAgIC8vIOioreWummJ1ZmZlcueahOWkp+Wwj+WSjGNzcyBzdHlsZeeahOWkp+Wwj+S4gOaoo1xyXG4gICAgICAgIC8vIGh0dHBzOi8vb3BlbmhvbWUuY2MvR29zc2lwL1dlYkdML0NhbnZhcy5odG1sXHJcbiAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhc19pZCkgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgICAgICAgY2FudmFzLnN0eWxlLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuICAgICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuICAgICAgICBjYW52YXMud2lkdGggPSBjYW52YXMuY2xpZW50V2lkdGg7XHJcbiAgICAgICAgY2FudmFzLmhlaWdodCA9IGNhbnZhcy5jbGllbnRIZWlnaHQ7XHJcblxyXG4gICAgICAgIC8vIGNvcHkgYmFja2J1ZmZlciB0byBjYW52YXNcclxuICAgICAgICBsZXQgY29udGV4dF9iaXRtYXBfcmVuZGVyID0gY2FudmFzLmdldENvbnRleHQoXCJiaXRtYXByZW5kZXJlclwiKTtcclxuICAgICAgICBjb250ZXh0X2JpdG1hcF9yZW5kZXIudHJhbnNmZXJGcm9tSW1hZ2VCaXRtYXAodGhpcy5iYWNrYnVmZmVyLnRyYW5zZmVyVG9JbWFnZUJpdG1hcCgpKTtcclxuICAgIH1cclxufSIsImltcG9ydCBEaWZmdXNlIGZyb20gXCIuLi9NYXRlcmFpbHMvRGlmZnVzZVwiO1xyXG5pbXBvcnQgSGl0YWJsZSBmcm9tIFwiLi4vTWF0aC9IaXRhYmxlXCI7XHJcbmltcG9ydCBTaGFkZXIgZnJvbSBcIi4uL01hdGVyYWlscy9TaGFkZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjZW5lTm9kZSB7XHJcblxyXG4gICAgczogU2hhZGVyO1xyXG4gICAgaDogSGl0YWJsZTtcclxuICAgIGNvbnN0cnVjdG9yKHM6IFNoYWRlciwgaDogSGl0YWJsZSkge1xyXG4gICAgICAgIHRoaXMucyA9IHM7XHJcbiAgICAgICAgdGhpcy5oID0gaDtcclxuICAgIH1cclxufSIsImltcG9ydCBTaGFkZXIgZnJvbSBcIi4vU2hhZGVyXCI7XHJcbmltcG9ydCBWZWN0b3IgZnJvbSBcIi4uL01hdGgvVmVjdG9yXCI7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gXCIuLi9NYXRoL0hpdEluZm9cIjtcclxuaW1wb3J0IHsgZXBzaWxvbiwgZ2V0X2hpdF9zb3J0X2xpc3QgfSBmcm9tIFwiLi4vTWF0aC9Ub29sXCJcclxuaW1wb3J0IFJheSBmcm9tIFwiLi4vTWF0aC9SYXlcIjtcclxuaW1wb3J0IFNjZW5lTm9kZSBmcm9tIFwiLi4vT2JqZWN0L1NjZW5lTm9kZVwiO1xyXG5pbXBvcnQgRGlmZnVzZSBmcm9tIFwiLi9EaWZmdXNlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNaXJyb3IgaW1wbGVtZW50cyBTaGFkZXIge1xyXG4gICAgc2hhZGluZyhoaXRfaW5mbzogSGl0SW5mbywgZGlyZWN0aW9uX2xpZ2h0X2RpcjogVmVjdG9yLCBvYmpfbGlzdDogU2NlbmVOb2RlW10sIGRlcHRoOiBudW1iZXIpIHtcclxuXHJcbiAgICAgICAgaWYgKGRlcHRoID4gMjApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ+i2hemBjuS4iumZkCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gRGlmZnVzZS5ncmVlbi5jb2xvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBuID0gaGl0X2luZm8ubm9ybWFsO1xyXG4gICAgICAgIGxldCBpID0gaGl0X2luZm8uaTtcclxuICAgICAgICBsZXQgciA9IFZlY3Rvci5yZWZsZWN0KGksIG4pO1xyXG5cclxuICAgICAgICBsZXQgZnJvbSA9IGhpdF9pbmZvLmhpdF9wb3MuYWRkKHIubXVsdGlwbHkoZXBzaWxvbikpOyAvLyDlgY/np7vkuIDlsI/mrrXot53pm6LvvIzpgb/lhY3lsITkuK3oh6rlt7FcclxuICAgICAgICBsZXQgcmF5ID0gbmV3IFJheShmcm9tLCByKTtcclxuXHJcbiAgICAgICAgbGV0IGhpdF9zb3J0X2xpc3QgPSBnZXRfaGl0X3NvcnRfbGlzdChvYmpfbGlzdCwgcmF5KTtcclxuXHJcbiAgICAgICAgbGV0IGNvbG9yID0gbmV3IFZlY3RvcigxLCAxLCAxKTtcclxuICAgICAgICAvLyDmnInlsITkuK3ll45cclxuICAgICAgICBsZXQgaXNfaGl0ID0gaGl0X3NvcnRfbGlzdC5sZW5ndGggIT0gMDtcclxuICAgICAgICBpZiAoaXNfaGl0KSB7XHJcbiAgICAgICAgICAgIGxldCBoaXRfaW5mb19uZXh0ID0gaGl0X3NvcnRfbGlzdFswXTtcclxuICAgICAgICAgICAgbGV0IGhpdF9jb2xvciA9IGhpdF9pbmZvX25leHQucy5zaGFkaW5nKGhpdF9pbmZvX25leHQsIGRpcmVjdGlvbl9saWdodF9kaXIsIG9ial9saXN0LCArK2RlcHRoKTtcclxuICAgICAgICAgICAgcmV0dXJuIFZlY3Rvci5tdWx0aXBseTMoY29sb3IsIGhpdF9jb2xvci5tdWx0aXBseSgwLjkpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gVmVjdG9yLm11bHRpcGx5Myhjb2xvciwgRGlmZnVzZS5ncmF5LmNvbG9yLm11bHRpcGx5KDAuOSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCBBcHAgZnJvbSAnLi9BcHAnO1xyXG5cclxubmV3IEFwcCgpOyIsImltcG9ydCBWZWN0b3IgZnJvbSAnLi9NYXRoL1ZlY3RvcidcclxuaW1wb3J0IENhbWVyYSBmcm9tICcuL01hdGgvQ2FtZXJhJ1xyXG5pbXBvcnQgUmVjdCBmcm9tICcuL01hdGgvUmVjdCc7XHJcbmltcG9ydCBQbGFuZSBmcm9tICcuL01hdGgvUGxhbmUnO1xyXG5pbXBvcnQgU3BoZXJlIGZyb20gJy4vTWF0aC9TcGhlcmUnO1xyXG5pbXBvcnQgUmVuZGVyVGFyZ2V0IGZyb20gJy4vTWF0aC9SZW5kZXJUYXJnZXQnO1xyXG5pbXBvcnQgU2NlbmVOb2RlIGZyb20gJy4vT2JqZWN0L1NjZW5lTm9kZSc7XHJcbmltcG9ydCBEaWZmdXNlIGZyb20gJy4vTWF0ZXJhaWxzL0RpZmZ1c2UnO1xyXG5pbXBvcnQgTWlycm9yIGZyb20gJy4vTWF0ZXJhaWxzL01pcnJvcic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHAge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcblxyXG4gICAgICAgIGxldCBmbG9vciA9IG5ldyBTY2VuZU5vZGUoRGlmZnVzZS53aGl0ZSwgbmV3IFJlY3QobmV3IFBsYW5lKFZlY3Rvci56ZXJvLCBWZWN0b3IudXApLCAxNiwgMTYpKVxyXG4gICAgICAgIGxldCBvYmpfbGlzdDogU2NlbmVOb2RlW10gPSBbZmxvb3JdO1xyXG4gICAgICAgIG9ial9saXN0LnB1c2gobmV3IFNjZW5lTm9kZShEaWZmdXNlLnllbGxvdywgbmV3IFNwaGVyZShuZXcgVmVjdG9yKDYsIDIsIC04KSwgMSkpKTtcclxuICAgICAgICBvYmpfbGlzdC5wdXNoKG5ldyBTY2VuZU5vZGUoRGlmZnVzZS5ncmVlbiwgbmV3IFNwaGVyZShuZXcgVmVjdG9yKC02LCAyLCAtOCksIDEpKSk7XHJcbiAgICAgICAgb2JqX2xpc3QucHVzaChuZXcgU2NlbmVOb2RlKERpZmZ1c2UuYmx1ZSwgbmV3IFNwaGVyZShuZXcgVmVjdG9yKDAsIDIsIC0xMiksIDEpKSk7XHJcblxyXG4gICAgICAgIG9ial9saXN0LnB1c2gobmV3IFNjZW5lTm9kZShuZXcgTWlycm9yKCksIG5ldyBTcGhlcmUobmV3IFZlY3RvcigwLCA0LCAtNiksIDQpKSk7XHJcbiAgICAgICAgb2JqX2xpc3QucHVzaChuZXcgU2NlbmVOb2RlKG5ldyBNaXJyb3IoKSwgbmV3IFNwaGVyZShuZXcgVmVjdG9yKDEyLCA0LCAtNiksIDQpKSk7XHJcbiAgICAgICAgb2JqX2xpc3QucHVzaChuZXcgU2NlbmVOb2RlKG5ldyBNaXJyb3IoKSwgbmV3IFNwaGVyZShuZXcgVmVjdG9yKDgsIDQsIDIpLCA0KSkpO1xyXG5cclxuICAgICAgICBsZXQgY2FtZXJhID0gbmV3IENhbWVyYShuZXcgVmVjdG9yKDAsIDIwLCAtMjApLCBWZWN0b3IuemVybywgNjApO1xyXG4gICAgICAgIGxldCByZW5kZXJfdGFyZ2V0ID0gbmV3IFJlbmRlclRhcmdldCg4MDAsIDYwMCk7XHJcbiAgICAgICAgY2FtZXJhLnJlbmRlcihyZW5kZXJfdGFyZ2V0LCBvYmpfbGlzdCk7XHJcbiAgICAgICAgcmVuZGVyX3RhcmdldC5zaG93X2J1ZmZlcignY2FudmFzJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=