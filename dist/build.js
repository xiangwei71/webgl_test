!function(t){var n={};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)i.d(e,r,function(n){return t[n]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=0)}([function(t,n,i){"use strict";i.r(n);function e(t,n){return Math.abs(t-n)<.001}function r(t,n){return t.map((function(t){return t.h.hit(n,t.s)})).filter((function(t){return t.is_hit})).sort((function(t,n){return t.t-n.t}))}var o=function(){function t(t,n,i){this.x=0,this.y=0,this.z=0,this.x=t,this.y=n,this.z=i}return t.reflect=function(n,i){var e=-2*t.dot(n,i);return i.multiply(e).add(n)},t.add=function(n,i){return new t(i.x+n.x,i.y+n.y,i.z+n.z)},t.minus=function(n,i){return new t(n.x-i.x,n.y-i.y,n.z-i.z)},t.multiply=function(n,i){return new t(n.x*i,n.y*i,n.z*i)},t.multiply3=function(n,i){return new t(n.x*i.x,n.y*i.y,n.z*i.z)},t.cross=function(n,i){return new t(n.y*i.z-n.z*i.y,-n.x*i.z+n.z*i.x,n.x*i.y-n.y*i.x)},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},t.equal=function(t,n){return e(t.x,n.x)&&e(t.y,n.y)&&e(t.z,n.z)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},t.prototype.add=function(n){return t.add(this,n)},t.prototype.minus=function(n){return t.minus(this,n)},t.prototype.multiply=function(n){return t.multiply(this,n)},t.prototype.negative=function(){return t.multiply(this,-1)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.up=new t(0,1,0),t.zero=new t(0,0,0),t}(),u=function(t,n){this.from=t,this.dir=n},s=function(){function t(t){this.color=t}return t.prototype.shading=function(t,n,i,e){var r,u,s,h=t.normal,a=(r=-o.dot(n,h),u=0,r>(s=1)?s:r<u?u:r);return this.color.multiply(a)},t.yellow=new t(new o(1,1,0)),t.red=new t(new o(1,0,0)),t.green=new t(new o(0,1,0)),t.blue=new t(new o(0,0,1)),t.gray=new t(new o(.5,.5,.5)),t.white=new t(new o(1,1,1)),t}(),h=function(){function t(t,n,i){this.z_axis=o.minus(n,t).normalize();var e=o.up;this.x_axis=o.cross(e,this.z_axis).normalize(),this.y_axis=o.cross(this.z_axis,this.x_axis),this.eye=t,this.fov_degree=i}return t.prototype.create_ray_dir=function(t,n,i){var e,r=(e=.5*this.fov_degree,Math.PI*e/180),o=Math.tan(r),u=o*i;return this.z_axis.add(this.x_axis.multiply(t*u)).add(this.y_axis.multiply(n*o))},t.prototype.render=function(t,n){var i=this,e=new o(1,-1,0).normalize(),h=.5/t.h,a=[{x:0,y:0},{x:h,y:h},{x:-h,y:h},{x:-h,y:-h},{x:h,y:-h}];t.render_pixel((function(t,h,l){var f=i.create_ray_dir(t,h,l),p=a.map((function(t){var n=f.add(i.x_axis.multiply(t.x)).add(i.y_axis.multiply(t.y));return new u(i.eye,n.normalize())})).map((function(t){var i=r(n,t);if(0!=i.length){var o=i[0];return o.s.shading(o,e,n,1)}return s.gray.color})),c=a.length;return p.reduce((function(t,n){return t.add(n)}),o.zero).multiply(1/c)}))},t}(),a=function(){function t(t,n,i){this.plane=t,this.w=n,this.h=i}return t.prototype.hit=function(t,n){var i=this.plane.hit(t,n);if(i.is_hit){var e=i.hit_pos,r=e.minus(this.plane.C),u=o.equal(this.plane.N,o.up)?new o(1,0,0):o.up,s=o.cross(u,this.plane.N).normalize(),h=o.cross(s,this.plane.N),a=o.dot(r,s),l=o.dot(r,h);return{is_hit:Math.abs(a)<this.w&&Math.abs(l)<this.h,hit_pos:e,i:t.dir,t:i.t,normal:this.plane.N,s:n}}return{is_hit:!1}},t}(),l=function(){function t(t,n){this.C=t,this.N=n}return t.prototype.is_positive=function(t){var n=o.minus(t,this.C);return o.dot(n,this.N)>0},t.prototype.hit=function(t,n){var i=t.from,r=t.dir,u=o.dot(r,this.N),s=o.dot(o.minus(this.C,i),this.N);if(e(u,0))return{is_hit:!1,hit_pos:null,t:-1};var h=s/u;return{is_hit:h>0,hit_pos:i.add(r.multiply(h)),i:r,t:h,normal:this.N,s:n}},t}(),f=function(){function t(t,n){this.C=t,this.R=n}return t.prototype.hit=function(t,n){var i=t.dir,r=t.from,u=o.dot(i,i),s=2*(o.dot(i,r)-o.dot(i,this.C)),h=s*s-4*u*(o.dot(r,r)-2*o.dot(r,this.C)+o.dot(this.C,this.C)-this.R*this.R);if(e(h,0)){if((c=-s/(2*u))<0)return{is_hit:!1};var a=(p=r.add(i.multiply(c))).minus(this.C).normalize();return{is_hit:!0,hit_pos:p,i:i,t:c,normal:a,s:n}}if(h>0){var l=Math.sqrt(h),f=[(-s-l)/(2*u),(-s+l)/(2*u)].filter((function(t){return t>0}));if(0==f.length)return{is_hit:!1};var p,c=f[0];a=(p=r.add(i.multiply(c))).minus(this.C).normalize();return{is_hit:!0,hit_pos:p,i:i,t:c,normal:a,s:n}}return{is_hit:!1}},t}(),p=function(){function t(t,n){void 0===t&&(t=320),void 0===n&&(n=240),this.w=320,this.h=240,this.backbuffer=null,this.w=t,this.h=n,this.backbuffer=new OffscreenCanvas(this.w,this.h)}return t.prototype.render_pixel=function(t){for(var n=this.backbuffer.getContext("2d"),i=n.getImageData(0,0,this.w,this.h),e=i.data,r=this.w/this.h,o=0;o<this.h;++o)for(var u=0;u<this.w;++u){var s=4*(u+o*this.w),h=u/this.w,a=o/this.h,l=t(2*h-1,2*(a=1-a)-1,r),f=l.x,p=l.y,c=l.z;f=Math.pow(f,1/2.1),p=Math.pow(p,1/2.1),c=Math.pow(c,1/2.1),e[s++]=Math.round(255*f),e[s++]=Math.round(255*p),e[s++]=Math.round(255*c),e[s]=255}n.putImageData(i,0,0)},t.prototype.show_buffer=function(t){var n=document.getElementById(t);n.style.width=this.w+"px",n.style.height=this.h+"px",n.width=n.clientWidth,n.height=n.clientHeight,n.getContext("bitmaprenderer").transferFromImageBitmap(this.backbuffer.transferToImageBitmap())},t}(),c=function(t,n){this.s=t,this.h=n},y=function(){function t(){}return t.prototype.shading=function(t,n,i,e){if(e>20)return console.log("超過上限"),s.green.color;var h=t.normal,a=t.i,l=o.reflect(a,h),f=t.hit_pos.add(l.multiply(.001)),p=r(i,new u(f,l)),c=new o(1,1,1);if(0!=p.length){var y=p[0],d=y.s.shading(y,n,i,++e);return o.multiply3(c,d.multiply(.9))}return o.multiply3(c,s.gray.color.multiply(.9))},t}();new function(){var t=[new c(s.white,new a(new l(o.zero,o.up),16,16))];t.push(new c(s.yellow,new f(new o(6,2,-8),2))),t.push(new c(s.green,new f(new o(-6,2,-8),2))),t.push(new c(s.blue,new f(new o(0,2,-12),2))),t.push(new c(new y,new f(new o(0,4,-6),4))),t.push(new c(new y,new f(new o(12,4,-6),4))),t.push(new c(new y,new f(new o(8,4,2),4)));var n=new h(new o(0,20,-20),o.zero,60),i=new p(800,600);n.render(i,t),i.show_buffer("canvas")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvVG9vbC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9WZWN0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmF5LnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRlcmFpbHMvRGlmZnVzZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9DYW1lcmEudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmVjdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9QbGFuZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9TcGhlcmUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvUmVuZGVyVGFyZ2V0LnRzIiwid2VicGFjazovLy8uL3NyYy9PYmplY3QvU2NlbmVOb2RlLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRlcmFpbHMvTWlycm9yLnRzIiwid2VicGFjazovLy8uL3NyYy9tYWluLnRzIiwid2VicGFjazovLy8uL3NyYy9BcHAudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJudW1iZXJfZXF1YWwiLCJhIiwiYiIsIk1hdGgiLCJhYnMiLCJnZXRfaGl0X3NvcnRfbGlzdCIsIm9ial9saXN0IiwicmF5IiwibWFwIiwib2JqIiwiaCIsImhpdCIsImZpbHRlciIsImluZm8iLCJpc19oaXQiLCJzb3J0IiwicHgiLCJweSIsInB6IiwieCIsInkiLCJ6IiwidGhpcyIsInJlZmxlY3QiLCJJIiwiTiIsIkwiLCJWZWN0b3IiLCJkb3QiLCJtdWx0aXBseSIsImFkZCIsIkEiLCJCIiwibWludXMiLCJtdWx0aXBseTMiLCJjcm9zcyIsImVxdWFsIiwibGVuZ3RoIiwic3FydCIsIm5vcm1hbGl6ZSIsInRlbXAiLCJuZWdhdGl2ZSIsImNsb25lIiwidXAiLCJ6ZXJvIiwiZnJvbSIsImRpciIsImNvbG9yIiwic2hhZGluZyIsImhpdF9pbmZvIiwiZGlyZWN0aW9uX2xpZ2h0X2RpciIsImRlcHRoIiwibm9ybWFsIiwic3RyZW5ndGgiLCJ5ZWxsb3ciLCJEaWZmdXNlIiwicmVkIiwiZ3JlZW4iLCJibHVlIiwiZ3JheSIsIndoaXRlIiwiZXllIiwibG9va19hdCIsImZvdl9kZWdyZWUiLCJ6X2F4aXMiLCJoZWxwX3YiLCJ4X2F4aXMiLCJ5X2F4aXMiLCJjcmVhdGVfcmF5X2RpciIsInhfd2VpZ2h0IiwieV93ZWlnaHQiLCJyYXRpbyIsImhhbGZfZm92X3JhZCIsIlBJIiwidGFuX2giLCJ0YW4iLCJ0YW5fdyIsInJlbmRlciIsInJlbmRlcl90YXJnZXQiLCJoYWxmX3BpeGVsX29mZnNldCIsIm11bHRpc2FtcGxlX2RpZmYiLCJyZW5kZXJfcGl4ZWwiLCJyYXlfZGlyIiwiY29sb3JzIiwiZGlmZiIsImhpdF9zb3J0X2xpc3QiLCJjb3VudCIsInJlZHVjZSIsImFjY3VtdWxhdG9yIiwiY3VycmVudCIsInBsYW5lIiwidyIsInJlc3VsdCIsImhpdF9wb3MiLCJDIiwid19heGlzIiwiaF9heGlzIiwid192YWx1ZSIsImhfdmFsdWUiLCJwb2ludCIsImlzX3Bvc2l0aXZlIiwidGVzdF9wIiwiUiIsIkQiLCJGIiwiayIsInNxcnRfayIsInRfbGlzdCIsImJhY2tidWZmZXIiLCJPZmZzY3JlZW5DYW52YXMiLCJmdW5jIiwiY29udGV4dF8yZCIsImdldENvbnRleHQiLCJiYWNrYnVmZmVyX2RhdGEiLCJnZXRJbWFnZURhdGEiLCJiYWNrYnVmZmVyX2RhdGFfYXJyYXkiLCJkYXRhIiwiaW5kZXgiLCJYIiwiWSIsImciLCJwb3ciLCJyb3VuZCIsInB1dEltYWdlRGF0YSIsInNob3dfYnVmZmVyIiwiY2FudmFzX2lkIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsInRyYW5zZmVyRnJvbUltYWdlQml0bWFwIiwidHJhbnNmZXJUb0ltYWdlQml0bWFwIiwiY29uc29sZSIsImxvZyIsImhpdF9pbmZvX25leHQiLCJoaXRfY29sb3IiLCJwdXNoIiwiY2FtZXJhIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8s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RGhCLElBQUksRUFBVSxFQUFRc0QsTUFBTyxJQUFJLEVBQUssSUFBSSxFQUFNLEVBQU9oQixLQUFNLEVBQU9ELElBQUssR0FBSSxNQUV6RnJDLEVBQVNzSSxLQUFLLElBQUksRUFBVSxFQUFRdEYsT0FBUSxJQUFJLEVBQU8sSUFBSSxFQUFPLEVBQUcsR0FBSSxHQUFJLEtBQzdFaEQsRUFBU3NJLEtBQUssSUFBSSxFQUFVLEVBQVFuRixNQUFPLElBQUksRUFBTyxJQUFJLEdBQVEsRUFBRyxHQUFJLEdBQUksS0FDN0VuRCxFQUFTc0ksS0FBSyxJQUFJLEVBQVUsRUFBUWxGLEtBQU0sSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLEdBQUksSUFBSyxLQUU1RXBELEVBQVNzSSxLQUFLLElBQUksRUFBVSxJQUFJLEVBQVUsSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLEdBQUksR0FBSSxLQUMzRXRJLEVBQVNzSSxLQUFLLElBQUksRUFBVSxJQUFJLEVBQVUsSUFBSSxFQUFPLElBQUksRUFBTyxHQUFJLEdBQUksR0FBSSxLQUM1RXRJLEVBQVNzSSxLQUFLLElBQUksRUFBVSxJQUFJLEVBQVUsSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLEVBQUcsR0FBSSxLQUUxRSxJQUFJQyxFQUFTLElBQUksRUFBTyxJQUFJLEVBQU8sRUFBRyxJQUFLLElBQUssRUFBT2pHLEtBQU0sSUFDekRrQyxFQUFnQixJQUFJLEVBQWEsSUFBSyxLQUMxQytELEVBQU9oRSxPQUFPQyxFQUFleEUsR0FDN0J3RSxFQUFjOEMsWUFBWSIsImZpbGUiOiJidWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCBTY2VuZU5vZGUgZnJvbSBcIi4uL09iamVjdC9TY2VuZU5vZGVcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IEhpdEluZm8gZnJvbSBcIi4vSGl0SW5mb1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlZ3JlZV90b19SYWQoZDogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTWF0aC5QSSAqIGQgLyAxODA7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZXBzaWxvbjogbnVtYmVyID0gMC4wMDE7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbnVtYmVyX2VxdWFsKGE6IG51bWJlciwgYjogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTWF0aC5hYnMoYSAtIGIpIDwgZXBzaWxvbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFxyXG4gKiBAcGFyYW0geCBpbnB1dFxyXG4gKiBAcGFyYW0gYSBtaW4gXHJcbiAqIEBwYXJhbSBiIG1heFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKHg6IG51bWJlciwgYTogbnVtYmVyLCBiOiBudW1iZXIpIHtcclxuICAgIGlmICh4ID4gYilcclxuICAgICAgICByZXR1cm4gYjtcclxuICAgIGVsc2UgaWYgKHggPCBhKVxyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIHJldHVybiB4O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0X2hpdF9zb3J0X2xpc3Qob2JqX2xpc3Q6IFNjZW5lTm9kZVtdLCByYXk6IFJheSkge1xyXG4gICAgbGV0IGhpdF9zb3J0X2xpc3QgPSBvYmpfbGlzdC5tYXAob2JqID0+IG9iai5oLmhpdChyYXksIG9iai5zKSlcclxuICAgICAgICAuZmlsdGVyKGluZm8gPT4gaW5mby5pc19oaXQpXHJcbiAgICAgICAgLnNvcnQoKGE6IEhpdEluZm8sIGI6IEhpdEluZm8pID0+IGEudCAtIGIudCk7XHJcblxyXG4gICAgcmV0dXJuIGhpdF9zb3J0X2xpc3Q7XHJcbn0iLCJpbXBvcnQgeyBudW1iZXJfZXF1YWwgfSBmcm9tICcuL1Rvb2wnXHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVjdG9yIHtcclxuXHJcbiAgICBzdGF0aWMgdXAgPSBuZXcgVmVjdG9yKDAsIDEsIDApO1xyXG4gICAgc3RhdGljIHplcm8gPSBuZXcgVmVjdG9yKDAsIDAsIDApO1xyXG5cclxuICAgIHN0YXRpYyByZWZsZWN0KEk6IFZlY3RvciwgTjogVmVjdG9yKSB7XHJcbiAgICAgICAgbGV0IEwgPSAtMiAqIFZlY3Rvci5kb3QoSSwgTilcclxuICAgICAgICByZXR1cm4gTi5tdWx0aXBseShMKS5hZGQoSSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGFkZChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHZhciB0ZW1wID0gbmV3IFZlY3RvcihCLnggKyBBLngsIEIueSArIEEueSwgQi56ICsgQS56KTtcclxuICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBtaW51cyhBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHZhciB0ZW1wID0gbmV3IFZlY3RvcihBLnggLSBCLngsIEEueSAtIEIueSwgQS56IC0gQi56KTtcclxuICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBtdWx0aXBseShBOiBWZWN0b3IsIHM6IG51bWJlcikge1xyXG4gICAgICAgIHZhciB0ZW1wID0gbmV3IFZlY3RvcihBLnggKiBzLCBBLnkgKiBzLCBBLnogKiBzKTtcclxuICAgICAgICByZXR1cm4gdGVtcFxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBtdWx0aXBseTMoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcihBLnggKiBCLngsIEEueSAqIEIueSwgQS56ICogQi56KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgY3Jvc3MoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICB2YXIgdGVtcCA9IG5ldyBWZWN0b3IoQS55ICogQi56IC0gQS56ICogQi55LCAtQS54ICogQi56ICsgQS56ICogQi54LCBBLnggKiBCLnkgLSBBLnkgKiBCLngpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBkb3QoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gQS54ICogQi54ICsgQS55ICogQi55ICsgQS56ICogQi56O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBlcXVhbChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBudW1iZXJfZXF1YWwoQS54LCBCLngpICYmIG51bWJlcl9lcXVhbChBLnksIEIueSkgJiYgbnVtYmVyX2VxdWFsKEEueiwgQi56KTtcclxuICAgIH1cclxuXHJcbiAgICB4OiBudW1iZXIgPSAwO1xyXG4gICAgeTogbnVtYmVyID0gMDtcclxuICAgIHo6IG51bWJlciA9IDA7XHJcbiAgICBjb25zdHJ1Y3RvcihweDogbnVtYmVyLCBweTogbnVtYmVyLCBwejogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy54ID0gcHg7XHJcbiAgICAgICAgdGhpcy55ID0gcHk7XHJcbiAgICAgICAgdGhpcy56ID0gcHo7XHJcbiAgICB9XHJcblxyXG4gICAgbGVuZ3RoKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56KTtcclxuICAgIH1cclxuXHJcbiAgICBub3JtYWxpemUoKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSB0aGlzLmxlbmd0aCgpO1xyXG4gICAgICAgIHRoaXMueCA9IHRoaXMueCAvIHRlbXA7XHJcbiAgICAgICAgdGhpcy55ID0gdGhpcy55IC8gdGVtcDtcclxuICAgICAgICB0aGlzLnogPSB0aGlzLnogLyB0ZW1wO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZChBOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLmFkZCh0aGlzLCBBKTtcclxuICAgIH1cclxuXHJcbiAgICBtaW51cyhBOiBWZWN0b3IpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLm1pbnVzKHRoaXMsIEEpO1xyXG4gICAgfVxyXG5cclxuICAgIG11bHRpcGx5KHM6IG51bWJlcikge1xyXG4gICAgICAgIHJldHVybiBWZWN0b3IubXVsdGlwbHkodGhpcywgcyk7XHJcbiAgICB9XHJcblxyXG4gICAgbmVnYXRpdmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5tdWx0aXBseSh0aGlzLCAtMSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvbmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IodGhpcy54LCB0aGlzLnksIHRoaXMueik7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjb3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSYXkge1xyXG4gICAgZnJvbTogVmVjb3I7XHJcbiAgICBkaXI6IFZlY29yO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGZyb206IFZlY29yLCBkaXI6IFZlY29yKSB7XHJcbiAgICAgICAgdGhpcy5mcm9tID0gZnJvbTtcclxuICAgICAgICB0aGlzLmRpciA9IGRpcjtcclxuICAgIH1cclxufTsiLCJpbXBvcnQgVmVjdG9yIGZyb20gXCIuLi9NYXRoL1ZlY3RvclwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi4vTWF0aC9IaXRJbmZvXCI7XHJcbmltcG9ydCB7IGNsYW1wIH0gZnJvbSBcIi4uL01hdGgvVG9vbFwiO1xyXG5pbXBvcnQgU2hhZGVyIGZyb20gXCIuL1NoYWRlclwiO1xyXG5pbXBvcnQgU2NlbmVOb2RlIGZyb20gXCIuLi9PYmplY3QvU2NlbmVOb2RlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEaWZmdXNlIGltcGxlbWVudHMgU2hhZGVyIHtcclxuICAgIHN0YXRpYyB5ZWxsb3cgPSBuZXcgRGlmZnVzZShuZXcgVmVjdG9yKDEsIDEsIDApKTtcclxuICAgIHN0YXRpYyByZWQgPSBuZXcgRGlmZnVzZShuZXcgVmVjdG9yKDEsIDAsIDApKTtcclxuICAgIHN0YXRpYyBncmVlbiA9IG5ldyBEaWZmdXNlKG5ldyBWZWN0b3IoMCwgMSwgMCkpO1xyXG4gICAgc3RhdGljIGJsdWUgPSBuZXcgRGlmZnVzZShuZXcgVmVjdG9yKDAsIDAsIDEpKTtcclxuICAgIHN0YXRpYyBncmF5ID0gbmV3IERpZmZ1c2UobmV3IFZlY3RvcigwLjUsIDAuNSwgMC41KSk7XHJcbiAgICBzdGF0aWMgd2hpdGUgPSBuZXcgRGlmZnVzZShuZXcgVmVjdG9yKDEsIDEsIDEpKTtcclxuXHJcbiAgICBjb2xvcjogVmVjdG9yO1xyXG4gICAgY29uc3RydWN0b3IoY29sb3I6IFZlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcclxuICAgIH1cclxuXHJcbiAgICBzaGFkaW5nKGhpdF9pbmZvOiBIaXRJbmZvLCBkaXJlY3Rpb25fbGlnaHRfZGlyOiBWZWN0b3IsIG9ial9saXN0OiBTY2VuZU5vZGVbXSwgZGVwdGg6IG51bWJlcikge1xyXG4gICAgICAgIGxldCBuID0gaGl0X2luZm8ubm9ybWFsO1xyXG4gICAgICAgIGxldCBzdHJlbmd0aCA9IGNsYW1wKC1WZWN0b3IuZG90KGRpcmVjdGlvbl9saWdodF9kaXIsIG4pLCAwLCAxKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3IubXVsdGlwbHkoc3RyZW5ndGgpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IHsgZGVncmVlX3RvX1JhZCwgZ2V0X2hpdF9zb3J0X2xpc3QgfSBmcm9tIFwiLi9Ub29sXCJcclxuaW1wb3J0IFJlbmRlclRhcmdldCBmcm9tIFwiLi9SZW5kZXJUYXJnZXRcIjtcclxuaW1wb3J0IEhpdEluZm8gZnJvbSBcIi4vSGl0SW5mb1wiO1xyXG5pbXBvcnQgU2NlbmVOb2RlIGZyb20gXCIuLi9PYmplY3QvU2NlbmVOb2RlXCI7XHJcbmltcG9ydCBEaWZmdXNlIGZyb20gXCIuLi9NYXRlcmFpbHMvRGlmZnVzZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FtZXJhIHtcclxuICAgIGV5ZTogVmVjdG9yO1xyXG5cclxuICAgIHhfYXhpczogVmVjdG9yO1xyXG4gICAgeV9heGlzOiBWZWN0b3I7XHJcbiAgICB6X2F4aXM6IFZlY3RvcjtcclxuXHJcbiAgICBmb3ZfZGVncmVlOiBudW1iZXI7XHJcbiAgICBjb25zdHJ1Y3RvcihleWU6IFZlY3RvciwgbG9va19hdDogVmVjdG9yLCBmb3ZfZGVncmVlOiBudW1iZXIpIHtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIDPou7hcclxuICAgICAgICB0aGlzLnpfYXhpcyA9IFZlY3Rvci5taW51cyhsb29rX2F0LCBleWUpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgaGVscF92ID0gVmVjdG9yLnVwO1xyXG4gICAgICAgIHRoaXMueF9heGlzID0gVmVjdG9yLmNyb3NzKGhlbHBfdiwgdGhpcy56X2F4aXMpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgIHRoaXMueV9heGlzID0gVmVjdG9yLmNyb3NzKHRoaXMuel9heGlzLCB0aGlzLnhfYXhpcyk7XHJcblxyXG4gICAgICAgIC8vIGNhbWVyYSDljp/pu55cclxuICAgICAgICB0aGlzLmV5ZSA9IGV5ZTtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIGZvdlxyXG4gICAgICAgIHRoaXMuZm92X2RlZ3JlZSA9IGZvdl9kZWdyZWU7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlX3JheV9kaXIoeF93ZWlnaHQ6IG51bWJlciwgeV93ZWlnaHQ6IG51bWJlciwgcmF0aW86IG51bWJlcikge1xyXG4gICAgICAgIGxldCBoYWxmX2Zvdl9yYWQgPSBkZWdyZWVfdG9fUmFkKDAuNSAqIHRoaXMuZm92X2RlZ3JlZSk7XHJcbiAgICAgICAgbGV0IHRhbl9oID0gTWF0aC50YW4oaGFsZl9mb3ZfcmFkKTtcclxuICAgICAgICBsZXQgdGFuX3cgPSB0YW5faCAqIHJhdGlvO1xyXG5cclxuICAgICAgICBsZXQgZGlyID0gdGhpcy56X2F4aXNcclxuICAgICAgICAgICAgLmFkZCh0aGlzLnhfYXhpcy5tdWx0aXBseSh4X3dlaWdodCAqIHRhbl93KSlcclxuICAgICAgICAgICAgLmFkZCh0aGlzLnlfYXhpcy5tdWx0aXBseSh5X3dlaWdodCAqIHRhbl9oKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBkaXI7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKHJlbmRlcl90YXJnZXQ6IFJlbmRlclRhcmdldCwgb2JqX2xpc3Q6IFNjZW5lTm9kZVtdKSB7XHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbl9saWdodF9kaXIgPSBuZXcgVmVjdG9yKDEsIC0xLCAwKS5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IGhhbGZfcGl4ZWxfb2Zmc2V0ID0gMC41IC8gcmVuZGVyX3RhcmdldC5oO1xyXG4gICAgICAgIGxldCBtdWx0aXNhbXBsZV9kaWZmID0gW1xyXG4gICAgICAgICAgICB7IHg6IDAsIHk6IDAgfSxcclxuICAgICAgICAgICAgeyB4OiBoYWxmX3BpeGVsX29mZnNldCwgeTogaGFsZl9waXhlbF9vZmZzZXQgfSxcclxuICAgICAgICAgICAgeyB4OiAtaGFsZl9waXhlbF9vZmZzZXQsIHk6IGhhbGZfcGl4ZWxfb2Zmc2V0IH0sXHJcbiAgICAgICAgICAgIHsgeDogLWhhbGZfcGl4ZWxfb2Zmc2V0LCB5OiAtaGFsZl9waXhlbF9vZmZzZXQgfSxcclxuICAgICAgICAgICAgeyB4OiBoYWxmX3BpeGVsX29mZnNldCwgeTogLWhhbGZfcGl4ZWxfb2Zmc2V0IH0sXHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgcmVuZGVyX3RhcmdldC5yZW5kZXJfcGl4ZWwoKHhfd2VpZ2h0OiBudW1iZXIsIHlfd2VpZ2h0OiBudW1iZXIsIHJhdGlvOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgbGV0IHJheV9kaXIgPSB0aGlzLmNyZWF0ZV9yYXlfZGlyKHhfd2VpZ2h0LCB5X3dlaWdodCwgcmF0aW8pO1xyXG5cclxuICAgICAgICAgICAgLy8g55Si55Sf5aSa5qKdcmF5XHJcbiAgICAgICAgICAgIGxldCByYXlzID0gbXVsdGlzYW1wbGVfZGlmZi5tYXAoZGlmZiA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyDlsI1yYXlfZHJp5L2c5YGP56e7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGlyID0gcmF5X2Rpci5hZGQodGhpcy54X2F4aXMubXVsdGlwbHkoZGlmZi54KSkuYWRkKHRoaXMueV9heGlzLm11bHRpcGx5KGRpZmYueSkpXHJcblxyXG4gICAgICAgICAgICAgICAgLy8g6ZuW54S25ZKM55CD44CB5bmz6Z2i55qEaGl06KiI566X5LiN6ZyA6KaBZGly5L2cbm9ybWFsaXpl77yM5L2G54K65LqG5pa55L6/5Y+N5bCE55qE6KiI566X6YKE5piv5L2cbm9ybWFsaXplXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJheSh0aGlzLmV5ZSwgZGlyLm5vcm1hbGl6ZSgpKVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOavj+WAi3JheemDveeul2NvbG9yXHJcbiAgICAgICAgICAgIGxldCBjb2xvcnMgPSByYXlzLm1hcChyYXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGhpdF9zb3J0X2xpc3QgPSBnZXRfaGl0X3NvcnRfbGlzdChvYmpfbGlzdCwgcmF5KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyDmnInlsITkuK3ll45cclxuICAgICAgICAgICAgICAgIGxldCBpc19oaXQgPSBoaXRfc29ydF9saXN0Lmxlbmd0aCAhPSAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzX2hpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBoaXRfaW5mbyA9IGhpdF9zb3J0X2xpc3RbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhpdF9pbmZvLnMuc2hhZGluZyhoaXRfaW5mbywgZGlyZWN0aW9uX2xpZ2h0X2Rpciwgb2JqX2xpc3QsIDEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRGlmZnVzZS5ncmF5LmNvbG9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOWPluW5s+Wdh+WwseaciUFudGlhbGlhc2luZ+aViOaenFxyXG4gICAgICAgICAgICBsZXQgY291bnQgPSBtdWx0aXNhbXBsZV9kaWZmLmxlbmd0aDtcclxuICAgICAgICAgICAgbGV0IGZpbmFsX2NvbG9yID0gY29sb3JzLnJlZHVjZSgoYWNjdW11bGF0b3I6IFZlY3RvciwgY3VycmVudDogVmVjdG9yKSA9PiBhY2N1bXVsYXRvci5hZGQoY3VycmVudCksIFZlY3Rvci56ZXJvKS5tdWx0aXBseSgxIC8gY291bnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmluYWxfY29sb3I7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufSIsImltcG9ydCBQbGFuZSBmcm9tIFwiLi9QbGFuZVwiO1xyXG5pbXBvcnQgUmF5IGZyb20gXCIuL1JheVwiO1xyXG5pbXBvcnQgVmVjdG9yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi9IaXRJbmZvXCI7XHJcbmltcG9ydCBIaXRhYmxlIGZyb20gXCIuL0hpdGFibGVcIjtcclxuaW1wb3J0IFNoYWRlciBmcm9tIFwiLi4vTWF0ZXJhaWxzL1NoYWRlclwiO1xyXG5cclxuLy8g5bCP5pa55aGKXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlY3QgaW1wbGVtZW50cyBIaXRhYmxlIHtcclxuICAgIHBsYW5lOiBQbGFuZTtcclxuICAgIHc6IG51bWJlcjtcclxuICAgIGg6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwbGFuZTogUGxhbmUsIHc6IG51bWJlciwgaDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5wbGFuZSA9IHBsYW5lO1xyXG4gICAgICAgIHRoaXMudyA9IHc7XHJcbiAgICAgICAgdGhpcy5oID0gaDtcclxuICAgIH1cclxuXHJcbiAgICBoaXQocmF5OiBSYXksIHM6IFNoYWRlcik6IEhpdEluZm8ge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSB0aGlzLnBsYW5lLmhpdChyYXksIHMpO1xyXG4gICAgICAgIGlmIChyZXN1bHQuaXNfaGl0KSB7XHJcbiAgICAgICAgICAgIGxldCBoaXRfcG9zID0gcmVzdWx0LmhpdF9wb3M7XHJcbiAgICAgICAgICAgIGxldCBkaWZmID0gaGl0X3Bvcy5taW51cyh0aGlzLnBsYW5lLkMpO1xyXG5cclxuICAgICAgICAgICAgLy8g6YG/6ZaL55u4562J55qE5oOF5rOBXHJcbiAgICAgICAgICAgIGxldCBoZWxwX3YgPSBWZWN0b3IuZXF1YWwodGhpcy5wbGFuZS5OLCBWZWN0b3IudXApID8gbmV3IFZlY3RvcigxLCAwLCAwKSA6IFZlY3Rvci51cDtcclxuXHJcbiAgICAgICAgICAgIGxldCB3X2F4aXMgPSBWZWN0b3IuY3Jvc3MoaGVscF92LCB0aGlzLnBsYW5lLk4pLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICBsZXQgaF9heGlzID0gVmVjdG9yLmNyb3NzKHdfYXhpcywgdGhpcy5wbGFuZS5OKTtcclxuICAgICAgICAgICAgbGV0IHdfdmFsdWUgPSBWZWN0b3IuZG90KGRpZmYsIHdfYXhpcyk7XHJcbiAgICAgICAgICAgIGxldCBoX3ZhbHVlID0gVmVjdG9yLmRvdChkaWZmLCBoX2F4aXMpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGlzX2hpdCA9IE1hdGguYWJzKHdfdmFsdWUpIDwgdGhpcy53ICYmIE1hdGguYWJzKGhfdmFsdWUpIDwgdGhpcy5oO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaXNfaGl0LFxyXG4gICAgICAgICAgICAgICAgaGl0X3BvcyxcclxuICAgICAgICAgICAgICAgIGk6IHJheS5kaXIsXHJcbiAgICAgICAgICAgICAgICB0OiByZXN1bHQudCxcclxuICAgICAgICAgICAgICAgIG5vcm1hbDogdGhpcy5wbGFuZS5OLFxyXG4gICAgICAgICAgICAgICAgc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gJy4vVmVjdG9yJztcclxuaW1wb3J0IFJheSBmcm9tICcuL1JheSc7XHJcbmltcG9ydCB7IG51bWJlcl9lcXVhbCB9IGZyb20gJy4vVG9vbCc7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gJy4vSGl0SW5mbyc7XHJcbmltcG9ydCBIaXRhYmxlIGZyb20gJy4vSGl0YWJsZSc7XHJcbmltcG9ydCBTaGFkZXIgZnJvbSAnLi4vTWF0ZXJhaWxzL1NoYWRlcic7XHJcblxyXG4vLyDlubPpnaJcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxhbmUgaW1wbGVtZW50cyBIaXRhYmxlIHtcclxuXHJcbiAgICBDOiBWZWN0b3I7XHJcbiAgICBOOiBWZWN0b3I7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb2ludDogVmVjdG9yLCBub3JtYWw6IFZlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuQyA9IHBvaW50O1xyXG4gICAgICAgIHRoaXMuTiA9IG5vcm1hbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmuKzoqaZ0ZXNwX3DlkozmlrnlkJHph4/mmK/kuI3mmK/lnKjlkIzkuIDpgopcclxuICAgIGlzX3Bvc2l0aXZlKHRlc3RfcDogVmVjdG9yKSB7XHJcbiAgICAgICAgbGV0IGRpZmYgPSBWZWN0b3IubWludXModGVzdF9wLCB0aGlzLkMpO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IFZlY3Rvci5kb3QoZGlmZiwgdGhpcy5OKTtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPiAwO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChyYXk6IFJheSwgczogU2hhZGVyKTogSGl0SW5mbyB7XHJcbiAgICAgICAgLy8gcmF5IGhpdCBwbGFuZSBcclxuICAgICAgICBsZXQgZnJvbSA9IHJheS5mcm9tO1xyXG4gICAgICAgIGxldCBkaXIgPSByYXkuZGlyO1xyXG5cclxuICAgICAgICAvLyAoRi1DKeOAgk4gKyB0IChE44CCTikgPSAwXHJcbiAgICAgICAgLy8gdCAgPSAoQy1GKeOAgk4gLyAoROOAgk4pXHJcbiAgICAgICAgLy8gdCAgPSAoQSAvIChCKVxyXG4gICAgICAgIGxldCBCID0gVmVjdG9yLmRvdChkaXIsIHRoaXMuTik7XHJcbiAgICAgICAgbGV0IEEgPSBWZWN0b3IuZG90KFZlY3Rvci5taW51cyh0aGlzLkMsIGZyb20pLCB0aGlzLk4pO1xyXG5cclxuICAgICAgICAvLyBhdm9pZCBkaXZpZGUgYnkgMFxyXG4gICAgICAgIGlmIChudW1iZXJfZXF1YWwoQiwgMCkpXHJcbiAgICAgICAgICAgIHJldHVybiB7IGlzX2hpdDogZmFsc2UsIGhpdF9wb3M6IG51bGwsIHQ6IC0xIH07XHJcblxyXG4gICAgICAgIGxldCB0ID0gQSAvIEI7XHJcbiAgICAgICAgbGV0IGlzX2hpdCA9IHQgPiAwLjA7XHJcbiAgICAgICAgbGV0IGhpdF9wb3MgPSBmcm9tLmFkZChkaXIubXVsdGlwbHkodCkpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzX2hpdCxcclxuICAgICAgICAgICAgaGl0X3BvcyxcclxuICAgICAgICAgICAgaTogZGlyLFxyXG4gICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICBub3JtYWw6IHRoaXMuTixcclxuICAgICAgICAgICAgc1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCBWZWN0b3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcbmltcG9ydCBSYXkgZnJvbSBcIi4vUmF5XCI7XHJcbmltcG9ydCB7IG51bWJlcl9lcXVhbCB9IGZyb20gJy4vVG9vbCc7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gXCIuL0hpdEluZm9cIjtcclxuaW1wb3J0IEhpdGFibGUgZnJvbSBcIi4vSGl0YWJsZVwiO1xyXG5pbXBvcnQgU2hhZGVyIGZyb20gXCIuLi9NYXRlcmFpbHMvU2hhZGVyXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTcGhlcmUgaW1wbGVtZW50cyBIaXRhYmxlIHtcclxuXHJcbiAgICBDOiBWZWN0b3I7IC8vIOeQg+S4reW/g1xyXG4gICAgUjogbnVtYmVyOyAvLyDnkIPljYrlvpFcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihDOiBWZWN0b3IsIFI6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuQyA9IEM7XHJcbiAgICAgICAgdGhpcy5SID0gUjtcclxuICAgIH1cclxuXHJcbiAgICBoaXQocmF5OiBSYXksIHM6IFNoYWRlcik6IEhpdEluZm8ge1xyXG4gICAgICAgIC8vIOinozLmrKHmlrnnqIvlvI9cclxuICAgICAgICAvLyAoWC1DKeOAgihYLUMpID0gUipSXHJcbiAgICAgICAgLy8gWD1GK3QqRFxyXG4gICAgICAgIC8vIHQ9WygtYi1zcXJ0X2spLzJhLCgtYitzcXJ0X2spLzJhXVxyXG4gICAgICAgIGxldCBEID0gcmF5LmRpcjtcclxuICAgICAgICBsZXQgRiA9IHJheS5mcm9tO1xyXG4gICAgICAgIGxldCBhID0gVmVjdG9yLmRvdChELCBEKTtcclxuICAgICAgICBsZXQgYiA9IDIgKiAoVmVjdG9yLmRvdChELCBGKSAtIFZlY3Rvci5kb3QoRCwgdGhpcy5DKSk7XHJcbiAgICAgICAgbGV0IGMgPSBWZWN0b3IuZG90KEYsIEYpIC0gMiAqIFZlY3Rvci5kb3QoRiwgdGhpcy5DKSArIFZlY3Rvci5kb3QodGhpcy5DLCB0aGlzLkMpIC0gdGhpcy5SICogdGhpcy5SO1xyXG5cclxuICAgICAgICBsZXQgayA9IGIgKiBiIC0gNCAqIGEgKiBjO1xyXG4gICAgICAgIGlmIChudW1iZXJfZXF1YWwoaywgMCkpIHsgIC8vIOS6pOaWvDHpu55cclxuICAgICAgICAgICAgbGV0IHQgPSAtYiAvICgyICogYSk7XHJcblxyXG4gICAgICAgICAgICAvL+aTi+aOiVxyXG4gICAgICAgICAgICBpZiAodCA8IDApIHsgcmV0dXJuIHsgaXNfaGl0OiBmYWxzZSB9IH1cclxuXHJcbiAgICAgICAgICAgIGxldCBoaXRfcG9zID0gRi5hZGQoRC5tdWx0aXBseSh0KSk7XHJcbiAgICAgICAgICAgIGxldCBub3JtYWwgPSBoaXRfcG9zLm1pbnVzKHRoaXMuQykubm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBoaXRfcG9zLFxyXG4gICAgICAgICAgICAgICAgaTogRCxcclxuICAgICAgICAgICAgICAgIHQsXHJcbiAgICAgICAgICAgICAgICBub3JtYWwsXHJcbiAgICAgICAgICAgICAgICBzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoayA+IDApIHsgLy8g5Lqk5pa8Mum7nlxyXG5cclxuICAgICAgICAgICAgLy8g6YGO5r++5Ye6dD4wXHJcbiAgICAgICAgICAgIC8vIHJheS5mcm9t5Zyo55CD5YWn55CD5pyJ5Y+v6IO95Ye654++dDwwXHJcbiAgICAgICAgICAgIC8vIOeQg+WcqHJheeeahOW+jOmdouS5n+WPr+iDveWHuuePvnQ8MFxyXG4gICAgICAgICAgICBsZXQgc3FydF9rID0gTWF0aC5zcXJ0KGspO1xyXG4gICAgICAgICAgICBsZXQgdF9saXN0ID0gWygtYiAtIHNxcnRfaykgLyAoMiAqIGEpLCAoLWIgKyBzcXJ0X2spIC8gKDIgKiBhKV0uZmlsdGVyKHggPT4geCA+IDApO1xyXG5cclxuICAgICAgICAgICAgLy8g6YO95piv6LKg5YC8XHJcbiAgICAgICAgICAgIGlmICh0X2xpc3QubGVuZ3RoID09IDApIHsgcmV0dXJuIHsgaXNfaGl0OiBmYWxzZSB9IH1cclxuXHJcbiAgICAgICAgICAgIGxldCB0ID0gdF9saXN0WzBdO1xyXG4gICAgICAgICAgICBsZXQgaGl0X3BvcyA9IEYuYWRkKEQubXVsdGlwbHkodCkpO1xyXG4gICAgICAgICAgICBsZXQgbm9ybWFsID0gaGl0X3Bvcy5taW51cyh0aGlzLkMpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaXNfaGl0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgaGl0X3BvcyxcclxuICAgICAgICAgICAgICAgIGk6IEQsXHJcbiAgICAgICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICAgICAgbm9ybWFsLFxyXG4gICAgICAgICAgICAgICAgc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHsgLy8g5rKS5Lqk6bueXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVuZGVyVGFyZ2V0IHtcclxuICAgIHc6IG51bWJlciA9IDMyMDtcclxuICAgIGg6IG51bWJlciA9IDI0MDtcclxuICAgIGJhY2tidWZmZXI6IE9mZnNjcmVlbkNhbnZhcyA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3Rvcih3OiBudW1iZXIgPSAzMjAsIGg6IG51bWJlciA9IDI0MCkge1xyXG4gICAgICAgIHRoaXMudyA9IHc7XHJcbiAgICAgICAgdGhpcy5oID0gaDtcclxuICAgICAgICB0aGlzLmJhY2tidWZmZXIgPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHRoaXMudywgdGhpcy5oKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJfcGl4ZWwoZnVuYzogKHhfd2VpZ2h0OiBudW1iZXIsIHlfd2VpZ2h0OiBudW1iZXIsIHJhdGlvOiBudW1iZXIpID0+IFZlY3Rvcikge1xyXG5cclxuICAgICAgICBsZXQgY29udGV4dF8yZCA9IHRoaXMuYmFja2J1ZmZlci5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAvLyBnZXQgc291cmNlIGRhdGEgYXJyYXlcclxuICAgICAgICBsZXQgYmFja2J1ZmZlcl9kYXRhID0gY29udGV4dF8yZC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy53LCB0aGlzLmgpO1xyXG4gICAgICAgIGxldCBiYWNrYnVmZmVyX2RhdGFfYXJyYXkgPSBiYWNrYnVmZmVyX2RhdGEuZGF0YTtcclxuXHJcbiAgICAgICAgbGV0IHJhdGlvID0gdGhpcy53IC8gdGhpcy5oO1xyXG5cclxuICAgICAgICAvLyBzZXQgYXJyYXkgdmFsdWVcclxuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuaDsgKyt5KSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgdGhpcy53OyArK3gpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJnYmEgZWFjaCBjb2xvciBpcyA0Ynl0ZVxyXG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gNCAqICh4ICsgeSAqIHRoaXMudyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtYXAgdG8gMH4xXHJcbiAgICAgICAgICAgICAgICBsZXQgWCA9ICh4IC8gdGhpcy53KTtcclxuICAgICAgICAgICAgICAgIGxldCBZID0gKHkgLyB0aGlzLmgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNoYW5nZSB5IGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgWSA9IDEgLSBZO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJlbWFwIHRvIC0xfjFcclxuICAgICAgICAgICAgICAgIGxldCB4X3dlaWdodCA9IFggKiAyIC0gMTtcclxuICAgICAgICAgICAgICAgIGxldCB5X3dlaWdodCA9IFkgKiAyIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBmdW5jKHhfd2VpZ2h0LCB5X3dlaWdodCwgcmF0aW8pO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCByID0gY29sb3IueDtcclxuICAgICAgICAgICAgICAgIGxldCBnID0gY29sb3IueTtcclxuICAgICAgICAgICAgICAgIGxldCBiID0gY29sb3IuejtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBnYW1tYeagoeato1xyXG4gICAgICAgICAgICAgICAgbGV0IGdhbW1hID0gMSAvIDIuMTtcclxuICAgICAgICAgICAgICAgIHIgPSBNYXRoLnBvdyhyLCBnYW1tYSk7XHJcbiAgICAgICAgICAgICAgICBnID0gTWF0aC5wb3coZywgZ2FtbWEpO1xyXG4gICAgICAgICAgICAgICAgYiA9IE1hdGgucG93KGIsIGdhbW1hKTtcclxuXHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXgrK10gPSBNYXRoLnJvdW5kKHIgKiAyNTUpO1xyXG4gICAgICAgICAgICAgICAgYmFja2J1ZmZlcl9kYXRhX2FycmF5W2luZGV4KytdID0gTWF0aC5yb3VuZChnICogMjU1KTtcclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleCsrXSA9IE1hdGgucm91bmQoYiAqIDI1NSk7XHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXhdID0gMjU1O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRleHRfMmQucHV0SW1hZ2VEYXRhKGJhY2tidWZmZXJfZGF0YSwgMCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd19idWZmZXIoY2FudmFzX2lkOiBzdHJpbmcpIHtcclxuICAgICAgICAvLyDoqK3lrppidWZmZXLnmoTlpKflsI/lkoxjc3Mgc3R5bGXnmoTlpKflsI/kuIDmqKNcclxuICAgICAgICAvLyBodHRwczovL29wZW5ob21lLmNjL0dvc3NpcC9XZWJHTC9DYW52YXMuaHRtbFxyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYW52YXNfaWQpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcbiAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgY2FudmFzLndpZHRoID0gY2FudmFzLmNsaWVudFdpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjYW52YXMuY2xpZW50SGVpZ2h0O1xyXG5cclxuICAgICAgICAvLyBjb3B5IGJhY2tidWZmZXIgdG8gY2FudmFzXHJcbiAgICAgICAgbGV0IGNvbnRleHRfYml0bWFwX3JlbmRlciA9IGNhbnZhcy5nZXRDb250ZXh0KFwiYml0bWFwcmVuZGVyZXJcIik7XHJcbiAgICAgICAgY29udGV4dF9iaXRtYXBfcmVuZGVyLnRyYW5zZmVyRnJvbUltYWdlQml0bWFwKHRoaXMuYmFja2J1ZmZlci50cmFuc2ZlclRvSW1hZ2VCaXRtYXAoKSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgRGlmZnVzZSBmcm9tIFwiLi4vTWF0ZXJhaWxzL0RpZmZ1c2VcIjtcclxuaW1wb3J0IEhpdGFibGUgZnJvbSBcIi4uL01hdGgvSGl0YWJsZVwiO1xyXG5pbXBvcnQgU2hhZGVyIGZyb20gXCIuLi9NYXRlcmFpbHMvU2hhZGVyXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTY2VuZU5vZGUge1xyXG5cclxuICAgIHM6IFNoYWRlcjtcclxuICAgIGg6IEhpdGFibGU7XHJcbiAgICBjb25zdHJ1Y3RvcihzOiBTaGFkZXIsIGg6IEhpdGFibGUpIHtcclxuICAgICAgICB0aGlzLnMgPSBzO1xyXG4gICAgICAgIHRoaXMuaCA9IGg7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgU2hhZGVyIGZyb20gXCIuL1NoYWRlclwiO1xyXG5pbXBvcnQgVmVjdG9yIGZyb20gXCIuLi9NYXRoL1ZlY3RvclwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi4vTWF0aC9IaXRJbmZvXCI7XHJcbmltcG9ydCB7IGVwc2lsb24sIGdldF9oaXRfc29ydF9saXN0IH0gZnJvbSBcIi4uL01hdGgvVG9vbFwiXHJcbmltcG9ydCBSYXkgZnJvbSBcIi4uL01hdGgvUmF5XCI7XHJcbmltcG9ydCBTY2VuZU5vZGUgZnJvbSBcIi4uL09iamVjdC9TY2VuZU5vZGVcIjtcclxuaW1wb3J0IERpZmZ1c2UgZnJvbSBcIi4vRGlmZnVzZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWlycm9yIGltcGxlbWVudHMgU2hhZGVyIHtcclxuICAgIHNoYWRpbmcoaGl0X2luZm86IEhpdEluZm8sIGRpcmVjdGlvbl9saWdodF9kaXI6IFZlY3Rvciwgb2JqX2xpc3Q6IFNjZW5lTm9kZVtdLCBkZXB0aDogbnVtYmVyKSB7XHJcblxyXG4gICAgICAgIGlmIChkZXB0aCA+IDIwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfotoXpgY7kuIrpmZAnKTtcclxuICAgICAgICAgICAgcmV0dXJuIERpZmZ1c2UuZ3JlZW4uY29sb3I7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgbiA9IGhpdF9pbmZvLm5vcm1hbDtcclxuICAgICAgICBsZXQgaSA9IGhpdF9pbmZvLmk7XHJcbiAgICAgICAgbGV0IHIgPSBWZWN0b3IucmVmbGVjdChpLCBuKTtcclxuXHJcbiAgICAgICAgbGV0IGZyb20gPSBoaXRfaW5mby5oaXRfcG9zLmFkZChyLm11bHRpcGx5KGVwc2lsb24pKTsgLy8g5YGP56e75LiA5bCP5q616Led6Zui77yM6YG/5YWN5bCE5Lit6Ieq5bexXHJcbiAgICAgICAgbGV0IHJheSA9IG5ldyBSYXkoZnJvbSwgcik7XHJcblxyXG4gICAgICAgIGxldCBoaXRfc29ydF9saXN0ID0gZ2V0X2hpdF9zb3J0X2xpc3Qob2JqX2xpc3QsIHJheSk7XHJcblxyXG4gICAgICAgIGxldCBjb2xvciA9IG5ldyBWZWN0b3IoMSwgMSwgMSk7XHJcbiAgICAgICAgLy8g5pyJ5bCE5Lit5ZeOXHJcbiAgICAgICAgbGV0IGlzX2hpdCA9IGhpdF9zb3J0X2xpc3QubGVuZ3RoICE9IDA7XHJcbiAgICAgICAgaWYgKGlzX2hpdCkge1xyXG4gICAgICAgICAgICBsZXQgaGl0X2luZm9fbmV4dCA9IGhpdF9zb3J0X2xpc3RbMF07XHJcbiAgICAgICAgICAgIGxldCBoaXRfY29sb3IgPSBoaXRfaW5mb19uZXh0LnMuc2hhZGluZyhoaXRfaW5mb19uZXh0LCBkaXJlY3Rpb25fbGlnaHRfZGlyLCBvYmpfbGlzdCwgKytkZXB0aCk7XHJcbiAgICAgICAgICAgIHJldHVybiBWZWN0b3IubXVsdGlwbHkzKGNvbG9yLCBoaXRfY29sb3IubXVsdGlwbHkoMC45KSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFZlY3Rvci5tdWx0aXBseTMoY29sb3IsIERpZmZ1c2UuZ3JheS5jb2xvci5tdWx0aXBseSgwLjkpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgQXBwIGZyb20gJy4vQXBwJztcclxuXHJcbm5ldyBBcHAoKTsiLCJpbXBvcnQgVmVjdG9yIGZyb20gJy4vTWF0aC9WZWN0b3InXHJcbmltcG9ydCBDYW1lcmEgZnJvbSAnLi9NYXRoL0NhbWVyYSdcclxuaW1wb3J0IFJlY3QgZnJvbSAnLi9NYXRoL1JlY3QnO1xyXG5pbXBvcnQgUGxhbmUgZnJvbSAnLi9NYXRoL1BsYW5lJztcclxuaW1wb3J0IFNwaGVyZSBmcm9tICcuL01hdGgvU3BoZXJlJztcclxuaW1wb3J0IFJlbmRlclRhcmdldCBmcm9tICcuL01hdGgvUmVuZGVyVGFyZ2V0JztcclxuaW1wb3J0IFNjZW5lTm9kZSBmcm9tICcuL09iamVjdC9TY2VuZU5vZGUnO1xyXG5pbXBvcnQgRGlmZnVzZSBmcm9tICcuL01hdGVyYWlscy9EaWZmdXNlJztcclxuaW1wb3J0IE1pcnJvciBmcm9tICcuL01hdGVyYWlscy9NaXJyb3InO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG5cclxuICAgICAgICBsZXQgZmxvb3IgPSBuZXcgU2NlbmVOb2RlKERpZmZ1c2Uud2hpdGUsIG5ldyBSZWN0KG5ldyBQbGFuZShWZWN0b3IuemVybywgVmVjdG9yLnVwKSwgMTYsIDE2KSlcclxuICAgICAgICBsZXQgb2JqX2xpc3Q6IFNjZW5lTm9kZVtdID0gW2Zsb29yXTtcclxuICAgICAgICBvYmpfbGlzdC5wdXNoKG5ldyBTY2VuZU5vZGUoRGlmZnVzZS55ZWxsb3csIG5ldyBTcGhlcmUobmV3IFZlY3Rvcig2LCAyLCAtOCksIDIpKSk7XHJcbiAgICAgICAgb2JqX2xpc3QucHVzaChuZXcgU2NlbmVOb2RlKERpZmZ1c2UuZ3JlZW4sIG5ldyBTcGhlcmUobmV3IFZlY3RvcigtNiwgMiwgLTgpLCAyKSkpO1xyXG4gICAgICAgIG9ial9saXN0LnB1c2gobmV3IFNjZW5lTm9kZShEaWZmdXNlLmJsdWUsIG5ldyBTcGhlcmUobmV3IFZlY3RvcigwLCAyLCAtMTIpLCAyKSkpO1xyXG5cclxuICAgICAgICBvYmpfbGlzdC5wdXNoKG5ldyBTY2VuZU5vZGUobmV3IE1pcnJvcigpLCBuZXcgU3BoZXJlKG5ldyBWZWN0b3IoMCwgNCwgLTYpLCA0KSkpO1xyXG4gICAgICAgIG9ial9saXN0LnB1c2gobmV3IFNjZW5lTm9kZShuZXcgTWlycm9yKCksIG5ldyBTcGhlcmUobmV3IFZlY3RvcigxMiwgNCwgLTYpLCA0KSkpO1xyXG4gICAgICAgIG9ial9saXN0LnB1c2gobmV3IFNjZW5lTm9kZShuZXcgTWlycm9yKCksIG5ldyBTcGhlcmUobmV3IFZlY3Rvcig4LCA0LCAyKSwgNCkpKTtcclxuXHJcbiAgICAgICAgbGV0IGNhbWVyYSA9IG5ldyBDYW1lcmEobmV3IFZlY3RvcigwLCAyMCwgLTIwKSwgVmVjdG9yLnplcm8sIDYwKTtcclxuICAgICAgICBsZXQgcmVuZGVyX3RhcmdldCA9IG5ldyBSZW5kZXJUYXJnZXQoODAwLCA2MDApO1xyXG4gICAgICAgIGNhbWVyYS5yZW5kZXIocmVuZGVyX3RhcmdldCwgb2JqX2xpc3QpO1xyXG4gICAgICAgIHJlbmRlcl90YXJnZXQuc2hvd19idWZmZXIoJ2NhbnZhcycpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9