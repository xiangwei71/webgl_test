!function(t){var i={};function n(e){if(i[e])return i[e].exports;var r=i[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=i,n.d=function(t,i,e){n.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,i){if(1&i&&(t=n(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)n.d(e,r,function(i){return t[i]}.bind(null,r));return e},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},n.p="",n(n.s=0)}([function(t,i,n){"use strict";n.r(i);var e=function(){function t(t,i,n){this.x=0,this.y=0,this.z=0,this.x=t,this.y=i,this.z=n}return t.add=function(i,n){return new t(n.x+i.x,n.y+i.y,n.z+i.z)},t.minus=function(i,n){return new t(i.x-n.x,i.y-n.y,i.z-n.z)},t.multiply=function(i,n){return new t(i.x*n,i.y*n,i.z*n)},t.cross_product=function(i,n){return new t(i.y*n.z-i.z*n.y,-i.x*n.z+i.z*n.x,i.x*n.y-i.y*n.x)},t.dot_product=function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},t.prototype.add=function(i){return t.add(this,i)},t.prototype.minus=function(i){return t.minus(this,i)},t.prototype.multiply=function(i){return t.multiply(this,i)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.up=new t(0,1,0),t.zero=new t(0,0,0),t}(),r=function(t,i){this.from=t,this.dir=i};var s=function(){function t(t,i,n){this.z_axis=e.minus(i,t).normalize();var r=e.up;this.x_axis=e.cross_product(r,this.z_axis).normalize(),this.y_axis=e.cross_product(this.z_axis,this.x_axis),this.eye=t,this.fov_degree=n}return t.prototype.create_ray=function(t,i,n){var e,s=(e=.5*this.fov_degree,Math.PI*e/180),o=Math.tan(s),h=o*n,u=this.z_axis.add(this.x_axis.multiply(t*h)).add(this.y_axis.multiply(i*o));return new r(this.eye.clone(),u)},t}(),o=function(){function t(t,i,n){this.plane=t,this.w=i,this.h=n}return t.prototype.hit=function(t){var i=this.plane.hit(t);if(i.is_hit){var n=i.hit_pos,r=n.minus(this.plane.C),s=e.cross_product(e.up,this.plane.N).normalize(),o=e.cross_product(s,this.plane.N),h=e.dot_product(r,s),u=e.dot_product(r,o);return{is_hit:Math.abs(h)<this.w&&Math.abs(u)<this.h,hit_pos:n}}return{is_hit:!1,hit_pos:null}},t}(),h=function(){function t(t,i){this.C=t,this.N=i}return t.prototype.is_positive=function(t){var i=e.minus(t,this.C);return e.dot_product(i,this.N)>0},t.prototype.hit=function(t){var i=t.from,n=t.dir,r=e.dot_product(n,this.N),s=e.dot_product(e.minus(this.C,i),this.N);if(Math.abs(r)<.001)return{is_hit:!1,hit_pos:null};var o=s/r;return{is_hit:o>0,hit_pos:i.add(n.multiply(o))}},t}();new function(){this.w=320,this.h=240,this.backbuffer=null,this.backbuffer=new OffscreenCanvas(this.w,this.h);for(var t=this.backbuffer.getContext("2d"),i=t.getImageData(0,0,this.w,this.h),n=i.data,r=this.w/this.h,u=new s(new e(0,10,-10),e.zero,60),a=new o(new h(e.zero,new e(0,0,-1)),4,2),c=0;c<this.h;++c)for(var p=0;p<this.w;++p){var f=4*(p+c*this.w),d=p/this.w,l=c/this.h,y=2*d-1,_=2*(l=1-l)-1,x=u.create_ray(y,_,r),m=a.hit(x),z=m.is_hit?1:0,w=m.is_hit?1:0;n[f++]=Math.round(255*z),n[f++]=Math.round(255*w),n[f++]=Math.round(0),n[f]=255}t.putImageData(i,0,0);var v=document.getElementById("canvas");v.style.width=this.w+"px",v.style.height=this.h+"px",v.width=v.clientWidth,v.height=v.clientHeight,v.getContext("bitmaprenderer").transferFromImageBitmap(this.backbuffer.transferToImageBitmap())}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvVmVjdG9yLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1JheS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9DYW1lcmEudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvVG9vbC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9SZWN0LnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1BsYW5lLnRzIiwid2VicGFjazovLy8uL3NyYy9tYWluLnRzIiwid2VicGFjazovLy8uL3NyYy9BcHAudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJweCIsInB5IiwicHoiLCJ4IiwieSIsInoiLCJ0aGlzIiwiYWRkIiwiQSIsIkIiLCJWZWN0b3IiLCJtaW51cyIsIm11bHRpcGx5IiwiY3Jvc3NfcHJvZHVjdCIsImRvdF9wcm9kdWN0IiwibGVuZ3RoIiwiTWF0aCIsInNxcnQiLCJub3JtYWxpemUiLCJ0ZW1wIiwiY2xvbmUiLCJ1cCIsInplcm8iLCJmcm9tIiwiZGlyIiwiZXllIiwibG9va19hdCIsImZvdl9kZWdyZWUiLCJ6X2F4aXMiLCJoZWxwX3YiLCJ4X2F4aXMiLCJ5X2F4aXMiLCJjcmVhdGVfcmF5IiwieF93ZWlnaHQiLCJ5X3dlaWdodCIsInJhdGlvIiwiaGFsZl9mb3ZfcmFkIiwiUEkiLCJ0YW5faCIsInRhbiIsInRhbl93IiwicGxhbmUiLCJ3IiwiaCIsImhpdCIsInJheSIsInJlc3VsdCIsImlzX2hpdCIsImhpdF9wb3MiLCJkaWZmIiwiQyIsIndfYXhpcyIsIk4iLCJoX2F4aXMiLCJ3X3ZhbHVlIiwiaF92YWx1ZSIsImFicyIsInBvaW50Iiwibm9ybWFsIiwiaXNfcG9zaXRpdmUiLCJ0ZXN0X3AiLCJiYWNrYnVmZmVyIiwiT2Zmc2NyZWVuQ2FudmFzIiwiY29udGV4dF8yZCIsImdldENvbnRleHQiLCJiYWNrYnVmZmVyX2RhdGEiLCJnZXRJbWFnZURhdGEiLCJiYWNrYnVmZmVyX2RhdGFfYXJyYXkiLCJkYXRhIiwiY2FtZXJhIiwicmVjdCIsImluZGV4IiwiWCIsIlkiLCJnIiwicm91bmQiLCJiIiwicHV0SW1hZ2VEYXRhIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsInRyYW5zZmVyRnJvbUltYWdlQml0bWFwIiwidHJhbnNmZXJUb0ltYWdlQml0bWFwIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENH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LEVBQ2QrQixFQUFLckUsRUFBSUUsS0FBS3FDLEVBTWRWLEVBQWUsRUFBSnVDLEVBQVEsRUFDbkJ0QyxFQUFlLEdBSm5CdUMsRUFBSSxFQUFJQSxHQUllLEVBRW5CNUIsRUFBTXdCLEVBQU9yQyxXQUFXQyxFQUFVQyxFQUFVQyxHQUM1Q1csRUFBU3dCLEVBQUsxQixJQUFJQyxHQU1sQi9ELEVBQUlnRSxFQUFPQyxPQUFTLEVBQUksRUFDeEIyQixFQUFJNUIsRUFBT0MsT0FBUyxFQUFJLEVBRzVCb0IsRUFBc0JJLEtBQVd2RCxLQUFLMkQsTUFBVSxJQUFKN0YsR0FDNUNxRixFQUFzQkksS0FBV3ZELEtBQUsyRCxNQUFVLElBQUpELEdBQzVDUCxFQUFzQkksS0FBV3ZELEtBQUsyRCxNQUFNQyxHQUM1Q1QsRUFBc0JJLEdBQVMsSUFHdkNSLEVBQVdjLGFBQWFaLEVBQWlCLEVBQUcsR0FLNUMsSUFBSWEsRUFBU0MsU0FBU0MsZUFBZSxVQUNyQ0YsRUFBT0csTUFBTUMsTUFBUTVFLEtBQUtvQyxFQUFJLEtBQzlCb0MsRUFBT0csTUFBTUUsT0FBUzdFLEtBQUtxQyxFQUFJLEtBQy9CbUMsRUFBT0ksTUFBUUosRUFBT00sWUFDdEJOLEVBQU9LLE9BQVNMLEVBQU9PLGFBR0tQLEVBQU9kLFdBQVcsa0JBQ3hCc0Isd0JBQXdCaEYsS0FBS3VELFdBQVcwQiIsImZpbGUiOiJidWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIlxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZlY3RvciB7XHJcblxyXG4gICAgc3RhdGljIHVwID0gbmV3IFZlY3RvcigwLCAxLCAwKTtcclxuICAgIHN0YXRpYyB6ZXJvID0gbmV3IFZlY3RvcigwLCAwLCAwKTtcclxuXHJcbiAgICBzdGF0aWMgYWRkKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEIueCArIEEueCwgQi55ICsgQS55LCBCLnogKyBBLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG1pbnVzKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAtIEIueCwgQS55IC0gQi55LCBBLnogLSBCLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG11bHRpcGx5KEE6IFZlY3RvciwgczogbnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAqIHMsIEEueSAqIHMsIEEueiAqIHMpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNyb3NzX3Byb2R1Y3QoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICB2YXIgdGVtcCA9IG5ldyBWZWN0b3IoQS55ICogQi56IC0gQS56ICogQi55LCAtQS54ICogQi56ICsgQS56ICogQi54LCBBLnggKiBCLnkgLSBBLnkgKiBCLngpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBkb3RfcHJvZHVjdChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBBLnggKiBCLnggKyBBLnkgKiBCLnkgKyBBLnogKiBCLno7XHJcbiAgICB9XHJcblxyXG4gICAgeDogbnVtYmVyID0gMDtcclxuICAgIHk6IG51bWJlciA9IDA7XHJcbiAgICB6OiBudW1iZXIgPSAwO1xyXG4gICAgY29uc3RydWN0b3IocHg6IG51bWJlciwgcHk6IG51bWJlciwgcHo6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMueCA9IHB4O1xyXG4gICAgICAgIHRoaXMueSA9IHB5O1xyXG4gICAgICAgIHRoaXMueiA9IHB6O1xyXG4gICAgfVxyXG5cclxuICAgIGxlbmd0aCgpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueik7XHJcbiAgICB9XHJcblxyXG4gICAgbm9ybWFsaXplKCkge1xyXG4gICAgICAgIHZhciB0ZW1wID0gdGhpcy5sZW5ndGgoKTtcclxuICAgICAgICB0aGlzLnggPSB0aGlzLnggLyB0ZW1wO1xyXG4gICAgICAgIHRoaXMueSA9IHRoaXMueSAvIHRlbXA7XHJcbiAgICAgICAgdGhpcy56ID0gdGhpcy56IC8gdGVtcDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBhZGQoQTogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5hZGQodGhpcywgQSk7XHJcbiAgICB9XHJcblxyXG4gICAgbWludXMoQTogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5taW51cyh0aGlzLCBBKTtcclxuICAgIH1cclxuXHJcbiAgICBtdWx0aXBseShzOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLm11bHRpcGx5KHRoaXMsIHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb25lKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKHRoaXMueCwgdGhpcy55LCB0aGlzLnopO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY29yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmF5IHtcclxuICAgIGZyb206IFZlY29yO1xyXG4gICAgZGlyOiBWZWNvcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihmcm9tOiBWZWNvciwgZGlyOiBWZWNvcikge1xyXG4gICAgICAgIHRoaXMuZnJvbSA9IGZyb207XHJcbiAgICAgICAgdGhpcy5kaXIgPSBkaXI7XHJcbiAgICB9XHJcbn07IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IHsgZGVncmVlX3RvX1JhZCB9IGZyb20gXCIuL1Rvb2xcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FtZXJhIHtcclxuICAgIGV5ZTogVmVjdG9yO1xyXG5cclxuICAgIHhfYXhpczogVmVjdG9yO1xyXG4gICAgeV9heGlzOiBWZWN0b3I7XHJcbiAgICB6X2F4aXM6IFZlY3RvcjtcclxuXHJcbiAgICBmb3ZfZGVncmVlOiBudW1iZXI7XHJcbiAgICBjb25zdHJ1Y3RvcihleWU6IFZlY3RvciwgbG9va19hdDogVmVjdG9yLCBmb3ZfZGVncmVlOiBudW1iZXIpIHtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIDPou7hcclxuICAgICAgICB0aGlzLnpfYXhpcyA9IFZlY3Rvci5taW51cyhsb29rX2F0LCBleWUpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgaGVscF92ID0gVmVjdG9yLnVwO1xyXG4gICAgICAgIHRoaXMueF9heGlzID0gVmVjdG9yLmNyb3NzX3Byb2R1Y3QoaGVscF92LCB0aGlzLnpfYXhpcykubm9ybWFsaXplKCk7XHJcbiAgICAgICAgdGhpcy55X2F4aXMgPSBWZWN0b3IuY3Jvc3NfcHJvZHVjdCh0aGlzLnpfYXhpcywgdGhpcy54X2F4aXMpO1xyXG5cclxuICAgICAgICAvLyBjYW1lcmEg5Y6f6bueXHJcbiAgICAgICAgdGhpcy5leWUgPSBleWU7XHJcblxyXG4gICAgICAgIC8vIGNhbWVyYSBmb3ZcclxuICAgICAgICB0aGlzLmZvdl9kZWdyZWUgPSBmb3ZfZGVncmVlO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZV9yYXkoeF93ZWlnaHQ6IG51bWJlciwgeV93ZWlnaHQ6IG51bWJlciwgcmF0aW86IG51bWJlcikge1xyXG4gICAgICAgIGxldCBoYWxmX2Zvdl9yYWQgPSBkZWdyZWVfdG9fUmFkKDAuNSAqIHRoaXMuZm92X2RlZ3JlZSk7XHJcbiAgICAgICAgbGV0IHRhbl9oID0gTWF0aC50YW4oaGFsZl9mb3ZfcmFkKTtcclxuICAgICAgICBsZXQgdGFuX3cgPSB0YW5faCAqIHJhdGlvO1xyXG5cclxuICAgICAgICBsZXQgZGlyID0gdGhpcy56X2F4aXNcclxuICAgICAgICAgICAgLmFkZCh0aGlzLnhfYXhpcy5tdWx0aXBseSh4X3dlaWdodCAqIHRhbl93KSlcclxuICAgICAgICAgICAgLmFkZCh0aGlzLnlfYXhpcy5tdWx0aXBseSh5X3dlaWdodCAqIHRhbl9oKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgUmF5KHRoaXMuZXllLmNsb25lKCksIGRpcik7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZnVuY3Rpb24gZGVncmVlX3RvX1JhZChkOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBNYXRoLlBJICogZCAvIDE4MDtcclxufTsiLCJpbXBvcnQgUGxhbmUgZnJvbSBcIi4vUGxhbmVcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuXHJcbi8vIOWwj+aWueWhilxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWN0IHtcclxuICAgIHBsYW5lOiBQbGFuZTtcclxuICAgIHc6IG51bWJlcjtcclxuICAgIGg6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwbGFuZTogUGxhbmUsIHc6IG51bWJlciwgaDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5wbGFuZSA9IHBsYW5lO1xyXG4gICAgICAgIHRoaXMudyA9IHc7XHJcbiAgICAgICAgdGhpcy5oID0gaDtcclxuICAgIH1cclxuXHJcbiAgICBoaXQocmF5OiBSYXkpIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5wbGFuZS5oaXQocmF5KTtcclxuICAgICAgICBpZiAocmVzdWx0LmlzX2hpdCkge1xyXG4gICAgICAgICAgICBsZXQgaGl0X3BvcyA9IHJlc3VsdC5oaXRfcG9zO1xyXG4gICAgICAgICAgICBsZXQgZGlmZiA9IGhpdF9wb3MubWludXModGhpcy5wbGFuZS5DKTtcclxuICAgICAgICAgICAgbGV0IHdfYXhpcyA9IFZlY3Rvci5jcm9zc19wcm9kdWN0KFZlY3Rvci51cCwgdGhpcy5wbGFuZS5OKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgbGV0IGhfYXhpcyA9IFZlY3Rvci5jcm9zc19wcm9kdWN0KHdfYXhpcywgdGhpcy5wbGFuZS5OKTtcclxuICAgICAgICAgICAgbGV0IHdfdmFsdWUgPSBWZWN0b3IuZG90X3Byb2R1Y3QoZGlmZiwgd19heGlzKTtcclxuICAgICAgICAgICAgbGV0IGhfdmFsdWUgPSBWZWN0b3IuZG90X3Byb2R1Y3QoZGlmZiwgaF9heGlzKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBpc19oaXQgPSBNYXRoLmFicyh3X3ZhbHVlKSA8IHRoaXMudyAmJiBNYXRoLmFicyhoX3ZhbHVlKSA8IHRoaXMuaDtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdCxcclxuICAgICAgICAgICAgICAgIGhpdF9wb3NcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaGl0X3BvczogbnVsbCxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCBWZWN0b3IgZnJvbSAnLi9WZWN0b3InO1xyXG5pbXBvcnQgUmF5IGZyb20gJy4vUmF5JztcclxuXHJcbi8vIOW5s+mdolxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbGFuZSB7XHJcblxyXG4gICAgQzogVmVjdG9yO1xyXG4gICAgTjogVmVjdG9yO1xyXG4gICAgY29uc3RydWN0b3IocG9pbnQ6IFZlY3Rvciwgbm9ybWFsOiBWZWN0b3IpIHtcclxuICAgICAgICB0aGlzLkMgPSBwb2ludDtcclxuICAgICAgICB0aGlzLk4gPSBub3JtYWw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5ris6KmmdGVzcF9w5ZKM5pa55ZCR6YeP5piv5LiN5piv5Zyo5ZCM5LiA6YKKXHJcbiAgICBpc19wb3NpdGl2ZSh0ZXN0X3A6IFZlY3Rvcikge1xyXG4gICAgICAgIGxldCBkaWZmID0gVmVjdG9yLm1pbnVzKHRlc3RfcCwgdGhpcy5DKTtcclxuICAgICAgICB2YXIgdmFsdWUgPSBWZWN0b3IuZG90X3Byb2R1Y3QoZGlmZiwgdGhpcy5OKTtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPiAwO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChyYXk6IFJheSkge1xyXG4gICAgICAgIC8vIHJheSBoaXQgcGxhbmUgXHJcbiAgICAgICAgbGV0IGZyb20gPSByYXkuZnJvbTtcclxuICAgICAgICBsZXQgZGlyID0gcmF5LmRpcjtcclxuXHJcbiAgICAgICAgLy8gKEYtQynjgIJOICsgdCAoROOAgk4pID0gMFxyXG4gICAgICAgIC8vIHQgID0gKEMtRinjgIJOIC8gKETjgIJOKVxyXG4gICAgICAgIC8vIHQgID0gKEEgLyAoQilcclxuICAgICAgICBsZXQgQiA9IFZlY3Rvci5kb3RfcHJvZHVjdChkaXIsIHRoaXMuTik7XHJcbiAgICAgICAgbGV0IEEgPSBWZWN0b3IuZG90X3Byb2R1Y3QoVmVjdG9yLm1pbnVzKHRoaXMuQywgZnJvbSksIHRoaXMuTik7XHJcblxyXG4gICAgICAgIC8vIGF2b2lkIGRpdmlkZSBieSAwXHJcbiAgICAgICAgbGV0IGVwc2lsb24gPSAwLjAwMTtcclxuICAgICAgICBpZiAoTWF0aC5hYnMoQikgPCBlcHNpbG9uKVxyXG4gICAgICAgICAgICByZXR1cm4geyBpc19oaXQ6IGZhbHNlLCBoaXRfcG9zOiBudWxsIH07XHJcblxyXG4gICAgICAgIGxldCB0ID0gQSAvIEI7XHJcbiAgICAgICAgbGV0IGlzX2hpdCA9IHQgPiAwLjA7XHJcbiAgICAgICAgbGV0IGhpdF9wb3MgPSBmcm9tLmFkZChkaXIubXVsdGlwbHkodCkpO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpc19oaXQsXHJcbiAgICAgICAgICAgIGhpdF9wb3NcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgQXBwIGZyb20gJy4vQXBwJztcclxuXHJcbm5ldyBBcHAoKTsiLCJpbXBvcnQgVmVjdG9yIGZyb20gJy4vTWF0aC9WZWN0b3InXHJcbmltcG9ydCBDYW1lcmEgZnJvbSAnLi9NYXRoL0NhbWVyYSdcclxuaW1wb3J0IFJheSBmcm9tICcuL01hdGgvUmF5J1xyXG5pbXBvcnQgUmVjdCBmcm9tICcuL01hdGgvUmVjdCc7XHJcbmltcG9ydCBQbGFuZSBmcm9tICcuL01hdGgvUGxhbmUnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwIHtcclxuXHJcbiAgICB3OiBudW1iZXIgPSAzMjA7XHJcbiAgICBoOiBudW1iZXIgPSAyNDA7XHJcbiAgICBiYWNrYnVmZmVyOiBPZmZzY3JlZW5DYW52YXMgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYmFja2J1ZmZlciA9IG5ldyBPZmZzY3JlZW5DYW52YXModGhpcy53LCB0aGlzLmgpO1xyXG4gICAgICAgIGxldCBjb250ZXh0XzJkID0gdGhpcy5iYWNrYnVmZmVyLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG4gICAgICAgIC8vIGdldCBzb3VyY2UgZGF0YSBhcnJheVxyXG4gICAgICAgIGxldCBiYWNrYnVmZmVyX2RhdGEgPSBjb250ZXh0XzJkLmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLncsIHRoaXMuaCk7XHJcbiAgICAgICAgbGV0IGJhY2tidWZmZXJfZGF0YV9hcnJheSA9IGJhY2tidWZmZXJfZGF0YS5kYXRhO1xyXG5cclxuICAgICAgICBsZXQgcmF0aW8gPSB0aGlzLncgLyB0aGlzLmg7XHJcblxyXG4gICAgICAgIGxldCBjYW1lcmEgPSBuZXcgQ2FtZXJhKG5ldyBWZWN0b3IoMCwgMTAsIC0xMCksIFZlY3Rvci56ZXJvLCA2MCk7XHJcbiAgICAgICAgbGV0IHJlY3QgPSBuZXcgUmVjdChuZXcgUGxhbmUoVmVjdG9yLnplcm8sIG5ldyBWZWN0b3IoMCwgMCwgLTEpKSwgNCwgMilcclxuXHJcbiAgICAgICAgLy8gc2V0IGFycmF5IHZhbHVlXHJcbiAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLmg7ICsreSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRoaXMudzsgKyt4KSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZ2JhIGVhY2ggY29sb3IgaXMgNGJ5dGVcclxuICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IDQgKiAoeCArIHkgKiB0aGlzLncpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJlbWFwIHRvIDB+MVxyXG4gICAgICAgICAgICAgICAgbGV0IFggPSAoeCAvIHRoaXMudyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgWSA9ICh5IC8gdGhpcy5oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgeSBkaXJlY3Rpb25cclxuICAgICAgICAgICAgICAgIFkgPSAxIC0gWTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1hcCB0byAtMX4xXHJcbiAgICAgICAgICAgICAgICBsZXQgeF93ZWlnaHQgPSBYICogMiAtIDE7XHJcbiAgICAgICAgICAgICAgICBsZXQgeV93ZWlnaHQgPSBZICogMiAtIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHJheSA9IGNhbWVyYS5jcmVhdGVfcmF5KHhfd2VpZ2h0LCB5X3dlaWdodCwgcmF0aW8pO1xyXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHJlY3QuaGl0KHJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbGV0IHIgPSBYO1xyXG4gICAgICAgICAgICAgICAgLy8gbGV0IGcgPSBZO1xyXG4gICAgICAgICAgICAgICAgLy8gbGV0IGIgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCByID0gcmVzdWx0LmlzX2hpdCA/IDEgOiAwO1xyXG4gICAgICAgICAgICAgICAgbGV0IGcgPSByZXN1bHQuaXNfaGl0ID8gMSA6IDA7XHJcbiAgICAgICAgICAgICAgICBsZXQgYiA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgYmFja2J1ZmZlcl9kYXRhX2FycmF5W2luZGV4KytdID0gTWF0aC5yb3VuZChyICogMjU1KTtcclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleCsrXSA9IE1hdGgucm91bmQoZyAqIDI1NSk7XHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXgrK10gPSBNYXRoLnJvdW5kKGIgKiAyNTUpO1xyXG4gICAgICAgICAgICAgICAgYmFja2J1ZmZlcl9kYXRhX2FycmF5W2luZGV4XSA9IDI1NTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb250ZXh0XzJkLnB1dEltYWdlRGF0YShiYWNrYnVmZmVyX2RhdGEsIDAsIDApO1xyXG5cclxuXHJcbiAgICAgICAgLy8g6Kit5a6aYnVmZmVy55qE5aSn5bCP5ZKMY3NzIHN0eWxl55qE5aSn5bCP5LiA5qijXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9vcGVuaG9tZS5jYy9Hb3NzaXAvV2ViR0wvQ2FudmFzLmh0bWxcclxuICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcbiAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgY2FudmFzLndpZHRoID0gY2FudmFzLmNsaWVudFdpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjYW52YXMuY2xpZW50SGVpZ2h0O1xyXG5cclxuICAgICAgICAvLyBjb3B5IGJhY2tidWZmZXIgdG8gY2FudmFzXHJcbiAgICAgICAgbGV0IGNvbnRleHRfYml0bWFwX3JlbmRlciA9IGNhbnZhcy5nZXRDb250ZXh0KFwiYml0bWFwcmVuZGVyZXJcIik7XHJcbiAgICAgICAgY29udGV4dF9iaXRtYXBfcmVuZGVyLnRyYW5zZmVyRnJvbUltYWdlQml0bWFwKHRoaXMuYmFja2J1ZmZlci50cmFuc2ZlclRvSW1hZ2VCaXRtYXAoKSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=