!function(t){var i={};function r(n){if(i[n])return i[n].exports;var e=i[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=i,r.d=function(t,i,n){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,i){if(1&i&&(t=r(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var e in t)r.d(n,e,function(i){return t[i]}.bind(null,e));return n},r.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=0)}([function(t,i,r){"use strict";r.r(i);var n=function(){function t(t,i,r){this.x=0,this.y=0,this.z=0,this.x=t,this.y=i,this.z=r}return t.add=function(i,r){return new t(r.x+i.x,r.y+i.y,r.z+i.z)},t.minus=function(i,r){return new t(i.x-r.x,i.y-r.y,i.z-r.z)},t.multiply=function(i,r){return new t(i.x*r,i.y*r,i.z*r)},t.cross_product=function(i,r){return new t(i.y*r.z-i.z*r.y,-i.x*r.z+i.z*r.x,i.x*r.y-i.y*r.x)},t.dot_product=function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var t=this.length();return this.x=this.x/t,this.y=this.y/t,this.z=this.z/t,this},t.prototype.add=function(i){return t.add(this,i)},t.prototype.minus=function(i){return t.minus(this,i)},t.prototype.multiply=function(i){return t.multiply(this,i)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.up=new t(0,1,0),t.zero=new t(0,0,0),t}(),e=function(t,i){this.from=t,this.dir=i};function o(t,i){return Math.abs(t-i)<.001}var s=function(){function t(t,i,r){this.z_axis=n.minus(i,t).normalize();var e=n.up;this.x_axis=n.cross_product(e,this.z_axis).normalize(),this.y_axis=n.cross_product(this.z_axis,this.x_axis),this.eye=t,this.fov_degree=r}return t.prototype.create_ray=function(t,i,r){var n,o=(n=.5*this.fov_degree,Math.PI*n/180),s=Math.tan(o),u=s*r,h=this.z_axis.add(this.x_axis.multiply(t*u)).add(this.y_axis.multiply(i*s));return new e(this.eye.clone(),h)},t.prototype.render=function(t,i){var r=this;t.render_pixel((function(t,e,o){var s=r.create_ray(t,e,o),u=i.map((function(t){return t.hit(s)})).filter((function(t){return t.is_hit})).sort((function(t,i){return t.t-i.t}));if(0!=u.length)var h=u[0],a=h.is_hit?1:0,c=h.is_hit?1:0,f=0;else a=.5,c=.5,f=.5;return new n(a,c,f)}))},t}(),u=function(){function t(t,i,r){this.plane=t,this.w=i,this.h=r}return t.prototype.hit=function(t){var i=this.plane.hit(t);if(i.is_hit){var r=i.hit_pos,e=r.minus(this.plane.C),o=n.cross_product(n.up,this.plane.N).normalize(),s=n.cross_product(o,this.plane.N),u=n.dot_product(e,o),h=n.dot_product(e,s);return{is_hit:Math.abs(u)<this.w&&Math.abs(h)<this.h,hit_pos:r,t:i.t}}return{is_hit:!1}},t}(),h=function(){function t(t,i){this.C=t,this.N=i}return t.prototype.is_positive=function(t){var i=n.minus(t,this.C);return n.dot_product(i,this.N)>0},t.prototype.hit=function(t){var i=t.from,r=t.dir,e=n.dot_product(r,this.N),s=n.dot_product(n.minus(this.C,i),this.N);if(o(e,0))return{is_hit:!1,hit_pos:null,t:-1};var u=s/e;return{is_hit:u>0,hit_pos:i.add(r.multiply(u)),t:u}},t}(),a=function(){function t(t,i){this.C=t,this.R=i}return t.prototype.hit=function(t){var i=t.dir,r=t.from,e=n.dot_product(i,i),s=2*(n.dot_product(i,r)-n.dot_product(i,this.C)),u=s*s-4*e*(n.dot_product(r,r)-2*n.dot_product(r,this.C)+n.dot_product(this.C,this.C)-this.R*this.R);if(o(u,0)){var h=-s/(2*e);return{is_hit:!0,hit_pos:r.add(i.multiply(h)),t:h}}if(u>0){var a=Math.sqrt(u);h=[(-s-a)/(2*e),(-s+a)/(2*e)].filter((function(t){return t>0}))[0];return{is_hit:!0,hit_pos:r.add(i.multiply(h)),t:h}}return{is_hit:!1}},t}(),c=function(){function t(t,i){this.w=320,this.h=240,this.backbuffer=null,this.w=t,this.h=i,this.backbuffer=new OffscreenCanvas(this.w,this.h)}return t.prototype.render_pixel=function(t){for(var i=this.backbuffer.getContext("2d"),r=i.getImageData(0,0,this.w,this.h),n=r.data,e=this.w/this.h,o=0;o<this.h;++o)for(var s=0;s<this.w;++s){var u=4*(s+o*this.w),h=s/this.w,a=o/this.h,c=t(2*h-1,2*(a=1-a)-1,e),f=c.x,p=c.y,d=c.z;n[u++]=Math.round(255*f),n[u++]=Math.round(255*p),n[u++]=Math.round(255*d),n[u]=255}i.putImageData(r,0,0)},t.prototype.show_buffer=function(t){var i=document.getElementById(t);i.style.width=this.w+"px",i.style.height=this.h+"px",i.width=i.clientWidth,i.height=i.clientHeight,i.getContext("bitmaprenderer").transferFromImageBitmap(this.backbuffer.transferToImageBitmap())},t}();new function(){var t=[new u(new h(n.zero,new n(0,0,-1)),2,2),new a(new n(6,2,0),2)],i=new s(new n(0,10,-10),n.zero,60),r=new c(320,240);i.render(r,t),r.show_buffer("canvas")}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hdGgvVmVjdG9yLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1JheS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9Ub29sLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL0NhbWVyYS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9SZWN0LnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1BsYW5lLnRzIiwid2VicGFjazovLy8uL3NyYy9NYXRoL1NwaGVyZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvTWF0aC9SZW5kZXJUYXJnZXQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0FwcC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsInB4IiwicHkiLCJweiIsIngiLCJ5IiwieiIsInRoaXMiLCJhZGQiLCJBIiwiQiIsIlZlY3RvciIsIm1pbnVzIiwibXVsdGlwbHkiLCJjcm9zc19wcm9kdWN0IiwiZG90X3Byb2R1Y3QiLCJsZW5ndGgiLCJNYXRoIiwic3FydCIsIm5vcm1hbGl6ZSIsInRlbXAiLCJjbG9uZSIsInVwIiwiemVybyIsImZyb20iLCJkaXIiLCJudW1iZXJfZXF1YWwiLCJhIiwiYiIsImFicyIsImV5ZSIsImxvb2tfYXQiLCJmb3ZfZGVncmVlIiwiel9heGlzIiwiaGVscF92IiwieF9heGlzIiwieV9heGlzIiwiY3JlYXRlX3JheSIsInhfd2VpZ2h0IiwieV93ZWlnaHQiLCJyYXRpbyIsImhhbGZfZm92X3JhZCIsIlBJIiwidGFuX2giLCJ0YW4iLCJ0YW5fdyIsInJlbmRlciIsInJlbmRlcl90YXJnZXQiLCJvYmpfbGlzdCIsInJlbmRlcl9waXhlbCIsInJheSIsImhpdF9zb3J0X2xpc3QiLCJtYXAiLCJvYmoiLCJoaXQiLCJmaWx0ZXIiLCJpbmZvIiwiaXNfaGl0Iiwic29ydCIsInJlc3VsdCIsImciLCJwbGFuZSIsInciLCJoIiwiaGl0X3BvcyIsImRpZmYiLCJDIiwid19heGlzIiwiTiIsImhfYXhpcyIsIndfdmFsdWUiLCJoX3ZhbHVlIiwicG9pbnQiLCJub3JtYWwiLCJpc19wb3NpdGl2ZSIsInRlc3RfcCIsIlIiLCJEIiwiRiIsImsiLCJzcXJ0X2siLCJiYWNrYnVmZmVyIiwiT2Zmc2NyZWVuQ2FudmFzIiwiZnVuYyIsImNvbnRleHRfMmQiLCJnZXRDb250ZXh0IiwiYmFja2J1ZmZlcl9kYXRhIiwiZ2V0SW1hZ2VEYXRhIiwiYmFja2J1ZmZlcl9kYXRhX2FycmF5IiwiZGF0YSIsImluZGV4IiwiWCIsIlkiLCJjb2xvciIsInJvdW5kIiwicHV0SW1hZ2VEYXRhIiwic2hvd19idWZmZXIiLCJjYW52YXNfaWQiLCJjYW52YXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJ3aWR0aCIsImhlaWdodCIsImNsaWVudFdpZHRoIiwiY2xpZW50SGVpZ2h0IiwidHJhbnNmZXJGcm9tSW1hZ2VCaXRtYXAiLCJ0cmFuc2ZlclRvSW1hZ2VCaXRtYXAiLCJjYW1lcmEiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElB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QXNCRSxLQUFXekUsS0FBSzZFLE1BQVUsSUFBSmxFLEdBQzVDNEQsRUFBc0JFLEdBQVMsSUFHdkNOLEVBQVdXLGFBQWFULEVBQWlCLEVBQUcsSUFHaEQsWUFBQVUsWUFBQSxTQUFZQyxHQUdSLElBQUlDLEVBQVNDLFNBQVNDLGVBQWVILEdBQ3JDQyxFQUFPRyxNQUFNQyxNQUFRL0YsS0FBS3VELEVBQUksS0FDOUJvQyxFQUFPRyxNQUFNRSxPQUFTaEcsS0FBS3dELEVBQUksS0FDL0JtQyxFQUFPSSxNQUFRSixFQUFPTSxZQUN0Qk4sRUFBT0ssT0FBU0wsRUFBT08sYUFHS1AsRUFBT2IsV0FBVyxrQkFDeEJxQix3QkFBd0JuRyxLQUFLMEUsV0FBVzBCLDBCQUV0RSxFQWpFQSxHQ0NBLElDTUksV0FFSSxJQUVJM0QsRUFBVyxDQUZKLElBQUksRUFBSyxJQUFJLEVBQU0sRUFBT3pCLEtBQU0sSUFBSSxFQUFPLEVBQUcsR0FBSSxJQUFLLEVBQUcsR0FDeEQsSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLEVBQUcsR0FBSSxJQUd6Q3FGLEVBQVMsSUFBSSxFQUFPLElBQUksRUFBTyxFQUFHLElBQUssSUFBSyxFQUFPckYsS0FBTSxJQUN6RHdCLEVBQWdCLElBQUksRUFBYSxJQUFLLEtBQzFDNkQsRUFBTzlELE9BQU9DLEVBQWVDLEdBQzdCRCxFQUFjaUQsWUFBWSIsImZpbGUiOiJidWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIlxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZlY3RvciB7XHJcblxyXG4gICAgc3RhdGljIHVwID0gbmV3IFZlY3RvcigwLCAxLCAwKTtcclxuICAgIHN0YXRpYyB6ZXJvID0gbmV3IFZlY3RvcigwLCAwLCAwKTtcclxuXHJcbiAgICBzdGF0aWMgYWRkKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEIueCArIEEueCwgQi55ICsgQS55LCBCLnogKyBBLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG1pbnVzKEE6IFZlY3RvciwgQjogVmVjdG9yKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAtIEIueCwgQS55IC0gQi55LCBBLnogLSBCLnopO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIG11bHRpcGx5KEE6IFZlY3RvciwgczogbnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBuZXcgVmVjdG9yKEEueCAqIHMsIEEueSAqIHMsIEEueiAqIHMpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNyb3NzX3Byb2R1Y3QoQTogVmVjdG9yLCBCOiBWZWN0b3IpIHtcclxuICAgICAgICB2YXIgdGVtcCA9IG5ldyBWZWN0b3IoQS55ICogQi56IC0gQS56ICogQi55LCAtQS54ICogQi56ICsgQS56ICogQi54LCBBLnggKiBCLnkgLSBBLnkgKiBCLngpO1xyXG4gICAgICAgIHJldHVybiB0ZW1wO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBkb3RfcHJvZHVjdChBOiBWZWN0b3IsIEI6IFZlY3Rvcikge1xyXG4gICAgICAgIHJldHVybiBBLnggKiBCLnggKyBBLnkgKiBCLnkgKyBBLnogKiBCLno7XHJcbiAgICB9XHJcblxyXG4gICAgeDogbnVtYmVyID0gMDtcclxuICAgIHk6IG51bWJlciA9IDA7XHJcbiAgICB6OiBudW1iZXIgPSAwO1xyXG4gICAgY29uc3RydWN0b3IocHg6IG51bWJlciwgcHk6IG51bWJlciwgcHo6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMueCA9IHB4O1xyXG4gICAgICAgIHRoaXMueSA9IHB5O1xyXG4gICAgICAgIHRoaXMueiA9IHB6O1xyXG4gICAgfVxyXG5cclxuICAgIGxlbmd0aCgpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueik7XHJcbiAgICB9XHJcblxyXG4gICAgbm9ybWFsaXplKCkge1xyXG4gICAgICAgIHZhciB0ZW1wID0gdGhpcy5sZW5ndGgoKTtcclxuICAgICAgICB0aGlzLnggPSB0aGlzLnggLyB0ZW1wO1xyXG4gICAgICAgIHRoaXMueSA9IHRoaXMueSAvIHRlbXA7XHJcbiAgICAgICAgdGhpcy56ID0gdGhpcy56IC8gdGVtcDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBhZGQoQTogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5hZGQodGhpcywgQSk7XHJcbiAgICB9XHJcblxyXG4gICAgbWludXMoQTogVmVjdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFZlY3Rvci5taW51cyh0aGlzLCBBKTtcclxuICAgIH1cclxuXHJcbiAgICBtdWx0aXBseShzOiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gVmVjdG9yLm11bHRpcGx5KHRoaXMsIHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb25lKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKHRoaXMueCwgdGhpcy55LCB0aGlzLnopO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY29yIGZyb20gXCIuL1ZlY3RvclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmF5IHtcclxuICAgIGZyb206IFZlY29yO1xyXG4gICAgZGlyOiBWZWNvcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihmcm9tOiBWZWNvciwgZGlyOiBWZWNvcikge1xyXG4gICAgICAgIHRoaXMuZnJvbSA9IGZyb207XHJcbiAgICAgICAgdGhpcy5kaXIgPSBkaXI7XHJcbiAgICB9XHJcbn07IiwiZXhwb3J0IGZ1bmN0aW9uIGRlZ3JlZV90b19SYWQoZDogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTWF0aC5QSSAqIGQgLyAxODA7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZXBzaWxvbjogbnVtYmVyID0gMC4wMDE7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbnVtYmVyX2VxdWFsKGE6IG51bWJlciwgYjogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTWF0aC5hYnMoYSAtIGIpIDwgZXBzaWxvbjtcclxufSIsImltcG9ydCBWZWN0b3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcbmltcG9ydCBSYXkgZnJvbSBcIi4vUmF5XCI7XHJcbmltcG9ydCB7IGRlZ3JlZV90b19SYWQgfSBmcm9tIFwiLi9Ub29sXCJcclxuaW1wb3J0IFJlbmRlclRhcmdldCBmcm9tIFwiLi9SZW5kZXJUYXJnZXRcIjtcclxuaW1wb3J0IEhpdGFibGUgZnJvbSBcIi4vSGl0YWJsZVwiO1xyXG5pbXBvcnQgSGl0SW5mbyBmcm9tIFwiLi9IaXRJbmZvXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYW1lcmEge1xyXG4gICAgZXllOiBWZWN0b3I7XHJcblxyXG4gICAgeF9heGlzOiBWZWN0b3I7XHJcbiAgICB5X2F4aXM6IFZlY3RvcjtcclxuICAgIHpfYXhpczogVmVjdG9yO1xyXG5cclxuICAgIGZvdl9kZWdyZWU6IG51bWJlcjtcclxuICAgIGNvbnN0cnVjdG9yKGV5ZTogVmVjdG9yLCBsb29rX2F0OiBWZWN0b3IsIGZvdl9kZWdyZWU6IG51bWJlcikge1xyXG5cclxuICAgICAgICAvLyBjYW1lcmEgM+i7uFxyXG4gICAgICAgIHRoaXMuel9heGlzID0gVmVjdG9yLm1pbnVzKGxvb2tfYXQsIGV5ZSkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBoZWxwX3YgPSBWZWN0b3IudXA7XHJcbiAgICAgICAgdGhpcy54X2F4aXMgPSBWZWN0b3IuY3Jvc3NfcHJvZHVjdChoZWxwX3YsIHRoaXMuel9heGlzKS5ub3JtYWxpemUoKTtcclxuICAgICAgICB0aGlzLnlfYXhpcyA9IFZlY3Rvci5jcm9zc19wcm9kdWN0KHRoaXMuel9heGlzLCB0aGlzLnhfYXhpcyk7XHJcblxyXG4gICAgICAgIC8vIGNhbWVyYSDljp/pu55cclxuICAgICAgICB0aGlzLmV5ZSA9IGV5ZTtcclxuXHJcbiAgICAgICAgLy8gY2FtZXJhIGZvdlxyXG4gICAgICAgIHRoaXMuZm92X2RlZ3JlZSA9IGZvdl9kZWdyZWU7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlX3JheSh4X3dlaWdodDogbnVtYmVyLCB5X3dlaWdodDogbnVtYmVyLCByYXRpbzogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IGhhbGZfZm92X3JhZCA9IGRlZ3JlZV90b19SYWQoMC41ICogdGhpcy5mb3ZfZGVncmVlKTtcclxuICAgICAgICBsZXQgdGFuX2ggPSBNYXRoLnRhbihoYWxmX2Zvdl9yYWQpO1xyXG4gICAgICAgIGxldCB0YW5fdyA9IHRhbl9oICogcmF0aW87XHJcblxyXG4gICAgICAgIGxldCBkaXIgPSB0aGlzLnpfYXhpc1xyXG4gICAgICAgICAgICAuYWRkKHRoaXMueF9heGlzLm11bHRpcGx5KHhfd2VpZ2h0ICogdGFuX3cpKVxyXG4gICAgICAgICAgICAuYWRkKHRoaXMueV9heGlzLm11bHRpcGx5KHlfd2VpZ2h0ICogdGFuX2gpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBSYXkodGhpcy5leWUuY2xvbmUoKSwgZGlyKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIocmVuZGVyX3RhcmdldDogUmVuZGVyVGFyZ2V0LCBvYmpfbGlzdDogSGl0YWJsZVtdKSB7XHJcbiAgICAgICAgcmVuZGVyX3RhcmdldC5yZW5kZXJfcGl4ZWwoKHhfd2VpZ2h0OiBudW1iZXIsIHlfd2VpZ2h0OiBudW1iZXIsIHJhdGlvOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgbGV0IHJheSA9IHRoaXMuY3JlYXRlX3JheSh4X3dlaWdodCwgeV93ZWlnaHQsIHJhdGlvKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBoaXRfc29ydF9saXN0ID0gb2JqX2xpc3QubWFwKG9iaiA9PiBvYmouaGl0KHJheSkpXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGluZm8gPT4gaW5mby5pc19oaXQpXHJcbiAgICAgICAgICAgICAgICAuc29ydCgoYTogSGl0SW5mbywgYjogSGl0SW5mbykgPT4gYS50IC0gYi50KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOacieWwhOS4reWXjlxyXG4gICAgICAgICAgICBsZXQgaXNfaGl0ID0gaGl0X3NvcnRfbGlzdC5sZW5ndGggIT0gMDtcclxuICAgICAgICAgICAgaWYgKGlzX2hpdCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGhpdF9zb3J0X2xpc3RbMF07XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IHJlc3VsdC5pc19oaXQgPyAxIDogMDtcclxuICAgICAgICAgICAgICAgIHZhciBnID0gcmVzdWx0LmlzX2hpdCA/IDEgOiAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSAwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHIgPSAwLjU7XHJcbiAgICAgICAgICAgICAgICB2YXIgZyA9IDAuNTtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gMC41O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFZlY3RvcihyLCBnLCBiKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBsYW5lIGZyb20gXCIuL1BsYW5lXCI7XHJcbmltcG9ydCBSYXkgZnJvbSBcIi4vUmF5XCI7XHJcbmltcG9ydCBWZWN0b3IgZnJvbSBcIi4vVmVjdG9yXCI7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gXCIuL0hpdEluZm9cIjtcclxuaW1wb3J0IEhpdGFibGUgZnJvbSBcIi4vSGl0YWJsZVwiO1xyXG5cclxuLy8g5bCP5pa55aGKXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlY3QgaW1wbGVtZW50cyBIaXRhYmxlIHtcclxuICAgIHBsYW5lOiBQbGFuZTtcclxuICAgIHc6IG51bWJlcjtcclxuICAgIGg6IG51bWJlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwbGFuZTogUGxhbmUsIHc6IG51bWJlciwgaDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5wbGFuZSA9IHBsYW5lO1xyXG4gICAgICAgIHRoaXMudyA9IHc7XHJcbiAgICAgICAgdGhpcy5oID0gaDtcclxuICAgIH1cclxuXHJcbiAgICBoaXQocmF5OiBSYXkpOiBIaXRJbmZvIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5wbGFuZS5oaXQocmF5KTtcclxuICAgICAgICBpZiAocmVzdWx0LmlzX2hpdCkge1xyXG4gICAgICAgICAgICBsZXQgaGl0X3BvcyA9IHJlc3VsdC5oaXRfcG9zO1xyXG4gICAgICAgICAgICBsZXQgZGlmZiA9IGhpdF9wb3MubWludXModGhpcy5wbGFuZS5DKTtcclxuICAgICAgICAgICAgbGV0IHdfYXhpcyA9IFZlY3Rvci5jcm9zc19wcm9kdWN0KFZlY3Rvci51cCwgdGhpcy5wbGFuZS5OKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgbGV0IGhfYXhpcyA9IFZlY3Rvci5jcm9zc19wcm9kdWN0KHdfYXhpcywgdGhpcy5wbGFuZS5OKTtcclxuICAgICAgICAgICAgbGV0IHdfdmFsdWUgPSBWZWN0b3IuZG90X3Byb2R1Y3QoZGlmZiwgd19heGlzKTtcclxuICAgICAgICAgICAgbGV0IGhfdmFsdWUgPSBWZWN0b3IuZG90X3Byb2R1Y3QoZGlmZiwgaF9heGlzKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBpc19oaXQgPSBNYXRoLmFicyh3X3ZhbHVlKSA8IHRoaXMudyAmJiBNYXRoLmFicyhoX3ZhbHVlKSA8IHRoaXMuaDtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdCxcclxuICAgICAgICAgICAgICAgIGhpdF9wb3MsXHJcbiAgICAgICAgICAgICAgICB0OiByZXN1bHQudFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogZmFsc2UsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgVmVjdG9yIGZyb20gJy4vVmVjdG9yJztcclxuaW1wb3J0IFJheSBmcm9tICcuL1JheSc7XHJcbmltcG9ydCB7IG51bWJlcl9lcXVhbCB9IGZyb20gJy4vVG9vbCc7XHJcbmltcG9ydCBIaXRJbmZvIGZyb20gJy4vSGl0SW5mbyc7XHJcbmltcG9ydCBIaXRhYmxlIGZyb20gJy4vSGl0YWJsZSc7XHJcblxyXG4vLyDlubPpnaJcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGxhbmUgaW1wbGVtZW50cyBIaXRhYmxlIHtcclxuXHJcbiAgICBDOiBWZWN0b3I7XHJcbiAgICBOOiBWZWN0b3I7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb2ludDogVmVjdG9yLCBub3JtYWw6IFZlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuQyA9IHBvaW50O1xyXG4gICAgICAgIHRoaXMuTiA9IG5vcm1hbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmuKzoqaZ0ZXNwX3DlkozmlrnlkJHph4/mmK/kuI3mmK/lnKjlkIzkuIDpgopcclxuICAgIGlzX3Bvc2l0aXZlKHRlc3RfcDogVmVjdG9yKSB7XHJcbiAgICAgICAgbGV0IGRpZmYgPSBWZWN0b3IubWludXModGVzdF9wLCB0aGlzLkMpO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IFZlY3Rvci5kb3RfcHJvZHVjdChkaWZmLCB0aGlzLk4pO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSA+IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaGl0KHJheTogUmF5KTogSGl0SW5mbyB7XHJcbiAgICAgICAgLy8gcmF5IGhpdCBwbGFuZSBcclxuICAgICAgICBsZXQgZnJvbSA9IHJheS5mcm9tO1xyXG4gICAgICAgIGxldCBkaXIgPSByYXkuZGlyO1xyXG5cclxuICAgICAgICAvLyAoRi1DKeOAgk4gKyB0IChE44CCTikgPSAwXHJcbiAgICAgICAgLy8gdCAgPSAoQy1GKeOAgk4gLyAoROOAgk4pXHJcbiAgICAgICAgLy8gdCAgPSAoQSAvIChCKVxyXG4gICAgICAgIGxldCBCID0gVmVjdG9yLmRvdF9wcm9kdWN0KGRpciwgdGhpcy5OKTtcclxuICAgICAgICBsZXQgQSA9IFZlY3Rvci5kb3RfcHJvZHVjdChWZWN0b3IubWludXModGhpcy5DLCBmcm9tKSwgdGhpcy5OKTtcclxuXHJcbiAgICAgICAgLy8gYXZvaWQgZGl2aWRlIGJ5IDBcclxuICAgICAgICBpZiAobnVtYmVyX2VxdWFsKEIsIDApKVxyXG4gICAgICAgICAgICByZXR1cm4geyBpc19oaXQ6IGZhbHNlLCBoaXRfcG9zOiBudWxsLCB0OiAtMSB9O1xyXG5cclxuICAgICAgICBsZXQgdCA9IEEgLyBCO1xyXG4gICAgICAgIGxldCBpc19oaXQgPSB0ID4gMC4wO1xyXG4gICAgICAgIGxldCBoaXRfcG9zID0gZnJvbS5hZGQoZGlyLm11bHRpcGx5KHQpKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaXNfaGl0LFxyXG4gICAgICAgICAgICBoaXRfcG9zLFxyXG4gICAgICAgICAgICB0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuaW1wb3J0IFJheSBmcm9tIFwiLi9SYXlcIjtcclxuaW1wb3J0IHsgbnVtYmVyX2VxdWFsIH0gZnJvbSAnLi9Ub29sJztcclxuaW1wb3J0IEhpdEluZm8gZnJvbSBcIi4vSGl0SW5mb1wiO1xyXG5pbXBvcnQgSGl0YWJsZSBmcm9tIFwiLi9IaXRhYmxlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTcGhlcmUgaW1wbGVtZW50cyBIaXRhYmxlIHtcclxuXHJcbiAgICBDOiBWZWN0b3I7IC8vIOeQg+S4reW/g1xyXG4gICAgUjogbnVtYmVyOyAvLyDnkIPljYrlvpFcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihDOiBWZWN0b3IsIFI6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuQyA9IEM7XHJcbiAgICAgICAgdGhpcy5SID0gUjtcclxuICAgIH1cclxuXHJcbiAgICBoaXQocmF5OiBSYXkpOiBIaXRJbmZvIHtcclxuICAgICAgICAvLyDop6My5qyh5pa556iL5byPXHJcbiAgICAgICAgLy8gKFgtQynjgIIoWC1DKSA9IFIqUlxyXG4gICAgICAgIC8vIFg9Rit0KkRcclxuICAgICAgICAvLyB0PVsoLWItc3FydF9rKS8yYSwoLWIrc3FydF9rKS8yYV1cclxuICAgICAgICBsZXQgRCA9IHJheS5kaXI7XHJcbiAgICAgICAgbGV0IEYgPSByYXkuZnJvbTtcclxuICAgICAgICBsZXQgYSA9IFZlY3Rvci5kb3RfcHJvZHVjdChELCBEKTtcclxuICAgICAgICBsZXQgYiA9IDIgKiAoVmVjdG9yLmRvdF9wcm9kdWN0KEQsIEYpIC0gVmVjdG9yLmRvdF9wcm9kdWN0KEQsIHRoaXMuQykpO1xyXG4gICAgICAgIGxldCBjID0gVmVjdG9yLmRvdF9wcm9kdWN0KEYsIEYpIC0gMiAqIFZlY3Rvci5kb3RfcHJvZHVjdChGLCB0aGlzLkMpICsgVmVjdG9yLmRvdF9wcm9kdWN0KHRoaXMuQywgdGhpcy5DKSAtIHRoaXMuUiAqIHRoaXMuUjtcclxuXHJcbiAgICAgICAgbGV0IGsgPSBiICogYiAtIDQgKiBhICogYztcclxuICAgICAgICBpZiAobnVtYmVyX2VxdWFsKGssIDApKSB7ICAvLyDkuqTmlrwx6bueXHJcbiAgICAgICAgICAgIGxldCB0ID0gLWIgLyAoMiAqIGEpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGhpdF9wb3MgPSBGLmFkZChELm11bHRpcGx5KHQpKTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlzX2hpdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGhpdF9wb3MsXHJcbiAgICAgICAgICAgICAgICB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoayA+IDApIHsgLy8g5Lqk5pa8Mum7nlxyXG5cclxuICAgICAgICAgICAgLy8g6YGO5r++5Ye6dD4w77yMcmF5LmZyb23lnKjnkIPlhafnkIPmnInlj6/og73lh7rnj750PDBcclxuICAgICAgICAgICAgbGV0IHNxcnRfayA9IE1hdGguc3FydChrKTtcclxuICAgICAgICAgICAgbGV0IHRfbGlzdCA9IFsoLWIgLSBzcXJ0X2spIC8gKDIgKiBhKSwgKC1iICsgc3FydF9rKSAvICgyICogYSldLmZpbHRlcih4ID0+IHggPiAwKTtcclxuICAgICAgICAgICAgbGV0IHQgPSB0X2xpc3RbMF07XHJcbiAgICAgICAgICAgIGxldCBoaXRfcG9zID0gRi5hZGQoRC5tdWx0aXBseSh0KSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBoaXRfcG9zLFxyXG4gICAgICAgICAgICAgICAgdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHsgLy8g5rKS5Lqk6bueXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc19oaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFZlY3RvciBmcm9tIFwiLi9WZWN0b3JcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVuZGVyVGFyZ2V0IHtcclxuICAgIHc6IG51bWJlciA9IDMyMDtcclxuICAgIGg6IG51bWJlciA9IDI0MDtcclxuICAgIGJhY2tidWZmZXI6IE9mZnNjcmVlbkNhbnZhcyA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3Rvcih3OiBudW1iZXIsIGg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMudyA9IHc7XHJcbiAgICAgICAgdGhpcy5oID0gaDtcclxuICAgICAgICB0aGlzLmJhY2tidWZmZXIgPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHRoaXMudywgdGhpcy5oKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJfcGl4ZWwoZnVuYzogKHhfd2VpZ2h0OiBudW1iZXIsIHlfd2VpZ2h0OiBudW1iZXIsIHJhdGlvOiBudW1iZXIpID0+IFZlY3Rvcikge1xyXG5cclxuICAgICAgICBsZXQgY29udGV4dF8yZCA9IHRoaXMuYmFja2J1ZmZlci5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAvLyBnZXQgc291cmNlIGRhdGEgYXJyYXlcclxuICAgICAgICBsZXQgYmFja2J1ZmZlcl9kYXRhID0gY29udGV4dF8yZC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy53LCB0aGlzLmgpO1xyXG4gICAgICAgIGxldCBiYWNrYnVmZmVyX2RhdGFfYXJyYXkgPSBiYWNrYnVmZmVyX2RhdGEuZGF0YTtcclxuXHJcbiAgICAgICAgbGV0IHJhdGlvID0gdGhpcy53IC8gdGhpcy5oO1xyXG5cclxuICAgICAgICAvLyBzZXQgYXJyYXkgdmFsdWVcclxuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuaDsgKyt5KSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgdGhpcy53OyArK3gpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJnYmEgZWFjaCBjb2xvciBpcyA0Ynl0ZVxyXG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gNCAqICh4ICsgeSAqIHRoaXMudyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcmVtYXAgdG8gMH4xXHJcbiAgICAgICAgICAgICAgICBsZXQgWCA9ICh4IC8gdGhpcy53KTtcclxuICAgICAgICAgICAgICAgIGxldCBZID0gKHkgLyB0aGlzLmgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNoYW5nZSB5IGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgWSA9IDEgLSBZO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJlbWFwIHRvIC0xfjFcclxuICAgICAgICAgICAgICAgIGxldCB4X3dlaWdodCA9IFggKiAyIC0gMTtcclxuICAgICAgICAgICAgICAgIGxldCB5X3dlaWdodCA9IFkgKiAyIC0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBmdW5jKHhfd2VpZ2h0LCB5X3dlaWdodCwgcmF0aW8pO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCByID0gY29sb3IueDtcclxuICAgICAgICAgICAgICAgIGxldCBnID0gY29sb3IueTtcclxuICAgICAgICAgICAgICAgIGxldCBiID0gY29sb3IuejtcclxuXHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXgrK10gPSBNYXRoLnJvdW5kKHIgKiAyNTUpO1xyXG4gICAgICAgICAgICAgICAgYmFja2J1ZmZlcl9kYXRhX2FycmF5W2luZGV4KytdID0gTWF0aC5yb3VuZChnICogMjU1KTtcclxuICAgICAgICAgICAgICAgIGJhY2tidWZmZXJfZGF0YV9hcnJheVtpbmRleCsrXSA9IE1hdGgucm91bmQoYiAqIDI1NSk7XHJcbiAgICAgICAgICAgICAgICBiYWNrYnVmZmVyX2RhdGFfYXJyYXlbaW5kZXhdID0gMjU1O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRleHRfMmQucHV0SW1hZ2VEYXRhKGJhY2tidWZmZXJfZGF0YSwgMCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd19idWZmZXIoY2FudmFzX2lkOiBzdHJpbmcpIHtcclxuICAgICAgICAvLyDoqK3lrppidWZmZXLnmoTlpKflsI/lkoxjc3Mgc3R5bGXnmoTlpKflsI/kuIDmqKNcclxuICAgICAgICAvLyBodHRwczovL29wZW5ob21lLmNjL0dvc3NpcC9XZWJHTC9DYW52YXMuaHRtbFxyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYW52YXNfaWQpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcbiAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgY2FudmFzLndpZHRoID0gY2FudmFzLmNsaWVudFdpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjYW52YXMuY2xpZW50SGVpZ2h0O1xyXG5cclxuICAgICAgICAvLyBjb3B5IGJhY2tidWZmZXIgdG8gY2FudmFzXHJcbiAgICAgICAgbGV0IGNvbnRleHRfYml0bWFwX3JlbmRlciA9IGNhbnZhcy5nZXRDb250ZXh0KFwiYml0bWFwcmVuZGVyZXJcIik7XHJcbiAgICAgICAgY29udGV4dF9iaXRtYXBfcmVuZGVyLnRyYW5zZmVyRnJvbUltYWdlQml0bWFwKHRoaXMuYmFja2J1ZmZlci50cmFuc2ZlclRvSW1hZ2VCaXRtYXAoKSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgQXBwIGZyb20gJy4vQXBwJztcclxuXHJcbm5ldyBBcHAoKTsiLCJpbXBvcnQgVmVjdG9yIGZyb20gJy4vTWF0aC9WZWN0b3InXHJcbmltcG9ydCBDYW1lcmEgZnJvbSAnLi9NYXRoL0NhbWVyYSdcclxuaW1wb3J0IFJlY3QgZnJvbSAnLi9NYXRoL1JlY3QnO1xyXG5pbXBvcnQgUGxhbmUgZnJvbSAnLi9NYXRoL1BsYW5lJztcclxuaW1wb3J0IFNwaGVyZSBmcm9tICcuL01hdGgvU3BoZXJlJztcclxuaW1wb3J0IFJlbmRlclRhcmdldCBmcm9tICcuL01hdGgvUmVuZGVyVGFyZ2V0JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuXHJcbiAgICAgICAgbGV0IHJlY3QgPSBuZXcgUmVjdChuZXcgUGxhbmUoVmVjdG9yLnplcm8sIG5ldyBWZWN0b3IoMCwgMCwgLTEpKSwgMiwgMik7XHJcbiAgICAgICAgbGV0IHNwaGVyZSA9IG5ldyBTcGhlcmUobmV3IFZlY3Rvcig2LCAyLCAwKSwgMik7XHJcbiAgICAgICAgbGV0IG9ial9saXN0ID0gW3JlY3QsIHNwaGVyZV07XHJcblxyXG4gICAgICAgIGxldCBjYW1lcmEgPSBuZXcgQ2FtZXJhKG5ldyBWZWN0b3IoMCwgMTAsIC0xMCksIFZlY3Rvci56ZXJvLCA2MCk7XHJcbiAgICAgICAgbGV0IHJlbmRlcl90YXJnZXQgPSBuZXcgUmVuZGVyVGFyZ2V0KDMyMCwgMjQwKTtcclxuICAgICAgICBjYW1lcmEucmVuZGVyKHJlbmRlcl90YXJnZXQsIG9ial9saXN0KTtcclxuICAgICAgICByZW5kZXJfdGFyZ2V0LnNob3dfYnVmZmVyKCdjYW52YXMnKTtcclxuICAgIH1cclxufVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==